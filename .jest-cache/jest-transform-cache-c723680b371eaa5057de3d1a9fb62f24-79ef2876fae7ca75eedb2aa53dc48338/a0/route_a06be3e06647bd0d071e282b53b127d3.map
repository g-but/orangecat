{"version":3,"names":["cov_ifh6e3o80","actualCoverage","s","exports","POST","server_1","require","server_2","headers_1","request","f","supabase","createServerClient","data","user","auth","getUser","error","signOut","b","cookieStore","cookies","allCookies","getAll","forEach","cookie","name","startsWith","includes","delete","response","NextResponse","json","success","message","id","headers","set","status"],"sources":["/home/g/dev/orangecat/src/app/auth/signout/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport { createServerClient } from '@/services/supabase/server'\nimport { cookies } from 'next/headers'\n\n// This is a server-side API route that handles sign out\nexport async function POST(request: Request) {\n  try {\n    const supabase = await createServerClient()\n    \n    // Get the current user before signing out\n    const { data: { user } } = await supabase.auth.getUser()\n    \n    // Sign out using Supabase\n    const { error } = await supabase.auth.signOut()\n    \n    if (error) {\n    }\n\n    const cookieStore = await cookies()\n    const allCookies = cookieStore.getAll()\n\n    // Manually clear all Supabase auth cookies\n    allCookies.forEach(cookie => {\n      if (cookie.name.startsWith('sb-') ||\n          cookie.name.includes('supabase') ||\n          cookie.name.includes('auth')) {\n        // REMOVED: console.log statement for security\n        cookieStore.delete(cookie.name)\n      }\n    })\n\n    // Create response\n    const response = NextResponse.json({ \n      success: true, \n      message: 'Successfully signed out',\n      user: user?.id || null\n    })\n\n    // Also clear cookies in the response headers\n    allCookies.forEach(cookie => {\n      if (cookie.name.startsWith('sb-') ||\n          cookie.name.includes('supabase') ||\n          cookie.name.includes('auth')) {\n        response.cookies.delete(cookie.name)\n      }\n    })\n\n    // Prevent caching\n    response.headers.set('Cache-Control', 'no-store, max-age=0')\n\n    return response\n\n  } catch (error) {\n    return NextResponse.json(\n      { error: 'Failed to sign out' },\n      { status: 500 }\n    )\n  }\n} "],"mappings":"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","ignoreList":[]}