5361a5d1535a4fef80d3b2b7a235c0ac
"use strict";
/**
 * AUTH SERVICE - COMPREHENSIVE TESTING (FIXED)
 *
 * Tests for the refactored modular Auth Service that was extracted
 * from the massive 1081-line client.ts GOD OBJECT.
 *
 * Created: 2025-06-08
 * Last Modified: 2025-06-08
 * Last Modified Summary: Fixed mocking issues and test timeouts
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
// Mock the core client BEFORE importing the auth service
globals_1.jest.mock('../core/client', () => ({
    supabase: mockSupabase,
    supabaseConfig: {
        supabaseUrl: 'https://test.supabase.co',
        supabaseAnonKey: 'test-key',
        siteUrl: 'http://localhost:3000',
        nodeEnv: 'test'
    }
}));
// Mock logger to prevent console noise
globals_1.jest.mock('@/utils/logger', () => ({
    logger: {
        error: globals_1.jest.fn(),
        warn: globals_1.jest.fn(),
        info: globals_1.jest.fn(),
        debug: globals_1.jest.fn()
    },
    logAuth: globals_1.jest.fn(),
    logSupabase: globals_1.jest.fn()
}));
// CRITICAL: Mock everything BEFORE any imports
const mockSupabase = {
    auth: {
        signInWithPassword: globals_1.jest.fn(),
        signUp: globals_1.jest.fn(),
        signOut: globals_1.jest.fn(),
        resetPasswordForEmail: globals_1.jest.fn(),
        updateUser: globals_1.jest.fn(),
        getSession: globals_1.jest.fn(),
        getUser: globals_1.jest.fn(),
        onAuthStateChange: globals_1.jest.fn()
    }
};
// NOW import the auth service after mocking
const authService = __importStar(require("../auth"));
describe('ðŸ” Auth Service - Modular Architecture Tests', () => {
    beforeEach(() => {
        // Clear all mocks before each test
        globals_1.jest.clearAllMocks()(mockSupabase.auth.signInWithPassword).mockResolvedValue({
            data: { user: null, session: null },
            error: null
        });
        mockSupabase.auth.signUp.mockResolvedValue({
            data: { user: null, session: null },
            error: null
        });
        mockSupabase.auth.signOut.mockResolvedValue({
            error: null
        });
        mockSupabase.auth.resetPasswordForEmail.mockResolvedValue({
            error: null
        });
        mockSupabase.auth.updateUser.mockResolvedValue({
            error: null
        });
        mockSupabase.auth.getSession.mockResolvedValue({
            data: { session: null },
            error: null
        });
        mockSupabase.auth.getUser.mockResolvedValue({
            data: { user: null },
            error: null
        });
        mockSupabase.auth.onAuthStateChange.mockReturnValue({
            data: { subscription: { unsubscribe: globals_1.jest.fn() } }
        });
    });
    describe('ðŸš€ Service Architecture Validation', () => {
        test('should export all required auth functions', () => {
            expect(typeof authService.signIn).toBe('function');
            expect(typeof authService.signUp).toBe('function');
            expect(typeof authService.signOut).toBe('function');
            expect(typeof authService.resetPassword).toBe('function');
            expect(typeof authService.updatePassword).toBe('function');
            expect(typeof authService.getSession).toBe('function');
            expect(typeof authService.getUser).toBe('function');
            expect(typeof authService.onAuthStateChange).toBe('function');
            expect(typeof authService.isAuthenticated).toBe('function');
            expect(typeof authService.getCurrentUserId).toBe('function');
        });
        test('should have proper TypeScript exports', () => {
            // These should be available as types (won't error at compile time)
            const _authResponse = {
                data: { user: null, session: null },
                error: null
            };
            const _signInRequest = {
                email: 'test@example.com',
                password: 'password123'
            };
            const _signUpRequest = {
                email: 'test@example.com',
                password: 'password123'
            };
            expect(true).toBe(true); // Types compile successfully
        });
    });
    describe('ðŸ”‘ Sign In Functionality', () => {
        test('should handle successful sign in', async () => {
            const mockUser = { id: 'user123', email: 'test@example.com' };
            const mockSession = { access_token: 'token123', user: mockUser }(mockSupabase.auth.signInWithPassword).mockResolvedValue({
                data: { user: mockUser, session: mockSession },
                error: null
            });
            const result = await authService.signIn({
                email: 'test@example.com',
                password: 'password123'
            });
            expect(result.data.user).toEqual(mockUser);
            expect(result.data.session).toEqual(mockSession);
            expect(result.error).toBeNull();
            expect(mockSupabase.auth.signInWithPassword).toHaveBeenCalledWith({
                email: 'test@example.com',
                password: 'password123'
            });
        });
        test('should handle sign in errors', async () => {
            const mockError = new Error('Invalid credentials');
            mockError.name = 'AuthApiError'(mockSupabase.auth.signInWithPassword).mockResolvedValue({
                data: { user: null, session: null },
                error: mockError
            });
            const result = await authService.signIn({
                email: 'wrong@example.com',
                password: 'wrongpassword'
            });
            expect(result.data.user).toBeNull();
            expect(result.data.session).toBeNull();
            expect(result.error).toEqual(mockError);
        });
        test('should handle network errors during sign in', async () => {
            const networkError = new Error('Network error');
            mockSupabase.auth.signInWithPassword.mockRejectedValue(networkError);
            const result = await authService.signIn({
                email: 'test@example.com',
                password: 'password123'
            });
            expect(result.data.user).toBeNull();
            expect(result.data.session).toBeNull();
            expect(result.error).toEqual(networkError);
        });
    });
    describe('ðŸ“ Sign Up Functionality', () => {
        test('should handle successful sign up with email confirmation', async () => {
            const mockUser = { id: 'user123', email: 'newuser@example.com' }(mockSupabase.auth.signUp).mockResolvedValue({
                data: { user: mockUser, session: null },
                error: null
            });
            const result = await authService.signUp({
                email: 'newuser@example.com',
                password: 'password123'
            });
            expect(result.data.user).toEqual(mockUser);
            expect(result.data.session).toBeNull();
            expect(result.error).toBeNull();
            expect(mockSupabase.auth.signUp).toHaveBeenCalledWith({
                email: 'newuser@example.com',
                password: 'password123',
                options: {
                    emailRedirectTo: 'http://localhost:3000'
                }
            });
        });
        test('should handle sign up with custom redirect URL', async () => {
            const mockUser = { id: 'user123', email: 'newuser@example.com' }(mockSupabase.auth.signUp).mockResolvedValue({
                data: { user: mockUser, session: null },
                error: null
            });
            const result = await authService.signUp({
                email: 'newuser@example.com',
                password: 'password123',
                emailRedirectTo: 'https://myapp.com/confirm'
            });
            expect(result.error).toBeNull();
            expect(mockSupabase.auth.signUp).toHaveBeenCalledWith({
                email: 'newuser@example.com',
                password: 'password123',
                options: {
                    emailRedirectTo: 'https://myapp.com/confirm'
                }
            });
        });
        test('should handle sign up errors', async () => {
            const mockError = new Error('Email already exists');
            mockError.name = 'AuthApiError'(mockSupabase.auth.signUp).mockResolvedValue({
                data: { user: null, session: null },
                error: mockError
            });
            const result = await authService.signUp({
                email: 'existing@example.com',
                password: 'password123'
            });
            expect(result.data.user).toBeNull();
            expect(result.error).toEqual(mockError);
        });
    });
    describe('ðŸšª Sign Out Functionality', () => {
        test('should handle successful sign out', async () => {
            mockSupabase.auth.signOut.mockResolvedValue({
                error: null
            });
            const result = await authService.signOut();
            expect(result.error).toBeNull();
            expect(mockSupabase.auth.signOut).toHaveBeenCalled();
        });
        test('should handle sign out errors', async () => {
            const mockError = new Error('Sign out failed');
            mockSupabase.auth.signOut.mockResolvedValue({
                error: mockError
            });
            const result = await authService.signOut();
            expect(result.error).toEqual(mockError);
        });
    });
    describe('ðŸ”„ Password Management', () => {
        test('should handle password reset request', async () => {
            mockSupabase.auth.resetPasswordForEmail.mockResolvedValue({ error: null });
            const result = await authService.resetPassword({
                email: 'user@example.com'
            });
            expect(result.error).toBeNull();
            expect(mockSupabase.auth.resetPasswordForEmail).toHaveBeenCalledWith('user@example.com', { redirectTo: 'http://localhost:3000/auth/reset-password' });
        });
        test('should handle password update', async () => {
            mockSupabase.auth.updateUser.mockResolvedValue({ error: null });
            const result = await authService.updatePassword({
                newPassword: 'newpassword123'
            });
            expect(result.error).toBeNull();
            expect(mockSupabase.auth.updateUser).toHaveBeenCalledWith({
                password: 'newpassword123'
            });
        });
        test('should handle password reset errors', async () => {
            const mockError = new Error('Email not found')(mockSupabase.auth.resetPasswordForEmail).mockResolvedValue({ error: mockError });
            const result = await authService.resetPassword({
                email: 'unknown@example.com'
            });
            expect(result.error).toEqual(mockError);
        });
    });
    describe('ðŸ‘¤ Session & User Management', () => {
        test('should get current session successfully', async () => {
            const mockUser = { id: 'user123', email: 'test@example.com' };
            const mockSession = { access_token: 'token123', user: mockUser }(mockSupabase.auth.getSession).mockResolvedValue({
                data: { session: mockSession },
                error: null
            });
            const result = await authService.getSession();
            expect(result.session).toEqual(mockSession);
            expect(result.error).toBeNull();
        });
        test('should get current user successfully', async () => {
            const mockUser = { id: 'user123', email: 'test@example.com' }(mockSupabase.auth.getUser).mockResolvedValue({
                data: { user: mockUser },
                error: null
            });
            const result = await authService.getUser();
            expect(result.user).toEqual(mockUser);
            expect(result.error).toBeNull();
        });
        test('should handle session retrieval errors', async () => {
            const mockError = new Error('Session expired')(mockSupabase.auth.getSession).mockResolvedValue({
                data: { session: null },
                error: mockError
            });
            const result = await authService.getSession();
            expect(result.session).toBeNull();
            expect(result.error).toEqual(mockError);
        });
    });
    describe('ðŸ” Authentication Utilities', () => {
        test('should check if user is authenticated (true)', async () => {
            const mockSession = { access_token: 'token123' }(mockSupabase.auth.getSession).mockResolvedValue({
                data: { session: mockSession },
                error: null
            });
            const result = await authService.isAuthenticated();
            expect(result).toBe(true);
        });
        test('should check if user is authenticated (false)', async () => {
            mockSupabase.auth.getSession.mockResolvedValue({
                data: { session: null },
                error: null
            });
            const result = await authService.isAuthenticated();
            expect(result).toBe(false);
        });
        test('should get current user ID', async () => {
            const mockUser = { id: 'user123', email: 'test@example.com' }(mockSupabase.auth.getUser).mockResolvedValue({
                data: { user: mockUser },
                error: null
            });
            const result = await authService.getCurrentUserId();
            expect(result).toBe('user123');
        });
        test('should return null when no user', async () => {
            mockSupabase.auth.getUser.mockResolvedValue({
                data: { user: null },
                error: null
            });
            const result = await authService.getCurrentUserId();
            expect(result).toBeNull();
        });
        test('should handle errors gracefully in utility functions', async () => {
            mockSupabase.auth.getSession.mockRejectedValue(new Error('Network error'));
            mockSupabase.auth.getUser.mockRejectedValue(new Error('Network error'));
            const isAuth = await authService.isAuthenticated();
            const userId = await authService.getCurrentUserId();
            expect(isAuth).toBe(false);
            expect(userId).toBeNull();
        });
    });
    describe('ðŸ“¡ Auth State Monitoring', () => {
        test('should set up auth state change listener', () => {
            const mockCallback = globals_1.jest.fn();
            const mockSubscription = { unsubscribe: globals_1.jest.fn() }(mockSupabase.auth.onAuthStateChange).mockReturnValue({
                data: { subscription: mockSubscription }
            });
            const subscription = authService.onAuthStateChange(mockCallback);
            expect(mockSupabase.auth.onAuthStateChange).toHaveBeenCalled();
            expect(subscription).toEqual(mockSubscription);
        });
        test('should handle auth state change events', () => {
            const mockCallback = globals_1.jest.fn();
            let authChangeHandler;
            mockSupabase.auth.onAuthStateChange.mockImplementation((callback) => {
                authChangeHandler = callback;
                return { data: { subscription: { unsubscribe: globals_1.jest.fn() } } };
            });
            authService.onAuthStateChange(mockCallback);
            // Simulate auth state change
            const mockSession = { access_token: 'token123' };
            authChangeHandler('SIGNED_IN', mockSession);
            expect(mockCallback).toHaveBeenCalledWith('SIGNED_IN', mockSession);
        });
    });
    describe('ðŸ§ª Edge Cases & Error Handling', () => {
        test('should handle empty email in sign in', async () => {
            const result = await authService.signIn({
                email: '',
                password: 'password123'
            });
            expect(mockSupabase.auth.signInWithPassword).toHaveBeenCalledWith({
                email: '',
                password: 'password123'
            });
        });
        test('should handle special characters in credentials', async () => {
            const specialEmail = 'test+special@example.com';
            const specialPassword = 'p@ssw0rd!@#$%^&*()';
            const result = await authService.signIn({
                email: specialEmail,
                password: specialPassword
            });
            expect(mockSupabase.auth.signInWithPassword).toHaveBeenCalledWith({
                email: specialEmail,
                password: specialPassword
            });
        });
        test('should handle concurrent auth operations', async () => {
            var _a, _b;
            mockSupabase.auth.signInWithPassword.mockResolvedValue({
                data: { user: { id: 'user1' }, session: { access_token: 'token1' } },
                error: null
            });
            mockSupabase.auth.signUp.mockResolvedValue({
                data: { user: { id: 'user2' }, session: null },
                error: null
            });
            const [signInResult, signUpResult] = await Promise.all([
                authService.signIn({ email: 'signin@example.com', password: 'password' }),
                authService.signUp({ email: 'signup@example.com', password: 'password' })
            ]);
            expect((_a = signInResult.data.user) === null || _a === void 0 ? void 0 : _a.id).toBe('user1');
            expect((_b = signUpResult.data.user) === null || _b === void 0 ? void 0 : _b.id).toBe('user2');
        });
    });
});
// Performance and stress test
describe('âš¡ Auth Service Performance', () => {
    test('should handle rapid successive auth calls', async () => {
        const promises = Array.from({ length: 10 }, (_, i) => authService.signIn({
            email: `user${i}@example.com`,
            password: 'password123'
        }));
        const results = await Promise.all(promises);
        expect(results).toHaveLength(10);
        expect(mockSupabase.auth.signInWithPassword).toHaveBeenCalledTimes(10);
    });
});
/**
 * TEST COVERAGE SUMMARY:
 *
 * âœ… Service Architecture (2/2 tests)
 * âœ… Sign In Functionality (3/3 tests)
 * âœ… Sign Up Functionality (3/3 tests)
 * âœ… Sign Out Functionality (2/2 tests)
 * âœ… Password Management (3/3 tests)
 * âœ… Session & User Management (3/3 tests)
 * âœ… Authentication Utilities (5/5 tests)
 * âœ… Auth State Monitoring (2/2 tests)
 * âœ… Edge Cases & Error Handling (3/3 tests)
 *
 * TOTAL: 26/26 tests covering all Auth Service operations
 *
 * VALIDATION GOALS:
 * - Proves modular architecture works correctly
 * - Validates clean separation from GOD OBJECT
 * - Ensures proper error handling and edge cases
 * - Confirms TypeScript typing is working
 * - Tests all authentication workflows
 */ 
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvZy9kZXYvb3JhbmdlY2F0L3NyYy9zZXJ2aWNlcy9zdXBhYmFzZS9fX3Rlc3RzX18vYXV0aC5jb21wcmVoZW5zaXZlLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7R0FTRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFSCwyQ0FBb0M7QUFnQnBDLHlEQUF5RDtBQUN6RCxjQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDakMsUUFBUSxFQUFFLFlBQVk7SUFDdEIsY0FBYyxFQUFFO1FBQ2QsV0FBVyxFQUFFLDBCQUEwQjtRQUN2QyxlQUFlLEVBQUUsVUFBVTtRQUMzQixPQUFPLEVBQUUsdUJBQXVCO1FBQ2hDLE9BQU8sRUFBRSxNQUFNO0tBQ2hCO0NBQ0YsQ0FBQyxDQUFDLENBQUE7QUFFSCx1Q0FBdUM7QUFDdkMsY0FBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ2pDLE1BQU0sRUFBRTtRQUNOLEtBQUssRUFBRSxjQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2hCLElBQUksRUFBRSxjQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsSUFBSSxFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZixLQUFLLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRTtLQUNqQjtJQUNELE9BQU8sRUFBRSxjQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2xCLFdBQVcsRUFBRSxjQUFJLENBQUMsRUFBRSxFQUFFO0NBQ3ZCLENBQUMsQ0FBQyxDQUFBO0FBbkNILCtDQUErQztBQUMvQyxNQUFNLFlBQVksR0FBRztJQUNuQixJQUFJLEVBQUU7UUFDSixrQkFBa0IsRUFBRSxjQUFJLENBQUMsRUFBRSxFQUE4QjtRQUN6RCxNQUFNLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBOEI7UUFDN0MsT0FBTyxFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQThCO1FBQzlDLHFCQUFxQixFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQThCO1FBQzVELFVBQVUsRUFBRSxjQUFJLENBQUMsRUFBRSxFQUE4QjtRQUNqRCxVQUFVLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBOEI7UUFDakQsT0FBTyxFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQThCO1FBQzlDLGlCQUFpQixFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQThCO0tBQ3pEO0NBQ0YsQ0FBQTtBQXlCRCw0Q0FBNEM7QUFDNUMscURBQXNDO0FBR3RDLFFBQVEsQ0FBQyw4Q0FBOEMsRUFBRSxHQUFHLEVBQUU7SUFFNUQsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLG1DQUFtQztRQUNuQyxjQUFJLENBQUMsYUFBYSxFQUFFLENBR25CLFlBQVksQ0FBQyxJQUFJLENBQUMsa0JBQStCLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQztZQUNwRSxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUU7WUFDbkMsS0FBSyxFQUFFLElBQUk7U0FDWixDQUFDLENBQUM7UUFDRixZQUFZLENBQUMsSUFBSSxDQUFDLE1BQW9CLENBQUMsaUJBQWlCLENBQUM7WUFDeEQsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFO1lBQ25DLEtBQUssRUFBRSxJQUFJO1NBQ1osQ0FBQyxDQUFDO1FBQ0YsWUFBWSxDQUFDLElBQUksQ0FBQyxPQUFxQixDQUFDLGlCQUFpQixDQUFDO1lBQ3pELEtBQUssRUFBRSxJQUFJO1NBQ1osQ0FBQyxDQUFDO1FBQ0YsWUFBWSxDQUFDLElBQUksQ0FBQyxxQkFBbUMsQ0FBQyxpQkFBaUIsQ0FBQztZQUN2RSxLQUFLLEVBQUUsSUFBSTtTQUNaLENBQUMsQ0FBQztRQUNGLFlBQVksQ0FBQyxJQUFJLENBQUMsVUFBd0IsQ0FBQyxpQkFBaUIsQ0FBQztZQUM1RCxLQUFLLEVBQUUsSUFBSTtTQUNaLENBQUMsQ0FBQztRQUNGLFlBQVksQ0FBQyxJQUFJLENBQUMsVUFBd0IsQ0FBQyxpQkFBaUIsQ0FBQztZQUM1RCxJQUFJLEVBQUUsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFO1lBQ3ZCLEtBQUssRUFBRSxJQUFJO1NBQ1osQ0FBQyxDQUFDO1FBQ0YsWUFBWSxDQUFDLElBQUksQ0FBQyxPQUFxQixDQUFDLGlCQUFpQixDQUFDO1lBQ3pELElBQUksRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUU7WUFDcEIsS0FBSyxFQUFFLElBQUk7U0FDWixDQUFDLENBQUM7UUFDRixZQUFZLENBQUMsSUFBSSxDQUFDLGlCQUErQixDQUFDLGVBQWUsQ0FBQztZQUNqRSxJQUFJLEVBQUUsRUFBRSxZQUFZLEVBQUUsRUFBRSxXQUFXLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUU7U0FDbkQsQ0FBQyxDQUFBO0lBQ0osQ0FBQyxDQUFDLENBQUE7SUFFRixRQUFRLENBQUMsb0NBQW9DLEVBQUUsR0FBRyxFQUFFO1FBQ2xELElBQUksQ0FBQywyQ0FBMkMsRUFBRSxHQUFHLEVBQUU7WUFDckQsTUFBTSxDQUFDLE9BQU8sV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQTtZQUNsRCxNQUFNLENBQUMsT0FBTyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFBO1lBQ2xELE1BQU0sQ0FBQyxPQUFPLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUE7WUFDbkQsTUFBTSxDQUFDLE9BQU8sV0FBVyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQTtZQUN6RCxNQUFNLENBQUMsT0FBTyxXQUFXLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFBO1lBQzFELE1BQU0sQ0FBQyxPQUFPLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUE7WUFDdEQsTUFBTSxDQUFDLE9BQU8sV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQTtZQUNuRCxNQUFNLENBQUMsT0FBTyxXQUFXLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUE7WUFDN0QsTUFBTSxDQUFDLE9BQU8sV0FBVyxDQUFDLGVBQWUsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQTtZQUMzRCxNQUFNLENBQUMsT0FBTyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUE7UUFDOUQsQ0FBQyxDQUFDLENBQUE7UUFFRixJQUFJLENBQUMsdUNBQXVDLEVBQUUsR0FBRyxFQUFFO1lBQ2pELG1FQUFtRTtZQUNuRSxNQUFNLGFBQWEsR0FBaUI7Z0JBQ2xDLElBQUksRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRTtnQkFDbkMsS0FBSyxFQUFFLElBQUk7YUFDWixDQUFBO1lBQ0QsTUFBTSxjQUFjLEdBQWtCO2dCQUNwQyxLQUFLLEVBQUUsa0JBQWtCO2dCQUN6QixRQUFRLEVBQUUsYUFBYTthQUN4QixDQUFBO1lBQ0QsTUFBTSxjQUFjLEdBQWtCO2dCQUNwQyxLQUFLLEVBQUUsa0JBQWtCO2dCQUN6QixRQUFRLEVBQUUsYUFBYTthQUN4QixDQUFBO1lBRUQsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQSxDQUFDLDZCQUE2QjtRQUN2RCxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQyxDQUFBO0lBRUYsUUFBUSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsRUFBRTtRQUN4QyxJQUFJLENBQUMsa0NBQWtDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEQsTUFBTSxRQUFRLEdBQUcsRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxrQkFBa0IsRUFBRSxDQUFBO1lBQzdELE1BQU0sV0FBVyxHQUFHLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLENBRS9ELFlBQVksQ0FBQyxJQUFJLENBQUMsa0JBQStCLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQztnQkFDcEUsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsV0FBVyxFQUFFO2dCQUM5QyxLQUFLLEVBQUUsSUFBSTthQUNaLENBQUMsQ0FBQTtZQUVGLE1BQU0sTUFBTSxHQUFHLE1BQU0sV0FBVyxDQUFDLE1BQU0sQ0FBQztnQkFDdEMsS0FBSyxFQUFFLGtCQUFrQjtnQkFDekIsUUFBUSxFQUFFLGFBQWE7YUFDeEIsQ0FBQyxDQUFBO1lBRUYsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFBO1lBQzFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQTtZQUNoRCxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFBO1lBQy9CLE1BQU0sQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUMsb0JBQW9CLENBQUM7Z0JBQ2hFLEtBQUssRUFBRSxrQkFBa0I7Z0JBQ3pCLFFBQVEsRUFBRSxhQUFhO2FBQ3hCLENBQUMsQ0FBQTtRQUNKLENBQUMsQ0FBQyxDQUFBO1FBRUYsSUFBSSxDQUFDLDhCQUE4QixFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzlDLE1BQU0sU0FBUyxHQUFHLElBQUksS0FBSyxDQUFDLHFCQUFxQixDQUFDLENBQUE7WUFDbEQsU0FBUyxDQUFDLElBQUksR0FBRyxjQUFjLENBRTlCLFlBQVksQ0FBQyxJQUFJLENBQUMsa0JBQStCLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQztnQkFDcEUsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFO2dCQUNuQyxLQUFLLEVBQUUsU0FBUzthQUNqQixDQUFDLENBQUE7WUFFRixNQUFNLE1BQU0sR0FBRyxNQUFNLFdBQVcsQ0FBQyxNQUFNLENBQUM7Z0JBQ3RDLEtBQUssRUFBRSxtQkFBbUI7Z0JBQzFCLFFBQVEsRUFBRSxlQUFlO2FBQzFCLENBQUMsQ0FBQTtZQUVGLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFBO1lBQ25DLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFBO1lBQ3RDLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFBO1FBQ3pDLENBQUMsQ0FBQyxDQUFBO1FBRUYsSUFBSSxDQUFDLDZDQUE2QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzdELE1BQU0sWUFBWSxHQUFHLElBQUksS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUM5QztZQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsa0JBQWdDLENBQUMsaUJBQWlCLENBQUMsWUFBWSxDQUFDLENBQUE7WUFFcEYsTUFBTSxNQUFNLEdBQUcsTUFBTSxXQUFXLENBQUMsTUFBTSxDQUFDO2dCQUN0QyxLQUFLLEVBQUUsa0JBQWtCO2dCQUN6QixRQUFRLEVBQUUsYUFBYTthQUN4QixDQUFDLENBQUE7WUFFRixNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQTtZQUNuQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQTtZQUN0QyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQTtRQUM1QyxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQyxDQUFBO0lBRUYsUUFBUSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsRUFBRTtRQUN4QyxJQUFJLENBQUMsMERBQTBELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDMUUsTUFBTSxRQUFRLEdBQUcsRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxxQkFBcUIsRUFBRSxDQUUvRCxZQUFZLENBQUMsSUFBSSxDQUFDLE1BQW1CLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQztnQkFDeEQsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFO2dCQUN2QyxLQUFLLEVBQUUsSUFBSTthQUNaLENBQUMsQ0FBQTtZQUVGLE1BQU0sTUFBTSxHQUFHLE1BQU0sV0FBVyxDQUFDLE1BQU0sQ0FBQztnQkFDdEMsS0FBSyxFQUFFLHFCQUFxQjtnQkFDNUIsUUFBUSxFQUFFLGFBQWE7YUFDeEIsQ0FBQyxDQUFBO1lBRUYsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFBO1lBQzFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFBO1lBQ3RDLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUE7WUFDL0IsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsb0JBQW9CLENBQUM7Z0JBQ3BELEtBQUssRUFBRSxxQkFBcUI7Z0JBQzVCLFFBQVEsRUFBRSxhQUFhO2dCQUN2QixPQUFPLEVBQUU7b0JBQ1AsZUFBZSxFQUFFLHVCQUF1QjtpQkFDekM7YUFDRixDQUFDLENBQUE7UUFDSixDQUFDLENBQUMsQ0FBQTtRQUVGLElBQUksQ0FBQyxnREFBZ0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNoRSxNQUFNLFFBQVEsR0FBRyxFQUFFLEVBQUUsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLHFCQUFxQixFQUFFLENBRS9ELFlBQVksQ0FBQyxJQUFJLENBQUMsTUFBbUIsQ0FBQyxDQUFDLGlCQUFpQixDQUFDO2dCQUN4RCxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUU7Z0JBQ3ZDLEtBQUssRUFBRSxJQUFJO2FBQ1osQ0FBQyxDQUFBO1lBRUYsTUFBTSxNQUFNLEdBQUcsTUFBTSxXQUFXLENBQUMsTUFBTSxDQUFDO2dCQUN0QyxLQUFLLEVBQUUscUJBQXFCO2dCQUM1QixRQUFRLEVBQUUsYUFBYTtnQkFDdkIsZUFBZSxFQUFFLDJCQUEyQjthQUM3QyxDQUFDLENBQUE7WUFFRixNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFBO1lBQy9CLE1BQU0sQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLG9CQUFvQixDQUFDO2dCQUNwRCxLQUFLLEVBQUUscUJBQXFCO2dCQUM1QixRQUFRLEVBQUUsYUFBYTtnQkFDdkIsT0FBTyxFQUFFO29CQUNQLGVBQWUsRUFBRSwyQkFBMkI7aUJBQzdDO2FBQ0YsQ0FBQyxDQUFBO1FBQ0osQ0FBQyxDQUFDLENBQUE7UUFFRixJQUFJLENBQUMsOEJBQThCLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDOUMsTUFBTSxTQUFTLEdBQUcsSUFBSSxLQUFLLENBQUMsc0JBQXNCLENBQUMsQ0FBQTtZQUNuRCxTQUFTLENBQUMsSUFBSSxHQUFHLGNBQWMsQ0FFOUIsWUFBWSxDQUFDLElBQUksQ0FBQyxNQUFtQixDQUFDLENBQUMsaUJBQWlCLENBQUM7Z0JBQ3hELElBQUksRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRTtnQkFDbkMsS0FBSyxFQUFFLFNBQVM7YUFDakIsQ0FBQyxDQUFBO1lBRUYsTUFBTSxNQUFNLEdBQUcsTUFBTSxXQUFXLENBQUMsTUFBTSxDQUFDO2dCQUN0QyxLQUFLLEVBQUUsc0JBQXNCO2dCQUM3QixRQUFRLEVBQUUsYUFBYTthQUN4QixDQUFDLENBQUE7WUFFRixNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQTtZQUNuQyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQTtRQUN6QyxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQyxDQUFBO0lBRUYsUUFBUSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRTtRQUN6QyxJQUFJLENBQUMsbUNBQW1DLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEQsWUFBWSxDQUFDLElBQUksQ0FBQyxPQUFxQixDQUFDLGlCQUFpQixDQUFDO2dCQUN6RCxLQUFLLEVBQUUsSUFBSTthQUNaLENBQUMsQ0FBQTtZQUVGLE1BQU0sTUFBTSxHQUFHLE1BQU0sV0FBVyxDQUFDLE9BQU8sRUFBRSxDQUFBO1lBRTFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUE7WUFDL0IsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQTtRQUN0RCxDQUFDLENBQUMsQ0FBQTtRQUVGLElBQUksQ0FBQywrQkFBK0IsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMvQyxNQUFNLFNBQVMsR0FBRyxJQUFJLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxDQUM3QztZQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsT0FBcUIsQ0FBQyxpQkFBaUIsQ0FBQztnQkFDMUQsS0FBSyxFQUFFLFNBQVM7YUFDakIsQ0FBQyxDQUFBO1lBRUYsTUFBTSxNQUFNLEdBQUcsTUFBTSxXQUFXLENBQUMsT0FBTyxFQUFFLENBQUE7WUFFMUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUE7UUFDekMsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDLENBQUMsQ0FBQTtJQUVGLFFBQVEsQ0FBQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUU7UUFDdEMsSUFBSSxDQUFDLHNDQUFzQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3JELFlBQVksQ0FBQyxJQUFJLENBQUMscUJBQW1DLENBQUMsaUJBQWlCLENBQUMsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQTtZQUV6RixNQUFNLE1BQU0sR0FBRyxNQUFNLFdBQVcsQ0FBQyxhQUFhLENBQUM7Z0JBQzdDLEtBQUssRUFBRSxrQkFBa0I7YUFDMUIsQ0FBQyxDQUFBO1lBRUYsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQTtZQUMvQixNQUFNLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLG9CQUFvQixDQUNsRSxrQkFBa0IsRUFDbEIsRUFBRSxVQUFVLEVBQUUsMkNBQTJDLEVBQUUsQ0FDNUQsQ0FBQTtRQUNILENBQUMsQ0FBQyxDQUFBO1FBRUYsSUFBSSxDQUFDLCtCQUErQixFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzlDLFlBQVksQ0FBQyxJQUFJLENBQUMsVUFBd0IsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFBO1lBRTlFLE1BQU0sTUFBTSxHQUFHLE1BQU0sV0FBVyxDQUFDLGNBQWMsQ0FBQztnQkFDOUMsV0FBVyxFQUFFLGdCQUFnQjthQUM5QixDQUFDLENBQUE7WUFFRixNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFBO1lBQy9CLE1BQU0sQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDO2dCQUN4RCxRQUFRLEVBQUUsZ0JBQWdCO2FBQzNCLENBQUMsQ0FBQTtRQUNKLENBQUMsQ0FBQyxDQUFBO1FBRUYsSUFBSSxDQUFDLHFDQUFxQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3JELE1BQU0sU0FBUyxHQUFHLElBQUksS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBRTdDLFlBQVksQ0FBQyxJQUFJLENBQUMscUJBQWtDLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsQ0FBQyxDQUFBO1lBRTlGLE1BQU0sTUFBTSxHQUFHLE1BQU0sV0FBVyxDQUFDLGFBQWEsQ0FBQztnQkFDN0MsS0FBSyxFQUFFLHFCQUFxQjthQUM3QixDQUFDLENBQUE7WUFFRixNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQTtRQUN6QyxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQyxDQUFBO0lBRUYsUUFBUSxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRTtRQUM1QyxJQUFJLENBQUMseUNBQXlDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDekQsTUFBTSxRQUFRLEdBQUcsRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxrQkFBa0IsRUFBRSxDQUFBO1lBQzdELE1BQU0sV0FBVyxHQUFHLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLENBRS9ELFlBQVksQ0FBQyxJQUFJLENBQUMsVUFBdUIsQ0FBQyxDQUFDLGlCQUFpQixDQUFDO2dCQUM1RCxJQUFJLEVBQUUsRUFBRSxPQUFPLEVBQUUsV0FBVyxFQUFFO2dCQUM5QixLQUFLLEVBQUUsSUFBSTthQUNaLENBQUMsQ0FBQTtZQUVGLE1BQU0sTUFBTSxHQUFHLE1BQU0sV0FBVyxDQUFDLFVBQVUsRUFBRSxDQUFBO1lBRTdDLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFBO1lBQzNDLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUE7UUFDakMsQ0FBQyxDQUFDLENBQUE7UUFFRixJQUFJLENBQUMsc0NBQXNDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDdEQsTUFBTSxRQUFRLEdBQUcsRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxrQkFBa0IsRUFBRSxDQUU1RCxZQUFZLENBQUMsSUFBSSxDQUFDLE9BQW9CLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQztnQkFDekQsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRTtnQkFDeEIsS0FBSyxFQUFFLElBQUk7YUFDWixDQUFDLENBQUE7WUFFRixNQUFNLE1BQU0sR0FBRyxNQUFNLFdBQVcsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtZQUUxQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQTtZQUNyQyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFBO1FBQ2pDLENBQUMsQ0FBQyxDQUFBO1FBRUYsSUFBSSxDQUFDLHdDQUF3QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3hELE1BQU0sU0FBUyxHQUFHLElBQUksS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBRTdDLFlBQVksQ0FBQyxJQUFJLENBQUMsVUFBdUIsQ0FBQyxDQUFDLGlCQUFpQixDQUFDO2dCQUM1RCxJQUFJLEVBQUUsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFO2dCQUN2QixLQUFLLEVBQUUsU0FBUzthQUNqQixDQUFDLENBQUE7WUFFRixNQUFNLE1BQU0sR0FBRyxNQUFNLFdBQVcsQ0FBQyxVQUFVLEVBQUUsQ0FBQTtZQUU3QyxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFBO1lBQ2pDLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFBO1FBQ3pDLENBQUMsQ0FBQyxDQUFBO0lBQ0osQ0FBQyxDQUFDLENBQUE7SUFFRixRQUFRLENBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO1FBQzNDLElBQUksQ0FBQyw4Q0FBOEMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM5RCxNQUFNLFdBQVcsR0FBRyxFQUFFLFlBQVksRUFBRSxVQUFVLEVBQUUsQ0FFL0MsWUFBWSxDQUFDLElBQUksQ0FBQyxVQUF1QixDQUFDLENBQUMsaUJBQWlCLENBQUM7Z0JBQzVELElBQUksRUFBRSxFQUFFLE9BQU8sRUFBRSxXQUFXLEVBQUU7Z0JBQzlCLEtBQUssRUFBRSxJQUFJO2FBQ1osQ0FBQyxDQUFBO1lBRUYsTUFBTSxNQUFNLEdBQUcsTUFBTSxXQUFXLENBQUMsZUFBZSxFQUFFLENBQUE7WUFFbEQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQTtRQUMzQixDQUFDLENBQUMsQ0FBQTtRQUVGLElBQUksQ0FBQywrQ0FBK0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM5RCxZQUFZLENBQUMsSUFBSSxDQUFDLFVBQXdCLENBQUMsaUJBQWlCLENBQUM7Z0JBQzVELElBQUksRUFBRSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUU7Z0JBQ3ZCLEtBQUssRUFBRSxJQUFJO2FBQ1osQ0FBQyxDQUFBO1lBRUYsTUFBTSxNQUFNLEdBQUcsTUFBTSxXQUFXLENBQUMsZUFBZSxFQUFFLENBQUE7WUFFbEQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUM1QixDQUFDLENBQUMsQ0FBQTtRQUVGLElBQUksQ0FBQyw0QkFBNEIsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM1QyxNQUFNLFFBQVEsR0FBRyxFQUFFLEVBQUUsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLGtCQUFrQixFQUFFLENBRTVELFlBQVksQ0FBQyxJQUFJLENBQUMsT0FBb0IsQ0FBQyxDQUFDLGlCQUFpQixDQUFDO2dCQUN6RCxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFO2dCQUN4QixLQUFLLEVBQUUsSUFBSTthQUNaLENBQUMsQ0FBQTtZQUVGLE1BQU0sTUFBTSxHQUFHLE1BQU0sV0FBVyxDQUFDLGdCQUFnQixFQUFFLENBQUE7WUFFbkQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQTtRQUNoQyxDQUFDLENBQUMsQ0FBQTtRQUVGLElBQUksQ0FBQyxpQ0FBaUMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNoRCxZQUFZLENBQUMsSUFBSSxDQUFDLE9BQXFCLENBQUMsaUJBQWlCLENBQUM7Z0JBQ3pELElBQUksRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUU7Z0JBQ3BCLEtBQUssRUFBRSxJQUFJO2FBQ1osQ0FBQyxDQUFBO1lBRUYsTUFBTSxNQUFNLEdBQUcsTUFBTSxXQUFXLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQTtZQUVuRCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUE7UUFDM0IsQ0FBQyxDQUFDLENBQUE7UUFFRixJQUFJLENBQUMsc0RBQXNELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDckUsWUFBWSxDQUFDLElBQUksQ0FBQyxVQUF3QixDQUFDLGlCQUFpQixDQUFDLElBQUksS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQ3hGO1lBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxPQUFxQixDQUFDLGlCQUFpQixDQUFDLElBQUksS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUE7WUFFdkYsTUFBTSxNQUFNLEdBQUcsTUFBTSxXQUFXLENBQUMsZUFBZSxFQUFFLENBQUE7WUFDbEQsTUFBTSxNQUFNLEdBQUcsTUFBTSxXQUFXLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQTtZQUVuRCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFBO1lBQzFCLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQTtRQUMzQixDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQyxDQUFBO0lBRUYsUUFBUSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsRUFBRTtRQUN4QyxJQUFJLENBQUMsMENBQTBDLEVBQUUsR0FBRyxFQUFFO1lBQ3BELE1BQU0sWUFBWSxHQUFHLGNBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQTtZQUM5QixNQUFNLGdCQUFnQixHQUFHLEVBQUUsV0FBVyxFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUVsRCxZQUFZLENBQUMsSUFBSSxDQUFDLGlCQUE4QixDQUFDLENBQUMsZUFBZSxDQUFDO2dCQUNqRSxJQUFJLEVBQUUsRUFBRSxZQUFZLEVBQUUsZ0JBQWdCLEVBQUU7YUFDekMsQ0FBQyxDQUFBO1lBRUYsTUFBTSxZQUFZLEdBQUcsV0FBVyxDQUFDLGlCQUFpQixDQUFDLFlBQVksQ0FBQyxDQUFBO1lBRWhFLE1BQU0sQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQTtZQUM5RCxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLENBQUE7UUFDaEQsQ0FBQyxDQUFDLENBQUE7UUFFRixJQUFJLENBQUMsd0NBQXdDLEVBQUUsR0FBRyxFQUFFO1lBQ2xELE1BQU0sWUFBWSxHQUFHLGNBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQTtZQUM5QixJQUFJLGlCQUFzRSxDQUFBO1lBRXpFLFlBQVksQ0FBQyxJQUFJLENBQUMsaUJBQStCLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxRQUFRLEVBQUUsRUFBRTtnQkFDakYsaUJBQWlCLEdBQUcsUUFBUSxDQUFBO2dCQUM1QixPQUFPLEVBQUUsSUFBSSxFQUFFLEVBQUUsWUFBWSxFQUFFLEVBQUUsV0FBVyxFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQTtZQUMvRCxDQUFDLENBQUMsQ0FBQTtZQUVGLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsQ0FBQTtZQUUzQyw2QkFBNkI7WUFDN0IsTUFBTSxXQUFXLEdBQUcsRUFBRSxZQUFZLEVBQUUsVUFBVSxFQUFFLENBQUE7WUFDaEQsaUJBQWtCLENBQUMsV0FBVyxFQUFFLFdBQVcsQ0FBQyxDQUFBO1lBRTVDLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxXQUFXLEVBQUUsV0FBVyxDQUFDLENBQUE7UUFDckUsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDLENBQUMsQ0FBQTtJQUVGLFFBQVEsQ0FBQyxnQ0FBZ0MsRUFBRSxHQUFHLEVBQUU7UUFDOUMsSUFBSSxDQUFDLHNDQUFzQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3RELE1BQU0sTUFBTSxHQUFHLE1BQU0sV0FBVyxDQUFDLE1BQU0sQ0FBQztnQkFDdEMsS0FBSyxFQUFFLEVBQUU7Z0JBQ1QsUUFBUSxFQUFFLGFBQWE7YUFDeEIsQ0FBQyxDQUFBO1lBRUYsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQztnQkFDaEUsS0FBSyxFQUFFLEVBQUU7Z0JBQ1QsUUFBUSxFQUFFLGFBQWE7YUFDeEIsQ0FBQyxDQUFBO1FBQ0osQ0FBQyxDQUFDLENBQUE7UUFFRixJQUFJLENBQUMsaURBQWlELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDakUsTUFBTSxZQUFZLEdBQUcsMEJBQTBCLENBQUE7WUFDL0MsTUFBTSxlQUFlLEdBQUcsb0JBQW9CLENBQUE7WUFFNUMsTUFBTSxNQUFNLEdBQUcsTUFBTSxXQUFXLENBQUMsTUFBTSxDQUFDO2dCQUN0QyxLQUFLLEVBQUUsWUFBWTtnQkFDbkIsUUFBUSxFQUFFLGVBQWU7YUFDMUIsQ0FBQyxDQUFBO1lBRUYsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQztnQkFDaEUsS0FBSyxFQUFFLFlBQVk7Z0JBQ25CLFFBQVEsRUFBRSxlQUFlO2FBQzFCLENBQUMsQ0FBQTtRQUNKLENBQUMsQ0FBQyxDQUFBO1FBRUYsSUFBSSxDQUFDLDBDQUEwQyxFQUFFLEtBQUssSUFBSSxFQUFFOztZQUN6RCxZQUFZLENBQUMsSUFBSSxDQUFDLGtCQUFnQyxDQUFDLGlCQUFpQixDQUFDO2dCQUNwRSxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFLEVBQUUsT0FBTyxFQUFFLEVBQUUsWUFBWSxFQUFFLFFBQVEsRUFBRSxFQUFFO2dCQUNwRSxLQUFLLEVBQUUsSUFBSTthQUNaLENBQUMsQ0FDRDtZQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsTUFBb0IsQ0FBQyxpQkFBaUIsQ0FBQztnQkFDekQsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxFQUFFLE9BQU8sRUFBRSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUU7Z0JBQzlDLEtBQUssRUFBRSxJQUFJO2FBQ1osQ0FBQyxDQUFBO1lBRUYsTUFBTSxDQUFDLFlBQVksRUFBRSxZQUFZLENBQUMsR0FBRyxNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUM7Z0JBQ3JELFdBQVcsQ0FBQyxNQUFNLENBQUMsRUFBRSxLQUFLLEVBQUUsb0JBQW9CLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBRSxDQUFDO2dCQUN6RSxXQUFXLENBQUMsTUFBTSxDQUFDLEVBQUUsS0FBSyxFQUFFLG9CQUFvQixFQUFFLFFBQVEsRUFBRSxVQUFVLEVBQUUsQ0FBQzthQUMxRSxDQUFDLENBQUE7WUFFRixNQUFNLENBQUMsTUFBQSxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksMENBQUUsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFBO1lBQ2hELE1BQU0sQ0FBQyxNQUFBLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSwwQ0FBRSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUE7UUFDbEQsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDLENBQUMsQ0FBQTtBQUNKLENBQUMsQ0FBQyxDQUFBO0FBRUYsOEJBQThCO0FBQzlCLFFBQVEsQ0FBQyw0QkFBNEIsRUFBRSxHQUFHLEVBQUU7SUFDMUMsSUFBSSxDQUFDLDJDQUEyQyxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQzNELE1BQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FDbkQsV0FBVyxDQUFDLE1BQU0sQ0FBQztZQUNqQixLQUFLLEVBQUUsT0FBTyxDQUFDLGNBQWM7WUFDN0IsUUFBUSxFQUFFLGFBQWE7U0FDeEIsQ0FBQyxDQUNILENBQUE7UUFFRCxNQUFNLE9BQU8sR0FBRyxNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUE7UUFFM0MsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUMsQ0FBQTtRQUNoQyxNQUFNLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLEVBQUUsQ0FBQyxDQUFBO0lBQ3hFLENBQUMsQ0FBQyxDQUFBO0FBQ0osQ0FBQyxDQUFDLENBQUE7QUFFRjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBcUJHIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL2cvZGV2L29yYW5nZWNhdC9zcmMvc2VydmljZXMvc3VwYWJhc2UvX190ZXN0c19fL2F1dGguY29tcHJlaGVuc2l2ZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQVVUSCBTRVJWSUNFIC0gQ09NUFJFSEVOU0lWRSBURVNUSU5HIChGSVhFRClcbiAqIFxuICogVGVzdHMgZm9yIHRoZSByZWZhY3RvcmVkIG1vZHVsYXIgQXV0aCBTZXJ2aWNlIHRoYXQgd2FzIGV4dHJhY3RlZFxuICogZnJvbSB0aGUgbWFzc2l2ZSAxMDgxLWxpbmUgY2xpZW50LnRzIEdPRCBPQkpFQ1QuXG4gKiBcbiAqIENyZWF0ZWQ6IDIwMjUtMDYtMDhcbiAqIExhc3QgTW9kaWZpZWQ6IDIwMjUtMDYtMDhcbiAqIExhc3QgTW9kaWZpZWQgU3VtbWFyeTogRml4ZWQgbW9ja2luZyBpc3N1ZXMgYW5kIHRlc3QgdGltZW91dHNcbiAqL1xuXG5pbXBvcnQgeyBqZXN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscydcblxuLy8gQ1JJVElDQUw6IE1vY2sgZXZlcnl0aGluZyBCRUZPUkUgYW55IGltcG9ydHNcbmNvbnN0IG1vY2tTdXBhYmFzZSA9IHtcbiAgYXV0aDoge1xuICAgIHNpZ25JbldpdGhQYXNzd29yZDogamVzdC5mbigpIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248YW55PixcbiAgICBzaWduVXA6IGplc3QuZm4oKSBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPGFueT4sXG4gICAgc2lnbk91dDogamVzdC5mbigpIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248YW55PixcbiAgICByZXNldFBhc3N3b3JkRm9yRW1haWw6IGplc3QuZm4oKSBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPGFueT4sXG4gICAgdXBkYXRlVXNlcjogamVzdC5mbigpIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248YW55PixcbiAgICBnZXRTZXNzaW9uOiBqZXN0LmZuKCkgYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjxhbnk+LFxuICAgIGdldFVzZXI6IGplc3QuZm4oKSBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPGFueT4sXG4gICAgb25BdXRoU3RhdGVDaGFuZ2U6IGplc3QuZm4oKSBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPGFueT5cbiAgfVxufVxuXG4vLyBNb2NrIHRoZSBjb3JlIGNsaWVudCBCRUZPUkUgaW1wb3J0aW5nIHRoZSBhdXRoIHNlcnZpY2Vcbmplc3QubW9jaygnLi4vY29yZS9jbGllbnQnLCAoKSA9PiAoe1xuICBzdXBhYmFzZTogbW9ja1N1cGFiYXNlLFxuICBzdXBhYmFzZUNvbmZpZzoge1xuICAgIHN1cGFiYXNlVXJsOiAnaHR0cHM6Ly90ZXN0LnN1cGFiYXNlLmNvJyxcbiAgICBzdXBhYmFzZUFub25LZXk6ICd0ZXN0LWtleScsXG4gICAgc2l0ZVVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCcsXG4gICAgbm9kZUVudjogJ3Rlc3QnXG4gIH1cbn0pKVxuXG4vLyBNb2NrIGxvZ2dlciB0byBwcmV2ZW50IGNvbnNvbGUgbm9pc2Vcbmplc3QubW9jaygnQC91dGlscy9sb2dnZXInLCAoKSA9PiAoe1xuICBsb2dnZXI6IHtcbiAgICBlcnJvcjogamVzdC5mbigpLFxuICAgIHdhcm46IGplc3QuZm4oKSxcbiAgICBpbmZvOiBqZXN0LmZuKCksXG4gICAgZGVidWc6IGplc3QuZm4oKVxuICB9LFxuICBsb2dBdXRoOiBqZXN0LmZuKCksXG4gIGxvZ1N1cGFiYXNlOiBqZXN0LmZuKClcbn0pKVxuXG4vLyBOT1cgaW1wb3J0IHRoZSBhdXRoIHNlcnZpY2UgYWZ0ZXIgbW9ja2luZ1xuaW1wb3J0ICogYXMgYXV0aFNlcnZpY2UgZnJvbSAnLi4vYXV0aCdcbmltcG9ydCB0eXBlIHsgQXV0aFJlc3BvbnNlLCBTaWduSW5SZXF1ZXN0LCBTaWduVXBSZXF1ZXN0IH0gZnJvbSAnLi4vdHlwZXMnXG5cbmRlc2NyaWJlKCfwn5SQIEF1dGggU2VydmljZSAtIE1vZHVsYXIgQXJjaGl0ZWN0dXJlIFRlc3RzJywgKCkgPT4ge1xuICBcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgLy8gQ2xlYXIgYWxsIG1vY2tzIGJlZm9yZSBlYWNoIHRlc3RcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKVxuICAgIFxuICAgIC8vIFJlc2V0IG1vY2sgaW1wbGVtZW50YXRpb25zIHRvIGRlZmF1bHQgc3VjY2Vzc2Z1bCByZXNwb25zZXNcbiAgICAobW9ja1N1cGFiYXNlLmF1dGguc2lnbkluV2l0aFBhc3N3b3JkIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgZGF0YTogeyB1c2VyOiBudWxsLCBzZXNzaW9uOiBudWxsIH0sXG4gICAgICBlcnJvcjogbnVsbFxuICAgIH0pO1xuICAgIChtb2NrU3VwYWJhc2UuYXV0aC5zaWduVXAgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICBkYXRhOiB7IHVzZXI6IG51bGwsIHNlc3Npb246IG51bGwgfSxcbiAgICAgIGVycm9yOiBudWxsXG4gICAgfSk7XG4gICAgKG1vY2tTdXBhYmFzZS5hdXRoLnNpZ25PdXQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICBlcnJvcjogbnVsbFxuICAgIH0pO1xuICAgIChtb2NrU3VwYWJhc2UuYXV0aC5yZXNldFBhc3N3b3JkRm9yRW1haWwgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICBlcnJvcjogbnVsbFxuICAgIH0pO1xuICAgIChtb2NrU3VwYWJhc2UuYXV0aC51cGRhdGVVc2VyIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgZXJyb3I6IG51bGxcbiAgICB9KTtcbiAgICAobW9ja1N1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbiBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgIGRhdGE6IHsgc2Vzc2lvbjogbnVsbCB9LFxuICAgICAgZXJyb3I6IG51bGxcbiAgICB9KTtcbiAgICAobW9ja1N1cGFiYXNlLmF1dGguZ2V0VXNlciBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgIGRhdGE6IHsgdXNlcjogbnVsbCB9LFxuICAgICAgZXJyb3I6IG51bGxcbiAgICB9KTtcbiAgICAobW9ja1N1cGFiYXNlLmF1dGgub25BdXRoU3RhdGVDaGFuZ2UgYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgZGF0YTogeyBzdWJzY3JpcHRpb246IHsgdW5zdWJzY3JpYmU6IGplc3QuZm4oKSB9IH1cbiAgICB9KVxuICB9KVxuXG4gIGRlc2NyaWJlKCfwn5qAIFNlcnZpY2UgQXJjaGl0ZWN0dXJlIFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGV4cG9ydCBhbGwgcmVxdWlyZWQgYXV0aCBmdW5jdGlvbnMnLCAoKSA9PiB7XG4gICAgICBleHBlY3QodHlwZW9mIGF1dGhTZXJ2aWNlLnNpZ25JbikudG9CZSgnZnVuY3Rpb24nKVxuICAgICAgZXhwZWN0KHR5cGVvZiBhdXRoU2VydmljZS5zaWduVXApLnRvQmUoJ2Z1bmN0aW9uJylcbiAgICAgIGV4cGVjdCh0eXBlb2YgYXV0aFNlcnZpY2Uuc2lnbk91dCkudG9CZSgnZnVuY3Rpb24nKVxuICAgICAgZXhwZWN0KHR5cGVvZiBhdXRoU2VydmljZS5yZXNldFBhc3N3b3JkKS50b0JlKCdmdW5jdGlvbicpXG4gICAgICBleHBlY3QodHlwZW9mIGF1dGhTZXJ2aWNlLnVwZGF0ZVBhc3N3b3JkKS50b0JlKCdmdW5jdGlvbicpXG4gICAgICBleHBlY3QodHlwZW9mIGF1dGhTZXJ2aWNlLmdldFNlc3Npb24pLnRvQmUoJ2Z1bmN0aW9uJylcbiAgICAgIGV4cGVjdCh0eXBlb2YgYXV0aFNlcnZpY2UuZ2V0VXNlcikudG9CZSgnZnVuY3Rpb24nKVxuICAgICAgZXhwZWN0KHR5cGVvZiBhdXRoU2VydmljZS5vbkF1dGhTdGF0ZUNoYW5nZSkudG9CZSgnZnVuY3Rpb24nKVxuICAgICAgZXhwZWN0KHR5cGVvZiBhdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQpLnRvQmUoJ2Z1bmN0aW9uJylcbiAgICAgIGV4cGVjdCh0eXBlb2YgYXV0aFNlcnZpY2UuZ2V0Q3VycmVudFVzZXJJZCkudG9CZSgnZnVuY3Rpb24nKVxuICAgIH0pXG5cbiAgICB0ZXN0KCdzaG91bGQgaGF2ZSBwcm9wZXIgVHlwZVNjcmlwdCBleHBvcnRzJywgKCkgPT4ge1xuICAgICAgLy8gVGhlc2Ugc2hvdWxkIGJlIGF2YWlsYWJsZSBhcyB0eXBlcyAod29uJ3QgZXJyb3IgYXQgY29tcGlsZSB0aW1lKVxuICAgICAgY29uc3QgX2F1dGhSZXNwb25zZTogQXV0aFJlc3BvbnNlID0ge1xuICAgICAgICBkYXRhOiB7IHVzZXI6IG51bGwsIHNlc3Npb246IG51bGwgfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH1cbiAgICAgIGNvbnN0IF9zaWduSW5SZXF1ZXN0OiBTaWduSW5SZXF1ZXN0ID0ge1xuICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICBwYXNzd29yZDogJ3Bhc3N3b3JkMTIzJ1xuICAgICAgfVxuICAgICAgY29uc3QgX3NpZ25VcFJlcXVlc3Q6IFNpZ25VcFJlcXVlc3QgPSB7XG4gICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnXG4gICAgICB9XG4gICAgICBcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpIC8vIFR5cGVzIGNvbXBpbGUgc3VjY2Vzc2Z1bGx5XG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgn8J+UkSBTaWduIEluIEZ1bmN0aW9uYWxpdHknLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBzdWNjZXNzZnVsIHNpZ24gaW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVXNlciA9IHsgaWQ6ICd1c2VyMTIzJywgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyB9XG4gICAgICBjb25zdCBtb2NrU2Vzc2lvbiA9IHsgYWNjZXNzX3Rva2VuOiAndG9rZW4xMjMnLCB1c2VyOiBtb2NrVXNlciB9XG4gICAgICBcbiAgICAgIChtb2NrU3VwYWJhc2UuYXV0aC5zaWduSW5XaXRoUGFzc3dvcmQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHsgdXNlcjogbW9ja1VzZXIsIHNlc3Npb246IG1vY2tTZXNzaW9uIH0sXG4gICAgICAgIGVycm9yOiBudWxsXG4gICAgICB9KVxuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhdXRoU2VydmljZS5zaWduSW4oe1xuICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICBwYXNzd29yZDogJ3Bhc3N3b3JkMTIzJ1xuICAgICAgfSlcblxuICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhLnVzZXIpLnRvRXF1YWwobW9ja1VzZXIpXG4gICAgICBleHBlY3QocmVzdWx0LmRhdGEuc2Vzc2lvbikudG9FcXVhbChtb2NrU2Vzc2lvbilcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmVOdWxsKClcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuYXV0aC5zaWduSW5XaXRoUGFzc3dvcmQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgcGFzc3dvcmQ6ICdwYXNzd29yZDEyMydcbiAgICAgIH0pXG4gICAgfSlcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgc2lnbiBpbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRXJyb3IgPSBuZXcgRXJyb3IoJ0ludmFsaWQgY3JlZGVudGlhbHMnKVxuICAgICAgbW9ja0Vycm9yLm5hbWUgPSAnQXV0aEFwaUVycm9yJ1xuICAgICAgXG4gICAgICAobW9ja1N1cGFiYXNlLmF1dGguc2lnbkluV2l0aFBhc3N3b3JkIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHVzZXI6IG51bGwsIHNlc3Npb246IG51bGwgfSxcbiAgICAgICAgZXJyb3I6IG1vY2tFcnJvclxuICAgICAgfSlcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXV0aFNlcnZpY2Uuc2lnbkluKHtcbiAgICAgICAgZW1haWw6ICd3cm9uZ0BleGFtcGxlLmNvbScsXG4gICAgICAgIHBhc3N3b3JkOiAnd3JvbmdwYXNzd29yZCdcbiAgICAgIH0pXG5cbiAgICAgIGV4cGVjdChyZXN1bHQuZGF0YS51c2VyKS50b0JlTnVsbCgpXG4gICAgICBleHBlY3QocmVzdWx0LmRhdGEuc2Vzc2lvbikudG9CZU51bGwoKVxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9FcXVhbChtb2NrRXJyb3IpXG4gICAgfSlcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgbmV0d29yayBlcnJvcnMgZHVyaW5nIHNpZ24gaW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBuZXR3b3JrRXJyb3IgPSBuZXcgRXJyb3IoJ05ldHdvcmsgZXJyb3InKVxuICAgICAgOyhtb2NrU3VwYWJhc2UuYXV0aC5zaWduSW5XaXRoUGFzc3dvcmQgYXMgamVzdC5Nb2NrKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXR3b3JrRXJyb3IpXG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGF1dGhTZXJ2aWNlLnNpZ25Jbih7XG4gICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnXG4gICAgICB9KVxuXG4gICAgICBleHBlY3QocmVzdWx0LmRhdGEudXNlcikudG9CZU51bGwoKVxuICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhLnNlc3Npb24pLnRvQmVOdWxsKClcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvRXF1YWwobmV0d29ya0Vycm9yKVxuICAgIH0pXG4gIH0pXG5cbiAgZGVzY3JpYmUoJ/Cfk50gU2lnbiBVcCBGdW5jdGlvbmFsaXR5JywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgc3VjY2Vzc2Z1bCBzaWduIHVwIHdpdGggZW1haWwgY29uZmlybWF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1VzZXIgPSB7IGlkOiAndXNlcjEyMycsIGVtYWlsOiAnbmV3dXNlckBleGFtcGxlLmNvbScgfVxuICAgICAgXG4gICAgICAobW9ja1N1cGFiYXNlLmF1dGguc2lnblVwIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHVzZXI6IG1vY2tVc2VyLCBzZXNzaW9uOiBudWxsIH0sXG4gICAgICAgIGVycm9yOiBudWxsXG4gICAgICB9KVxuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhdXRoU2VydmljZS5zaWduVXAoe1xuICAgICAgICBlbWFpbDogJ25ld3VzZXJAZXhhbXBsZS5jb20nLFxuICAgICAgICBwYXNzd29yZDogJ3Bhc3N3b3JkMTIzJ1xuICAgICAgfSlcblxuICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhLnVzZXIpLnRvRXF1YWwobW9ja1VzZXIpXG4gICAgICBleHBlY3QocmVzdWx0LmRhdGEuc2Vzc2lvbikudG9CZU51bGwoKVxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9CZU51bGwoKVxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5hdXRoLnNpZ25VcCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBlbWFpbDogJ25ld3VzZXJAZXhhbXBsZS5jb20nLFxuICAgICAgICBwYXNzd29yZDogJ3Bhc3N3b3JkMTIzJyxcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGVtYWlsUmVkaXJlY3RUbzogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCdcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBzaWduIHVwIHdpdGggY3VzdG9tIHJlZGlyZWN0IFVSTCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tVc2VyID0geyBpZDogJ3VzZXIxMjMnLCBlbWFpbDogJ25ld3VzZXJAZXhhbXBsZS5jb20nIH1cbiAgICAgIFxuICAgICAgKG1vY2tTdXBhYmFzZS5hdXRoLnNpZ25VcCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyB1c2VyOiBtb2NrVXNlciwgc2Vzc2lvbjogbnVsbCB9LFxuICAgICAgICBlcnJvcjogbnVsbFxuICAgICAgfSlcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXV0aFNlcnZpY2Uuc2lnblVwKHtcbiAgICAgICAgZW1haWw6ICduZXd1c2VyQGV4YW1wbGUuY29tJyxcbiAgICAgICAgcGFzc3dvcmQ6ICdwYXNzd29yZDEyMycsXG4gICAgICAgIGVtYWlsUmVkaXJlY3RUbzogJ2h0dHBzOi8vbXlhcHAuY29tL2NvbmZpcm0nXG4gICAgICB9KVxuXG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0JlTnVsbCgpXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlLmF1dGguc2lnblVwKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVtYWlsOiAnbmV3dXNlckBleGFtcGxlLmNvbScsXG4gICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgZW1haWxSZWRpcmVjdFRvOiAnaHR0cHM6Ly9teWFwcC5jb20vY29uZmlybSdcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBzaWduIHVwIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tFcnJvciA9IG5ldyBFcnJvcignRW1haWwgYWxyZWFkeSBleGlzdHMnKVxuICAgICAgbW9ja0Vycm9yLm5hbWUgPSAnQXV0aEFwaUVycm9yJ1xuICAgICAgXG4gICAgICAobW9ja1N1cGFiYXNlLmF1dGguc2lnblVwIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHVzZXI6IG51bGwsIHNlc3Npb246IG51bGwgfSxcbiAgICAgICAgZXJyb3I6IG1vY2tFcnJvclxuICAgICAgfSlcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXV0aFNlcnZpY2Uuc2lnblVwKHtcbiAgICAgICAgZW1haWw6ICdleGlzdGluZ0BleGFtcGxlLmNvbScsXG4gICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnXG4gICAgICB9KVxuXG4gICAgICBleHBlY3QocmVzdWx0LmRhdGEudXNlcikudG9CZU51bGwoKVxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9FcXVhbChtb2NrRXJyb3IpXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgn8J+aqiBTaWduIE91dCBGdW5jdGlvbmFsaXR5JywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgc3VjY2Vzc2Z1bCBzaWduIG91dCcsIGFzeW5jICgpID0+IHtcbiAgICAgIChtb2NrU3VwYWJhc2UuYXV0aC5zaWduT3V0IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBlcnJvcjogbnVsbFxuICAgICAgfSlcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXV0aFNlcnZpY2Uuc2lnbk91dCgpXG5cbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmVOdWxsKClcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuYXV0aC5zaWduT3V0KS50b0hhdmVCZWVuQ2FsbGVkKClcbiAgICB9KVxuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBzaWduIG91dCBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRXJyb3IgPSBuZXcgRXJyb3IoJ1NpZ24gb3V0IGZhaWxlZCcpXG4gICAgICA7KG1vY2tTdXBhYmFzZS5hdXRoLnNpZ25PdXQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGVycm9yOiBtb2NrRXJyb3JcbiAgICAgIH0pXG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGF1dGhTZXJ2aWNlLnNpZ25PdXQoKVxuXG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0VxdWFsKG1vY2tFcnJvcilcbiAgICB9KVxuICB9KVxuXG4gIGRlc2NyaWJlKCfwn5SEIFBhc3N3b3JkIE1hbmFnZW1lbnQnLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBwYXNzd29yZCByZXNldCByZXF1ZXN0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgKG1vY2tTdXBhYmFzZS5hdXRoLnJlc2V0UGFzc3dvcmRGb3JFbWFpbCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHsgZXJyb3I6IG51bGwgfSlcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXV0aFNlcnZpY2UucmVzZXRQYXNzd29yZCh7XG4gICAgICAgIGVtYWlsOiAndXNlckBleGFtcGxlLmNvbSdcbiAgICAgIH0pXG5cbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmVOdWxsKClcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuYXV0aC5yZXNldFBhc3N3b3JkRm9yRW1haWwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAndXNlckBleGFtcGxlLmNvbScsXG4gICAgICAgIHsgcmVkaXJlY3RUbzogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hdXRoL3Jlc2V0LXBhc3N3b3JkJyB9XG4gICAgICApXG4gICAgfSlcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgcGFzc3dvcmQgdXBkYXRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKG1vY2tTdXBhYmFzZS5hdXRoLnVwZGF0ZVVzZXIgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGVycm9yOiBudWxsIH0pXG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGF1dGhTZXJ2aWNlLnVwZGF0ZVBhc3N3b3JkKHtcbiAgICAgICAgbmV3UGFzc3dvcmQ6ICduZXdwYXNzd29yZDEyMydcbiAgICAgIH0pXG5cbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmVOdWxsKClcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuYXV0aC51cGRhdGVVc2VyKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHBhc3N3b3JkOiAnbmV3cGFzc3dvcmQxMjMnXG4gICAgICB9KVxuICAgIH0pXG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIHBhc3N3b3JkIHJlc2V0IGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tFcnJvciA9IG5ldyBFcnJvcignRW1haWwgbm90IGZvdW5kJylcbiAgICAgIFxuICAgICAgKG1vY2tTdXBhYmFzZS5hdXRoLnJlc2V0UGFzc3dvcmRGb3JFbWFpbCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHsgZXJyb3I6IG1vY2tFcnJvciB9KVxuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhdXRoU2VydmljZS5yZXNldFBhc3N3b3JkKHtcbiAgICAgICAgZW1haWw6ICd1bmtub3duQGV4YW1wbGUuY29tJ1xuICAgICAgfSlcblxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9FcXVhbChtb2NrRXJyb3IpXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgn8J+RpCBTZXNzaW9uICYgVXNlciBNYW5hZ2VtZW50JywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBnZXQgY3VycmVudCBzZXNzaW9uIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tVc2VyID0geyBpZDogJ3VzZXIxMjMnLCBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nIH1cbiAgICAgIGNvbnN0IG1vY2tTZXNzaW9uID0geyBhY2Nlc3NfdG9rZW46ICd0b2tlbjEyMycsIHVzZXI6IG1vY2tVc2VyIH1cbiAgICAgIFxuICAgICAgKG1vY2tTdXBhYmFzZS5hdXRoLmdldFNlc3Npb24gYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHsgc2Vzc2lvbjogbW9ja1Nlc3Npb24gfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pXG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGF1dGhTZXJ2aWNlLmdldFNlc3Npb24oKVxuXG4gICAgICBleHBlY3QocmVzdWx0LnNlc3Npb24pLnRvRXF1YWwobW9ja1Nlc3Npb24pXG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0JlTnVsbCgpXG4gICAgfSlcblxuICAgIHRlc3QoJ3Nob3VsZCBnZXQgY3VycmVudCB1c2VyIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tVc2VyID0geyBpZDogJ3VzZXIxMjMnLCBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nIH1cbiAgICAgIFxuICAgICAgKG1vY2tTdXBhYmFzZS5hdXRoLmdldFVzZXIgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHsgdXNlcjogbW9ja1VzZXIgfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pXG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGF1dGhTZXJ2aWNlLmdldFVzZXIoKVxuXG4gICAgICBleHBlY3QocmVzdWx0LnVzZXIpLnRvRXF1YWwobW9ja1VzZXIpXG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0JlTnVsbCgpXG4gICAgfSlcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgc2Vzc2lvbiByZXRyaWV2YWwgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0Vycm9yID0gbmV3IEVycm9yKCdTZXNzaW9uIGV4cGlyZWQnKVxuICAgICAgXG4gICAgICAobW9ja1N1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbiBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyBzZXNzaW9uOiBudWxsIH0sXG4gICAgICAgIGVycm9yOiBtb2NrRXJyb3JcbiAgICAgIH0pXG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGF1dGhTZXJ2aWNlLmdldFNlc3Npb24oKVxuXG4gICAgICBleHBlY3QocmVzdWx0LnNlc3Npb24pLnRvQmVOdWxsKClcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvRXF1YWwobW9ja0Vycm9yKVxuICAgIH0pXG4gIH0pXG5cbiAgZGVzY3JpYmUoJ/CflI0gQXV0aGVudGljYXRpb24gVXRpbGl0aWVzJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBjaGVjayBpZiB1c2VyIGlzIGF1dGhlbnRpY2F0ZWQgKHRydWUpJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1Nlc3Npb24gPSB7IGFjY2Vzc190b2tlbjogJ3Rva2VuMTIzJyB9XG4gICAgICBcbiAgICAgIChtb2NrU3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHNlc3Npb246IG1vY2tTZXNzaW9uIH0sXG4gICAgICAgIGVycm9yOiBudWxsXG4gICAgICB9KVxuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKVxuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKHRydWUpXG4gICAgfSlcblxuICAgIHRlc3QoJ3Nob3VsZCBjaGVjayBpZiB1c2VyIGlzIGF1dGhlbnRpY2F0ZWQgKGZhbHNlKScsIGFzeW5jICgpID0+IHtcbiAgICAgIChtb2NrU3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHNlc3Npb246IG51bGwgfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pXG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpXG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoZmFsc2UpXG4gICAgfSlcblxuICAgIHRlc3QoJ3Nob3VsZCBnZXQgY3VycmVudCB1c2VyIElEJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1VzZXIgPSB7IGlkOiAndXNlcjEyMycsIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScgfVxuICAgICAgXG4gICAgICAobW9ja1N1cGFiYXNlLmF1dGguZ2V0VXNlciBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyB1c2VyOiBtb2NrVXNlciB9LFxuICAgICAgICBlcnJvcjogbnVsbFxuICAgICAgfSlcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXV0aFNlcnZpY2UuZ2V0Q3VycmVudFVzZXJJZCgpXG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJ3VzZXIxMjMnKVxuICAgIH0pXG5cbiAgICB0ZXN0KCdzaG91bGQgcmV0dXJuIG51bGwgd2hlbiBubyB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKG1vY2tTdXBhYmFzZS5hdXRoLmdldFVzZXIgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHsgdXNlcjogbnVsbCB9LFxuICAgICAgICBlcnJvcjogbnVsbFxuICAgICAgfSlcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXV0aFNlcnZpY2UuZ2V0Q3VycmVudFVzZXJJZCgpXG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKClcbiAgICB9KVxuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBlcnJvcnMgZ3JhY2VmdWxseSBpbiB1dGlsaXR5IGZ1bmN0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIChtb2NrU3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uIGFzIGplc3QuTW9jaykubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdOZXR3b3JrIGVycm9yJykpXG4gICAgICA7KG1vY2tTdXBhYmFzZS5hdXRoLmdldFVzZXIgYXMgamVzdC5Nb2NrKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ05ldHdvcmsgZXJyb3InKSlcblxuICAgICAgY29uc3QgaXNBdXRoID0gYXdhaXQgYXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKClcbiAgICAgIGNvbnN0IHVzZXJJZCA9IGF3YWl0IGF1dGhTZXJ2aWNlLmdldEN1cnJlbnRVc2VySWQoKVxuXG4gICAgICBleHBlY3QoaXNBdXRoKS50b0JlKGZhbHNlKVxuICAgICAgZXhwZWN0KHVzZXJJZCkudG9CZU51bGwoKVxuICAgIH0pXG4gIH0pXG5cbiAgZGVzY3JpYmUoJ/Cfk6EgQXV0aCBTdGF0ZSBNb25pdG9yaW5nJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBzZXQgdXAgYXV0aCBzdGF0ZSBjaGFuZ2UgbGlzdGVuZXInLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrQ2FsbGJhY2sgPSBqZXN0LmZuKClcbiAgICAgIGNvbnN0IG1vY2tTdWJzY3JpcHRpb24gPSB7IHVuc3Vic2NyaWJlOiBqZXN0LmZuKCkgfVxuICAgICAgXG4gICAgICAobW9ja1N1cGFiYXNlLmF1dGgub25BdXRoU3RhdGVDaGFuZ2UgYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHN1YnNjcmlwdGlvbjogbW9ja1N1YnNjcmlwdGlvbiB9XG4gICAgICB9KVxuXG4gICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSBhdXRoU2VydmljZS5vbkF1dGhTdGF0ZUNoYW5nZShtb2NrQ2FsbGJhY2spXG5cbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuYXV0aC5vbkF1dGhTdGF0ZUNoYW5nZSkudG9IYXZlQmVlbkNhbGxlZCgpXG4gICAgICBleHBlY3Qoc3Vic2NyaXB0aW9uKS50b0VxdWFsKG1vY2tTdWJzY3JpcHRpb24pXG4gICAgfSlcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgYXV0aCBzdGF0ZSBjaGFuZ2UgZXZlbnRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0NhbGxiYWNrID0gamVzdC5mbigpXG4gICAgICBsZXQgYXV0aENoYW5nZUhhbmRsZXI6ICgoZXZlbnQ6IHN0cmluZywgc2Vzc2lvbjogYW55KSA9PiB2b2lkKSB8IHVuZGVmaW5lZFxuXG4gICAgICAobW9ja1N1cGFiYXNlLmF1dGgub25BdXRoU3RhdGVDaGFuZ2UgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKGNhbGxiYWNrKSA9PiB7XG4gICAgICAgIGF1dGhDaGFuZ2VIYW5kbGVyID0gY2FsbGJhY2tcbiAgICAgICAgcmV0dXJuIHsgZGF0YTogeyBzdWJzY3JpcHRpb246IHsgdW5zdWJzY3JpYmU6IGplc3QuZm4oKSB9IH0gfVxuICAgICAgfSlcblxuICAgICAgYXV0aFNlcnZpY2Uub25BdXRoU3RhdGVDaGFuZ2UobW9ja0NhbGxiYWNrKVxuXG4gICAgICAvLyBTaW11bGF0ZSBhdXRoIHN0YXRlIGNoYW5nZVxuICAgICAgY29uc3QgbW9ja1Nlc3Npb24gPSB7IGFjY2Vzc190b2tlbjogJ3Rva2VuMTIzJyB9XG4gICAgICBhdXRoQ2hhbmdlSGFuZGxlciEoJ1NJR05FRF9JTicsIG1vY2tTZXNzaW9uKVxuXG4gICAgICBleHBlY3QobW9ja0NhbGxiYWNrKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnU0lHTkVEX0lOJywgbW9ja1Nlc3Npb24pXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgn8J+nqiBFZGdlIENhc2VzICYgRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBlbWFpbCBpbiBzaWduIGluJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXV0aFNlcnZpY2Uuc2lnbkluKHtcbiAgICAgICAgZW1haWw6ICcnLFxuICAgICAgICBwYXNzd29yZDogJ3Bhc3N3b3JkMTIzJ1xuICAgICAgfSlcblxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5hdXRoLnNpZ25JbldpdGhQYXNzd29yZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBlbWFpbDogJycsXG4gICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnXG4gICAgICB9KVxuICAgIH0pXG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIHNwZWNpYWwgY2hhcmFjdGVycyBpbiBjcmVkZW50aWFscycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNwZWNpYWxFbWFpbCA9ICd0ZXN0K3NwZWNpYWxAZXhhbXBsZS5jb20nXG4gICAgICBjb25zdCBzcGVjaWFsUGFzc3dvcmQgPSAncEBzc3cwcmQhQCMkJV4mKigpJ1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhdXRoU2VydmljZS5zaWduSW4oe1xuICAgICAgICBlbWFpbDogc3BlY2lhbEVtYWlsLFxuICAgICAgICBwYXNzd29yZDogc3BlY2lhbFBhc3N3b3JkXG4gICAgICB9KVxuXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlLmF1dGguc2lnbkluV2l0aFBhc3N3b3JkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVtYWlsOiBzcGVjaWFsRW1haWwsXG4gICAgICAgIHBhc3N3b3JkOiBzcGVjaWFsUGFzc3dvcmRcbiAgICAgIH0pXG4gICAgfSlcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgY29uY3VycmVudCBhdXRoIG9wZXJhdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAobW9ja1N1cGFiYXNlLmF1dGguc2lnbkluV2l0aFBhc3N3b3JkIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHVzZXI6IHsgaWQ6ICd1c2VyMScgfSwgc2Vzc2lvbjogeyBhY2Nlc3NfdG9rZW46ICd0b2tlbjEnIH0gfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pXG4gICAgICA7KG1vY2tTdXBhYmFzZS5hdXRoLnNpZ25VcCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyB1c2VyOiB7IGlkOiAndXNlcjInIH0sIHNlc3Npb246IG51bGwgfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pXG5cbiAgICAgIGNvbnN0IFtzaWduSW5SZXN1bHQsIHNpZ25VcFJlc3VsdF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIGF1dGhTZXJ2aWNlLnNpZ25Jbih7IGVtYWlsOiAnc2lnbmluQGV4YW1wbGUuY29tJywgcGFzc3dvcmQ6ICdwYXNzd29yZCcgfSksXG4gICAgICAgIGF1dGhTZXJ2aWNlLnNpZ25VcCh7IGVtYWlsOiAnc2lnbnVwQGV4YW1wbGUuY29tJywgcGFzc3dvcmQ6ICdwYXNzd29yZCcgfSlcbiAgICAgIF0pXG5cbiAgICAgIGV4cGVjdChzaWduSW5SZXN1bHQuZGF0YS51c2VyPy5pZCkudG9CZSgndXNlcjEnKVxuICAgICAgZXhwZWN0KHNpZ25VcFJlc3VsdC5kYXRhLnVzZXI/LmlkKS50b0JlKCd1c2VyMicpXG4gICAgfSlcbiAgfSlcbn0pXG5cbi8vIFBlcmZvcm1hbmNlIGFuZCBzdHJlc3MgdGVzdFxuZGVzY3JpYmUoJ+KaoSBBdXRoIFNlcnZpY2UgUGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gIHRlc3QoJ3Nob3VsZCBoYW5kbGUgcmFwaWQgc3VjY2Vzc2l2ZSBhdXRoIGNhbGxzJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHByb21pc2VzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogMTAgfSwgKF8sIGkpID0+XG4gICAgICBhdXRoU2VydmljZS5zaWduSW4oe1xuICAgICAgICBlbWFpbDogYHVzZXIke2l9QGV4YW1wbGUuY29tYCxcbiAgICAgICAgcGFzc3dvcmQ6ICdwYXNzd29yZDEyMydcbiAgICAgIH0pXG4gICAgKVxuXG4gICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKVxuICAgIFxuICAgIGV4cGVjdChyZXN1bHRzKS50b0hhdmVMZW5ndGgoMTApXG4gICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5hdXRoLnNpZ25JbldpdGhQYXNzd29yZCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEwKVxuICB9KVxufSlcblxuLyoqXG4gKiBURVNUIENPVkVSQUdFIFNVTU1BUlk6XG4gKiBcbiAqIOKchSBTZXJ2aWNlIEFyY2hpdGVjdHVyZSAoMi8yIHRlc3RzKVxuICog4pyFIFNpZ24gSW4gRnVuY3Rpb25hbGl0eSAoMy8zIHRlc3RzKVxuICog4pyFIFNpZ24gVXAgRnVuY3Rpb25hbGl0eSAoMy8zIHRlc3RzKSAgXG4gKiDinIUgU2lnbiBPdXQgRnVuY3Rpb25hbGl0eSAoMi8yIHRlc3RzKVxuICog4pyFIFBhc3N3b3JkIE1hbmFnZW1lbnQgKDMvMyB0ZXN0cylcbiAqIOKchSBTZXNzaW9uICYgVXNlciBNYW5hZ2VtZW50ICgzLzMgdGVzdHMpXG4gKiDinIUgQXV0aGVudGljYXRpb24gVXRpbGl0aWVzICg1LzUgdGVzdHMpXG4gKiDinIUgQXV0aCBTdGF0ZSBNb25pdG9yaW5nICgyLzIgdGVzdHMpXG4gKiDinIUgRWRnZSBDYXNlcyAmIEVycm9yIEhhbmRsaW5nICgzLzMgdGVzdHMpXG4gKiBcbiAqIFRPVEFMOiAyNi8yNiB0ZXN0cyBjb3ZlcmluZyBhbGwgQXV0aCBTZXJ2aWNlIG9wZXJhdGlvbnNcbiAqIFxuICogVkFMSURBVElPTiBHT0FMUzpcbiAqIC0gUHJvdmVzIG1vZHVsYXIgYXJjaGl0ZWN0dXJlIHdvcmtzIGNvcnJlY3RseVxuICogLSBWYWxpZGF0ZXMgY2xlYW4gc2VwYXJhdGlvbiBmcm9tIEdPRCBPQkpFQ1RcbiAqIC0gRW5zdXJlcyBwcm9wZXIgZXJyb3IgaGFuZGxpbmcgYW5kIGVkZ2UgY2FzZXNcbiAqIC0gQ29uZmlybXMgVHlwZVNjcmlwdCB0eXBpbmcgaXMgd29ya2luZ1xuICogLSBUZXN0cyBhbGwgYXV0aGVudGljYXRpb24gd29ya2Zsb3dzXG4gKi8gIl0sInZlcnNpb24iOjN9