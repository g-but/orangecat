{"version":3,"names":["cov_21dp1c6dwm","actualCoverage","s","exports","GET","server_1","require","server_2","request","f","requestUrl","URL","url","token_hash","searchParams","get","type","next","b","_a","supabase","createServerClient","error","auth","verifyOtp","NextResponse","redirect","origin","encodeURIComponent"],"sources":["/home/g/dev/orangecat/src/app/auth/confirm/route.ts"],"sourcesContent":["import { type EmailOtpType } from '@supabase/supabase-js'\nimport { NextResponse } from 'next/server'\nimport { createServerClient } from '@/services/supabase/server'\n\nexport async function GET(request: Request) {\n  const requestUrl = new URL(request.url)\n  const token_hash = requestUrl.searchParams.get('token_hash')\n  const type = requestUrl.searchParams.get('type') as EmailOtpType | null\n  const next = requestUrl.searchParams.get('next') ?? '/'\n\n  if (token_hash && type) {\n    const supabase = await createServerClient()\n    const { error } = await supabase.auth.verifyOtp({\n      type,\n      token_hash,\n    })\n\n    if (!error) {\n      return NextResponse.redirect(`${requestUrl.origin}${next}`)\n    }\n  }\n\n  return NextResponse.redirect(`${requestUrl.origin}/auth?error=${encodeURIComponent('Verification failed')}`)\n}\n\n\n\n\n\n\n"],"mappings":"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","ignoreList":[]}