d34667cf6c7017075eb13029f035b4ee
/**
 * SUPABASE CORE CLIENT - COMPREHENSIVE TESTS
 *
 * Tests core Supabase client configuration, environment validation,
 * and storage mechanisms for production readiness.
 *
 * Created: 2025-06-08
 * Last Modified: 2025-06-08
 * Last Modified Summary: Comprehensive SupabaseServices tests for Option A completion
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
// Mock Supabase client
jest.mock('@supabase/ssr', () => ({
    createBrowserClient: jest.fn(() => ({
        auth: {
            getSession: jest.fn(),
            getUser: jest.fn(),
            signInWithPassword: jest.fn(),
            signOut: jest.fn(),
        },
        from: jest.fn(),
    }))
}));
// Mock logger
jest.mock('@/utils/logger', () => ({
    logger: {
        error: jest.fn(),
        warn: jest.fn(),
        info: jest.fn(),
    },
    logSupabase: jest.fn(),
}));
// Mock environment variables
const mockEnv = {
    NEXT_PUBLIC_SUPABASE_URL: 'https://test.supabase.co',
    NEXT_PUBLIC_SUPABASE_ANON_KEY: 'test-anon-key-123456789',
    NEXT_PUBLIC_SITE_URL: 'http://localhost:3000',
    NODE_ENV: 'test'
};
// Mock browser environment
Object.defineProperty(window, 'localStorage', {
    value: {
        getItem: jest.fn(),
        setItem: jest.fn(),
        removeItem: jest.fn(),
        clear: jest.fn(),
    },
    writable: true,
});
Object.defineProperty(window, 'sessionStorage', {
    value: {
        getItem: jest.fn(),
        setItem: jest.fn(),
        removeItem: jest.fn(),
        clear: jest.fn(),
    },
    writable: true,
});
// Mock process.env
const originalEnv = process.env;
beforeAll(() => {
    process.env = Object.assign(Object.assign({}, originalEnv), mockEnv);
});
afterAll(() => {
    process.env = originalEnv;
});
describe('🏗️ Supabase Core Client - Comprehensive Coverage', () => {
    beforeEach(() => {
        jest.clearAllMocks();
        window.localStorage.getItem.mockReturnValue(null);
        window.localStorage.setItem.mockImplementation(() => { });
        window.localStorage.removeItem.mockImplementation(() => { });
        window.sessionStorage.getItem.mockReturnValue(null);
        window.sessionStorage.setItem.mockImplementation(() => { });
        window.sessionStorage.removeItem.mockImplementation(() => { });
        // Reset console methods to avoid test noise
        jest.spyOn(console, 'warn').mockImplementation(() => { });
        jest.spyOn(console, 'error').mockImplementation(() => { });
    });
    afterEach(() => {
        jest.restoreAllMocks();
    });
    describe('🌍 Environment Validation', () => {
        test('should validate complete environment configuration', () => {
            // Dynamic import to test environment validation
            const modulePromise = Promise.resolve().then(() => __importStar(require('../core/client')));
            expect(modulePromise).resolves.toBeDefined();
        });
        test('should handle missing environment variables', () => {
            const invalidEnv = Object.assign({}, mockEnv);
            delete invalidEnv.NEXT_PUBLIC_SUPABASE_URL;
            process.env = Object.assign(Object.assign({}, originalEnv), invalidEnv);
            // Clear module cache and re-import
            jest.resetModules();
            expect(() => {
                require('../core/client');
            }).toThrow('Missing Supabase environment variables');
        });
        test('should validate URL format', () => {
            const invalidUrlEnv = Object.assign(Object.assign({}, mockEnv), { NEXT_PUBLIC_SUPABASE_URL: 'invalid-url' });
            process.env = Object.assign(Object.assign({}, originalEnv), invalidUrlEnv);
            jest.resetModules();
            expect(() => {
                require('../core/client');
            }).toThrow('Invalid Supabase URL format');
        });
        test('should warn about non-https URLs', async () => {
            const httpEnv = Object.assign(Object.assign({}, mockEnv), { NEXT_PUBLIC_SUPABASE_URL: 'http://test.supabase.co' });
            process.env = Object.assign(Object.assign({}, originalEnv), httpEnv);
            jest.resetModules();
            require('../core/client');
            const { logger } = require('@/utils/logger');
            expect(logger.error).toHaveBeenCalledWith('Supabase URL should use https protocol:', 'http:', 'Supabase');
        });
        test('should provide default site URL', () => {
            const noSiteUrlEnv = Object.assign({}, mockEnv);
            delete noSiteUrlEnv.NEXT_PUBLIC_SITE_URL;
            process.env = Object.assign(Object.assign({}, originalEnv), noSiteUrlEnv);
            jest.resetModules();
            const clientModule = require('../core/client');
            expect(clientModule.supabaseConfig.siteUrl).toBe('http://localhost:3000');
        });
    });
    describe('🔧 Client Configuration', () => {
        test('should create client with proper auth configuration', async () => {
            const { createBrowserClient } = require('@supabase/ssr');
            require('../core/client');
            expect(createBrowserClient).toHaveBeenCalledWith(mockEnv.NEXT_PUBLIC_SUPABASE_URL, mockEnv.NEXT_PUBLIC_SUPABASE_ANON_KEY, expect.objectContaining({
                auth: expect.objectContaining({
                    persistSession: true,
                    autoRefreshToken: true,
                    detectSessionInUrl: true,
                    debug: true, // test environment
                    storage: expect.any(Object)
                })
            }));
        });
        test('should configure production vs development settings', () => {
            const prodEnv = Object.assign(Object.assign({}, mockEnv), { NODE_ENV: 'production' });
            process.env = Object.assign(Object.assign({}, originalEnv), prodEnv);
            jest.resetModules();
            const { createBrowserClient } = require('@supabase/ssr');
            require('../core/client');
            expect(createBrowserClient).toHaveBeenCalledWith(expect.any(String), expect.any(String), expect.objectContaining({
                auth: expect.objectContaining({
                    debug: false // production
                }),
                cookieOptions: expect.objectContaining({
                    secure: true // production
                })
            }));
        });
        test('should export client and configuration', () => {
            const clientModule = require('../core/client');
            expect(clientModule.supabase).toBeDefined();
            expect(clientModule.supabaseConfig).toBeDefined();
            expect(clientModule.default).toBeDefined();
        });
    });
    describe('💾 Storage Implementation', () => {
        test('should handle localStorage operations', () => {
            const clientModule = require('../core/client');
            const { createBrowserClient } = require('@supabase/ssr');
            // Get storage configuration from createBrowserClient call
            const configCall = createBrowserClient.mock.calls[0];
            const storage = configCall[2].auth.storage;
            window.localStorage.getItem.mockReturnValue('{"test": "value"}');
            const result = storage.getItem('test-key');
            expect(window.localStorage.getItem).toHaveBeenCalledWith('test-key');
            expect(result).toEqual({ test: 'value' });
        });
        test('should fallback to sessionStorage when localStorage fails', () => {
            const clientModule = require('../core/client');
            const { createBrowserClient } = require('@supabase/ssr');
            const configCall = createBrowserClient.mock.calls[0];
            const storage = configCall[2].auth.storage;
            window.localStorage.getItem.mockImplementation(() => {
                throw new Error('localStorage not available');
            });
            window.sessionStorage.getItem.mockReturnValue('{"fallback": "value"}');
            const result = storage.getItem('test-key');
            expect(window.sessionStorage.getItem).toHaveBeenCalledWith('test-key');
            expect(result).toEqual({ fallback: 'value' });
        });
        test('should handle setItem with redundancy', () => {
            const clientModule = require('../core/client');
            const { createBrowserClient } = require('@supabase/ssr');
            const configCall = createBrowserClient.mock.calls[0];
            const storage = configCall[2].auth.storage;
            const testData = { session: 'data' };
            storage.setItem('session-key', testData);
            expect(window.localStorage.setItem).toHaveBeenCalledWith('session-key', JSON.stringify(testData));
            expect(window.sessionStorage.setItem).toHaveBeenCalledWith('session-key', JSON.stringify(testData));
        });
        test('should handle storage errors gracefully', () => {
            const clientModule = require('../core/client');
            const { createBrowserClient } = require('@supabase/ssr');
            const configCall = createBrowserClient.mock.calls[0];
            const storage = configCall[2].auth.storage;
            window.localStorage.setItem.mockImplementation(() => {
                throw new Error('Storage quota exceeded');
            });
            window.sessionStorage.setItem.mockImplementation(() => {
                throw new Error('Storage quota exceeded');
            });
            // Should not throw, but handle gracefully
            expect(() => {
                storage.setItem('test-key', { data: 'value' });
            }).not.toThrow();
        });
        test('should remove items from both storages', () => {
            const clientModule = require('../core/client');
            const { createBrowserClient } = require('@supabase/ssr');
            const configCall = createBrowserClient.mock.calls[0];
            const storage = configCall[2].auth.storage;
            storage.removeItem('test-key');
            expect(window.localStorage.removeItem).toHaveBeenCalledWith('test-key');
            expect(window.sessionStorage.removeItem).toHaveBeenCalledWith('test-key');
        });
        test('should handle malformed JSON in storage', () => {
            const clientModule = require('../core/client');
            const { createBrowserClient } = require('@supabase/ssr');
            const configCall = createBrowserClient.mock.calls[0];
            const storage = configCall[2].auth.storage;
            window.localStorage.getItem.mockReturnValue('invalid-json');
            const result = storage.getItem('test-key');
            expect(result).toBe(null);
        });
    });
    describe('🔒 Security Configuration', () => {
        test('should use secure cookies in production', () => {
            const prodEnv = Object.assign(Object.assign({}, mockEnv), { NODE_ENV: 'production' });
            process.env = Object.assign(Object.assign({}, originalEnv), prodEnv);
            jest.resetModules();
            const { createBrowserClient } = require('@supabase/ssr');
            require('../core/client');
            expect(createBrowserClient).toHaveBeenCalledWith(expect.any(String), expect.any(String), expect.objectContaining({
                cookieOptions: expect.objectContaining({
                    secure: true,
                    sameSite: 'lax',
                    path: '/'
                })
            }));
        });
        test('should use appropriate database schema', () => {
            const { createBrowserClient } = require('@supabase/ssr');
            require('../core/client');
            expect(createBrowserClient).toHaveBeenCalledWith(expect.any(String), expect.any(String), expect.objectContaining({
                db: expect.objectContaining({
                    schema: 'public'
                })
            }));
        });
    });
    describe('🧪 Edge Cases & Error Recovery', () => {
        test('should handle missing window object gracefully', () => {
            // This test simulates server-side rendering
            const originalWindow = global.window;
            delete global.window;
            jest.resetModules();
            expect(() => {
                require('../core/client');
            }).not.toThrow();
            global.window = originalWindow;
        });
        test('should validate environment on every import', () => {
            // Set test environment before reset
            process.env = Object.assign(Object.assign({}, originalEnv), mockEnv);
            jest.resetModules();
            // Access the global stable mock that persists across module resets
            const stableLogSupabase = globalThis.__oc_logSupabase || jest.fn();
            require('../core/client');
            expect(stableLogSupabase).toHaveBeenCalledWith('Environment validation:', expect.objectContaining({
                supabaseUrl: expect.stringContaining('https://test.supabas...'),
                supabaseAnonKey: expect.stringContaining('test-anon-key...'),
                siteUrl: 'http://localhost:3000',
                nodeEnv: 'test'
            }));
        });
        test('should redact sensitive information in logs', () => {
            // Set test environment and clear previous calls
            process.env = Object.assign(Object.assign({}, originalEnv), mockEnv);
            jest.resetModules();
            // Access the global stable mock that persists across module resets
            const stableLogSupabase = globalThis.__oc_logSupabase || jest.fn();
            stableLogSupabase.mockClear(); // Clear previous calls
            require('../core/client');
            const logCall = stableLogSupabase.mock.calls[0][1];
            // Should not log full keys
            expect(logCall.supabaseAnonKey).not.toBe(mockEnv.NEXT_PUBLIC_SUPABASE_ANON_KEY);
            expect(logCall.supabaseAnonKey).toContain('...');
            expect(logCall.supabaseUrl).toContain('...');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvZy9kZXYvb3JhbmdlY2F0L3NyYy9zZXJ2aWNlcy9zdXBhYmFzZS9fX3Rlc3RzX18vY29yZS5jb21wcmVoZW5zaXZlLnRlc3QudHMiLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7OztHQVNHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBeUNILHVCQUF1QjtBQUN2QixJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ2hDLG1CQUFtQixFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUNsQyxJQUFJLEVBQUU7WUFDSixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNyQixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNsQixrQkFBa0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQzdCLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1NBQ25CO1FBQ0QsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDaEIsQ0FBQyxDQUFDO0NBQ0osQ0FBQyxDQUFDLENBQUE7QUFFSCxjQUFjO0FBQ2QsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ2pDLE1BQU0sRUFBRTtRQUNOLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2hCLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDaEI7SUFDRCxXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUN2QixDQUFDLENBQUMsQ0FBQTtBQTVESCw2QkFBNkI7QUFDN0IsTUFBTSxPQUFPLEdBQUc7SUFDZCx3QkFBd0IsRUFBRSwwQkFBMEI7SUFDcEQsNkJBQTZCLEVBQUUseUJBQXlCO0lBQ3hELG9CQUFvQixFQUFFLHVCQUF1QjtJQUM3QyxRQUFRLEVBQUUsTUFBTTtD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WyIvaG9tZS9nL2Rldi9vcmFuZ2VjYXQvc3JjL3NlcnZpY2VzL3N1cGFiYXNlL19fdGVzdHNfXy9jb3JlLmNvbXByZWhlbnNpdmUudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNVUEFCQVNFIENPUkUgQ0xJRU5UIC0gQ09NUFJFSEVOU0lWRSBURVNUU1xuICogXG4gKiBUZXN0cyBjb3JlIFN1cGFiYXNlIGNsaWVudCBjb25maWd1cmF0aW9uLCBlbnZpcm9ubWVudCB2YWxpZGF0aW9uLFxuICogYW5kIHN0b3JhZ2UgbWVjaGFuaXNtcyBmb3IgcHJvZHVjdGlvbiByZWFkaW5lc3MuXG4gKiBcbiAqIENyZWF0ZWQ6IDIwMjUtMDYtMDhcbiAqIExhc3QgTW9kaWZpZWQ6IDIwMjUtMDYtMDhcbiAqIExhc3QgTW9kaWZpZWQgU3VtbWFyeTogQ29tcHJlaGVuc2l2ZSBTdXBhYmFzZVNlcnZpY2VzIHRlc3RzIGZvciBPcHRpb24gQSBjb21wbGV0aW9uXG4gKi9cblxuLy8gTW9jayBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbmNvbnN0IG1vY2tFbnYgPSB7XG4gIE5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDogJ2h0dHBzOi8vdGVzdC5zdXBhYmFzZS5jbycsXG4gIE5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZOiAndGVzdC1hbm9uLWtleS0xMjM0NTY3ODknLFxuICBORVhUX1BVQkxJQ19TSVRFX1VSTDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCcsXG4gIE5PREVfRU5WOiAndGVzdCdcbn1cblxuLy8gTW9jayBicm93c2VyIGVudmlyb25tZW50XG5PYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCAnbG9jYWxTdG9yYWdlJywge1xuICB2YWx1ZToge1xuICAgIGdldEl0ZW06IGplc3QuZm4oKSxcbiAgICBzZXRJdGVtOiBqZXN0LmZuKCksXG4gICAgcmVtb3ZlSXRlbTogamVzdC5mbigpLFxuICAgIGNsZWFyOiBqZXN0LmZuKCksXG4gIH0sXG4gIHdyaXRhYmxlOiB0cnVlLFxufSlcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ3Nlc3Npb25TdG9yYWdlJywge1xuICB2YWx1ZToge1xuICAgIGdldEl0ZW06IGplc3QuZm4oKSxcbiAgICBzZXRJdGVtOiBqZXN0LmZuKCksXG4gICAgcmVtb3ZlSXRlbTogamVzdC5mbigpLFxuICAgIGNsZWFyOiBqZXN0LmZuKCksXG4gIH0sXG4gIHdyaXRhYmxlOiB0cnVlLFxufSlcblxuLy8gTW9jayBwcm9jZXNzLmVudlxuY29uc3Qgb3JpZ2luYWxFbnYgPSBwcm9jZXNzLmVudlxuYmVmb3JlQWxsKCgpID0+IHtcbiAgcHJvY2Vzcy5lbnYgPSB7IC4uLm9yaWdpbmFsRW52LCAuLi5tb2NrRW52IH1cbn0pXG5cbmFmdGVyQWxsKCgpID0+IHtcbiAgcHJvY2Vzcy5lbnYgPSBvcmlnaW5hbEVudlxufSlcblxuLy8gTW9jayBTdXBhYmFzZSBjbGllbnRcbmplc3QubW9jaygnQHN1cGFiYXNlL3NzcicsICgpID0+ICh7XG4gIGNyZWF0ZUJyb3dzZXJDbGllbnQ6IGplc3QuZm4oKCkgPT4gKHtcbiAgICBhdXRoOiB7XG4gICAgICBnZXRTZXNzaW9uOiBqZXN0LmZuKCksXG4gICAgICBnZXRVc2VyOiBqZXN0LmZuKCksXG4gICAgICBzaWduSW5XaXRoUGFzc3dvcmQ6IGplc3QuZm4oKSxcbiAgICAgIHNpZ25PdXQ6IGplc3QuZm4oKSxcbiAgICB9LFxuICAgIGZyb206IGplc3QuZm4oKSxcbiAgfSkpXG59KSlcblxuLy8gTW9jayBsb2dnZXJcbmplc3QubW9jaygnQC91dGlscy9sb2dnZXInLCAoKSA9PiAoe1xuICBsb2dnZXI6IHtcbiAgICBlcnJvcjogamVzdC5mbigpLFxuICAgIHdhcm46IGplc3QuZm4oKSxcbiAgICBpbmZvOiBqZXN0LmZuKCksXG4gIH0sXG4gIGxvZ1N1cGFiYXNlOiBqZXN0LmZuKCksXG59KSlcblxuZGVzY3JpYmUoJ/Cfj5fvuI8gU3VwYWJhc2UgQ29yZSBDbGllbnQgLSBDb21wcmVoZW5zaXZlIENvdmVyYWdlJywgKCkgPT4ge1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpXG4gICAgXG4gICAgLy8gUmVzZXQgbG9jYWxTdG9yYWdlIGFuZCBzZXNzaW9uU3RvcmFnZSBtb2Nrc1xuICAgIDsod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKG51bGwpXG4gICAgOyh3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0gYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pXG4gICAgOyh3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0gYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pXG4gICAgXG4gICAgOyh3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZShudWxsKVxuICAgIDsod2luZG93LnNlc3Npb25TdG9yYWdlLnNldEl0ZW0gYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pXG4gICAgOyh3aW5kb3cuc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSlcbiAgICBcbiAgICAvLyBSZXNldCBjb25zb2xlIG1ldGhvZHMgdG8gYXZvaWQgdGVzdCBub2lzZVxuICAgIGplc3Quc3B5T24oY29uc29sZSwgJ3dhcm4nKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pXG4gICAgamVzdC5zcHlPbihjb25zb2xlLCAnZXJyb3InKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pXG4gIH0pXG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBqZXN0LnJlc3RvcmVBbGxNb2NrcygpXG4gIH0pXG5cbiAgZGVzY3JpYmUoJ/CfjI0gRW52aXJvbm1lbnQgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBcbiAgICB0ZXN0KCdzaG91bGQgdmFsaWRhdGUgY29tcGxldGUgZW52aXJvbm1lbnQgY29uZmlndXJhdGlvbicsICgpID0+IHtcbiAgICAgIC8vIER5bmFtaWMgaW1wb3J0IHRvIHRlc3QgZW52aXJvbm1lbnQgdmFsaWRhdGlvblxuICAgICAgY29uc3QgbW9kdWxlUHJvbWlzZSA9IGltcG9ydCgnLi4vY29yZS9jbGllbnQnKVxuICAgICAgXG4gICAgICBleHBlY3QobW9kdWxlUHJvbWlzZSkucmVzb2x2ZXMudG9CZURlZmluZWQoKVxuICAgIH0pXG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgZW52aXJvbm1lbnQgdmFyaWFibGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZEVudiA9IHsgLi4ubW9ja0VudiB9XG4gICAgICBkZWxldGUgaW52YWxpZEVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkxcbiAgICAgIFxuICAgICAgcHJvY2Vzcy5lbnYgPSB7IC4uLm9yaWdpbmFsRW52LCAuLi5pbnZhbGlkRW52IH1cbiAgICAgIFxuICAgICAgLy8gQ2xlYXIgbW9kdWxlIGNhY2hlIGFuZCByZS1pbXBvcnRcbiAgICAgIGplc3QucmVzZXRNb2R1bGVzKClcbiAgICAgIFxuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgcmVxdWlyZSgnLi4vY29yZS9jbGllbnQnKVxuICAgICAgfSkudG9UaHJvdygnTWlzc2luZyBTdXBhYmFzZSBlbnZpcm9ubWVudCB2YXJpYWJsZXMnKVxuICAgIH0pXG5cbiAgICB0ZXN0KCdzaG91bGQgdmFsaWRhdGUgVVJMIGZvcm1hdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRVcmxFbnYgPSB7XG4gICAgICAgIC4uLm1vY2tFbnYsXG4gICAgICAgIE5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDogJ2ludmFsaWQtdXJsJ1xuICAgICAgfVxuICAgICAgXG4gICAgICBwcm9jZXNzLmVudiA9IHsgLi4ub3JpZ2luYWxFbnYsIC4uLmludmFsaWRVcmxFbnYgfVxuICAgICAgamVzdC5yZXNldE1vZHVsZXMoKVxuICAgICAgXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICByZXF1aXJlKCcuLi9jb3JlL2NsaWVudCcpXG4gICAgICB9KS50b1Rocm93KCdJbnZhbGlkIFN1cGFiYXNlIFVSTCBmb3JtYXQnKVxuICAgIH0pXG5cbiAgICB0ZXN0KCdzaG91bGQgd2FybiBhYm91dCBub24taHR0cHMgVVJMcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGh0dHBFbnYgPSB7XG4gICAgICAgIC4uLm1vY2tFbnYsXG4gICAgICAgIE5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDogJ2h0dHA6Ly90ZXN0LnN1cGFiYXNlLmNvJ1xuICAgICAgfVxuICAgICAgXG4gICAgICBwcm9jZXNzLmVudiA9IHsgLi4ub3JpZ2luYWxFbnYsIC4uLmh0dHBFbnYgfVxuICAgICAgamVzdC5yZXNldE1vZHVsZXMoKVxuICAgICAgXG4gICAgICByZXF1aXJlKCcuLi9jb3JlL2NsaWVudCcpXG4gICAgICBcbiAgICAgIGNvbnN0IHsgbG9nZ2VyIH0gPSByZXF1aXJlKCdAL3V0aWxzL2xvZ2dlcicpXG4gICAgICBleHBlY3QobG9nZ2VyLmVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ1N1cGFiYXNlIFVSTCBzaG91bGQgdXNlIGh0dHBzIHByb3RvY29sOicsXG4gICAgICAgICdodHRwOicsXG4gICAgICAgICdTdXBhYmFzZSdcbiAgICAgIClcbiAgICB9KVxuXG4gICAgdGVzdCgnc2hvdWxkIHByb3ZpZGUgZGVmYXVsdCBzaXRlIFVSTCcsICgpID0+IHtcbiAgICAgIGNvbnN0IG5vU2l0ZVVybEVudiA9IHsgLi4ubW9ja0VudiB9XG4gICAgICBkZWxldGUgbm9TaXRlVXJsRW52Lk5FWFRfUFVCTElDX1NJVEVfVVJMXG4gICAgICBcbiAgICAgIHByb2Nlc3MuZW52ID0geyAuLi5vcmlnaW5hbEVudiwgLi4ubm9TaXRlVXJsRW52IH1cbiAgICAgIGplc3QucmVzZXRNb2R1bGVzKClcbiAgICAgIFxuICAgICAgY29uc3QgY2xpZW50TW9kdWxlID0gcmVxdWlyZSgnLi4vY29yZS9jbGllbnQnKVxuICAgICAgZXhwZWN0KGNsaWVudE1vZHVsZS5zdXBhYmFzZUNvbmZpZy5zaXRlVXJsKS50b0JlKCdodHRwOi8vbG9jYWxob3N0OjMwMDAnKVxuICAgIH0pXG5cbiAgfSlcblxuICBkZXNjcmliZSgn8J+UpyBDbGllbnQgQ29uZmlndXJhdGlvbicsICgpID0+IHtcbiAgICBcbiAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIGNsaWVudCB3aXRoIHByb3BlciBhdXRoIGNvbmZpZ3VyYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB7IGNyZWF0ZUJyb3dzZXJDbGllbnQgfSA9IHJlcXVpcmUoJ0BzdXBhYmFzZS9zc3InKVxuICAgICAgXG4gICAgICByZXF1aXJlKCcuLi9jb3JlL2NsaWVudCcpXG4gICAgICBcbiAgICAgIGV4cGVjdChjcmVhdGVCcm93c2VyQ2xpZW50KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgbW9ja0Vudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwsXG4gICAgICAgIG1vY2tFbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVksXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICBhdXRoOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICBwZXJzaXN0U2Vzc2lvbjogdHJ1ZSxcbiAgICAgICAgICAgIGF1dG9SZWZyZXNoVG9rZW46IHRydWUsXG4gICAgICAgICAgICBkZXRlY3RTZXNzaW9uSW5Vcmw6IHRydWUsXG4gICAgICAgICAgICBkZWJ1ZzogdHJ1ZSwgLy8gdGVzdCBlbnZpcm9ubWVudFxuICAgICAgICAgICAgc3RvcmFnZTogZXhwZWN0LmFueShPYmplY3QpXG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIClcbiAgICB9KVxuXG4gICAgdGVzdCgnc2hvdWxkIGNvbmZpZ3VyZSBwcm9kdWN0aW9uIHZzIGRldmVsb3BtZW50IHNldHRpbmdzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvZEVudiA9IHtcbiAgICAgICAgLi4ubW9ja0VudixcbiAgICAgICAgTk9ERV9FTlY6ICdwcm9kdWN0aW9uJ1xuICAgICAgfVxuICAgICAgXG4gICAgICBwcm9jZXNzLmVudiA9IHsgLi4ub3JpZ2luYWxFbnYsIC4uLnByb2RFbnYgfVxuICAgICAgamVzdC5yZXNldE1vZHVsZXMoKVxuICAgICAgXG4gICAgICBjb25zdCB7IGNyZWF0ZUJyb3dzZXJDbGllbnQgfSA9IHJlcXVpcmUoJ0BzdXBhYmFzZS9zc3InKVxuICAgICAgXG4gICAgICByZXF1aXJlKCcuLi9jb3JlL2NsaWVudCcpXG4gICAgICBcbiAgICAgIGV4cGVjdChjcmVhdGVCcm93c2VyQ2xpZW50KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LmFueShTdHJpbmcpLFxuICAgICAgICBleHBlY3QuYW55KFN0cmluZyksXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICBhdXRoOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICBkZWJ1ZzogZmFsc2UgLy8gcHJvZHVjdGlvblxuICAgICAgICAgIH0pLFxuICAgICAgICAgIGNvb2tpZU9wdGlvbnM6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgIHNlY3VyZTogdHJ1ZSAvLyBwcm9kdWN0aW9uXG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIClcbiAgICB9KVxuXG4gICAgdGVzdCgnc2hvdWxkIGV4cG9ydCBjbGllbnQgYW5kIGNvbmZpZ3VyYXRpb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBjbGllbnRNb2R1bGUgPSByZXF1aXJlKCcuLi9jb3JlL2NsaWVudCcpXG4gICAgICBcbiAgICAgIGV4cGVjdChjbGllbnRNb2R1bGUuc3VwYWJhc2UpLnRvQmVEZWZpbmVkKClcbiAgICAgIGV4cGVjdChjbGllbnRNb2R1bGUuc3VwYWJhc2VDb25maWcpLnRvQmVEZWZpbmVkKClcbiAgICAgIGV4cGVjdChjbGllbnRNb2R1bGUuZGVmYXVsdCkudG9CZURlZmluZWQoKVxuICAgIH0pXG5cbiAgfSlcblxuICBkZXNjcmliZSgn8J+SviBTdG9yYWdlIEltcGxlbWVudGF0aW9uJywgKCkgPT4ge1xuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBsb2NhbFN0b3JhZ2Ugb3BlcmF0aW9ucycsICgpID0+IHtcbiAgICAgIGNvbnN0IGNsaWVudE1vZHVsZSA9IHJlcXVpcmUoJy4uL2NvcmUvY2xpZW50JylcbiAgICAgIGNvbnN0IHsgY3JlYXRlQnJvd3NlckNsaWVudCB9ID0gcmVxdWlyZSgnQHN1cGFiYXNlL3NzcicpXG4gICAgICBcbiAgICAgIC8vIEdldCBzdG9yYWdlIGNvbmZpZ3VyYXRpb24gZnJvbSBjcmVhdGVCcm93c2VyQ2xpZW50IGNhbGxcbiAgICAgIGNvbnN0IGNvbmZpZ0NhbGwgPSAoY3JlYXRlQnJvd3NlckNsaWVudCBhcyBqZXN0Lk1vY2spLm1vY2suY2FsbHNbMF1cbiAgICAgIGNvbnN0IHN0b3JhZ2UgPSBjb25maWdDYWxsWzJdLmF1dGguc3RvcmFnZVxuICAgICAgXG4gICAgICAvLyBUZXN0IGdldEl0ZW1cbiAgICAgIDsod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKCd7XCJ0ZXN0XCI6IFwidmFsdWVcIn0nKVxuICAgICAgY29uc3QgcmVzdWx0ID0gc3RvcmFnZS5nZXRJdGVtKCd0ZXN0LWtleScpXG4gICAgICBcbiAgICAgIGV4cGVjdCh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCd0ZXN0LWtleScpXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHsgdGVzdDogJ3ZhbHVlJyB9KVxuICAgIH0pXG5cbiAgICB0ZXN0KCdzaG91bGQgZmFsbGJhY2sgdG8gc2Vzc2lvblN0b3JhZ2Ugd2hlbiBsb2NhbFN0b3JhZ2UgZmFpbHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjbGllbnRNb2R1bGUgPSByZXF1aXJlKCcuLi9jb3JlL2NsaWVudCcpXG4gICAgICBjb25zdCB7IGNyZWF0ZUJyb3dzZXJDbGllbnQgfSA9IHJlcXVpcmUoJ0BzdXBhYmFzZS9zc3InKVxuICAgICAgXG4gICAgICBjb25zdCBjb25maWdDYWxsID0gKGNyZWF0ZUJyb3dzZXJDbGllbnQgYXMgamVzdC5Nb2NrKS5tb2NrLmNhbGxzWzBdXG4gICAgICBjb25zdCBzdG9yYWdlID0gY29uZmlnQ2FsbFsyXS5hdXRoLnN0b3JhZ2VcbiAgICAgIFxuICAgICAgLy8gTW9jayBsb2NhbFN0b3JhZ2UgdG8gdGhyb3cgZXJyb3JcbiAgICAgIDsod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdsb2NhbFN0b3JhZ2Ugbm90IGF2YWlsYWJsZScpXG4gICAgICB9KVxuICAgICAgOyh3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZSgne1wiZmFsbGJhY2tcIjogXCJ2YWx1ZVwifScpXG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHN0b3JhZ2UuZ2V0SXRlbSgndGVzdC1rZXknKVxuICAgICAgXG4gICAgICBleHBlY3Qod2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCd0ZXN0LWtleScpXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHsgZmFsbGJhY2s6ICd2YWx1ZScgfSlcbiAgICB9KVxuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBzZXRJdGVtIHdpdGggcmVkdW5kYW5jeScsICgpID0+IHtcbiAgICAgIGNvbnN0IGNsaWVudE1vZHVsZSA9IHJlcXVpcmUoJy4uL2NvcmUvY2xpZW50JylcbiAgICAgIGNvbnN0IHsgY3JlYXRlQnJvd3NlckNsaWVudCB9ID0gcmVxdWlyZSgnQHN1cGFiYXNlL3NzcicpXG4gICAgICBcbiAgICAgIGNvbnN0IGNvbmZpZ0NhbGwgPSAoY3JlYXRlQnJvd3NlckNsaWVudCBhcyBqZXN0Lk1vY2spLm1vY2suY2FsbHNbMF1cbiAgICAgIGNvbnN0IHN0b3JhZ2UgPSBjb25maWdDYWxsWzJdLmF1dGguc3RvcmFnZVxuICAgICAgXG4gICAgICBjb25zdCB0ZXN0RGF0YSA9IHsgc2Vzc2lvbjogJ2RhdGEnIH1cbiAgICAgIHN0b3JhZ2Uuc2V0SXRlbSgnc2Vzc2lvbi1rZXknLCB0ZXN0RGF0YSlcbiAgICAgIFxuICAgICAgZXhwZWN0KHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICdzZXNzaW9uLWtleScsXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHRlc3REYXRhKVxuICAgICAgKVxuICAgICAgZXhwZWN0KHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ3Nlc3Npb24ta2V5JyxcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkodGVzdERhdGEpXG4gICAgICApXG4gICAgfSlcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgc3RvcmFnZSBlcnJvcnMgZ3JhY2VmdWxseScsICgpID0+IHtcbiAgICAgIGNvbnN0IGNsaWVudE1vZHVsZSA9IHJlcXVpcmUoJy4uL2NvcmUvY2xpZW50JylcbiAgICAgIGNvbnN0IHsgY3JlYXRlQnJvd3NlckNsaWVudCB9ID0gcmVxdWlyZSgnQHN1cGFiYXNlL3NzcicpXG4gICAgICBcbiAgICAgIGNvbnN0IGNvbmZpZ0NhbGwgPSAoY3JlYXRlQnJvd3NlckNsaWVudCBhcyBqZXN0Lk1vY2spLm1vY2suY2FsbHNbMF1cbiAgICAgIGNvbnN0IHN0b3JhZ2UgPSBjb25maWdDYWxsWzJdLmF1dGguc3RvcmFnZVxuICAgICAgXG4gICAgICAvLyBNb2NrIGJvdGggc3RvcmFnZXMgdG8gZmFpbFxuICAgICAgOyh3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0gYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N0b3JhZ2UgcXVvdGEgZXhjZWVkZWQnKVxuICAgICAgfSlcbiAgICAgIDsod2luZG93LnNlc3Npb25TdG9yYWdlLnNldEl0ZW0gYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N0b3JhZ2UgcXVvdGEgZXhjZWVkZWQnKVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIG5vdCB0aHJvdywgYnV0IGhhbmRsZSBncmFjZWZ1bGx5XG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBzdG9yYWdlLnNldEl0ZW0oJ3Rlc3Qta2V5JywgeyBkYXRhOiAndmFsdWUnIH0pXG4gICAgICB9KS5ub3QudG9UaHJvdygpXG4gICAgfSlcblxuICAgIHRlc3QoJ3Nob3VsZCByZW1vdmUgaXRlbXMgZnJvbSBib3RoIHN0b3JhZ2VzJywgKCkgPT4ge1xuICAgICAgY29uc3QgY2xpZW50TW9kdWxlID0gcmVxdWlyZSgnLi4vY29yZS9jbGllbnQnKVxuICAgICAgY29uc3QgeyBjcmVhdGVCcm93c2VyQ2xpZW50IH0gPSByZXF1aXJlKCdAc3VwYWJhc2Uvc3NyJylcbiAgICAgIFxuICAgICAgY29uc3QgY29uZmlnQ2FsbCA9IChjcmVhdGVCcm93c2VyQ2xpZW50IGFzIGplc3QuTW9jaykubW9jay5jYWxsc1swXVxuICAgICAgY29uc3Qgc3RvcmFnZSA9IGNvbmZpZ0NhbGxbMl0uYXV0aC5zdG9yYWdlXG4gICAgICBcbiAgICAgIHN0b3JhZ2UucmVtb3ZlSXRlbSgndGVzdC1rZXknKVxuICAgICAgXG4gICAgICBleHBlY3Qod2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndGVzdC1rZXknKVxuICAgICAgZXhwZWN0KHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndGVzdC1rZXknKVxuICAgIH0pXG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIG1hbGZvcm1lZCBKU09OIGluIHN0b3JhZ2UnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjbGllbnRNb2R1bGUgPSByZXF1aXJlKCcuLi9jb3JlL2NsaWVudCcpXG4gICAgICBjb25zdCB7IGNyZWF0ZUJyb3dzZXJDbGllbnQgfSA9IHJlcXVpcmUoJ0BzdXBhYmFzZS9zc3InKVxuICAgICAgXG4gICAgICBjb25zdCBjb25maWdDYWxsID0gKGNyZWF0ZUJyb3dzZXJDbGllbnQgYXMgamVzdC5Nb2NrKS5tb2NrLmNhbGxzWzBdXG4gICAgICBjb25zdCBzdG9yYWdlID0gY29uZmlnQ2FsbFsyXS5hdXRoLnN0b3JhZ2VcbiAgICAgIFxuICAgICAgOyh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0gYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUoJ2ludmFsaWQtanNvbicpXG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHN0b3JhZ2UuZ2V0SXRlbSgndGVzdC1rZXknKVxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShudWxsKVxuICAgIH0pXG5cbiAgfSlcblxuICBkZXNjcmliZSgn8J+UkiBTZWN1cml0eSBDb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgIFxuICAgIHRlc3QoJ3Nob3VsZCB1c2Ugc2VjdXJlIGNvb2tpZXMgaW4gcHJvZHVjdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IHByb2RFbnYgPSB7XG4gICAgICAgIC4uLm1vY2tFbnYsXG4gICAgICAgIE5PREVfRU5WOiAncHJvZHVjdGlvbidcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcHJvY2Vzcy5lbnYgPSB7IC4uLm9yaWdpbmFsRW52LCAuLi5wcm9kRW52IH1cbiAgICAgIGplc3QucmVzZXRNb2R1bGVzKClcbiAgICAgIFxuICAgICAgY29uc3QgeyBjcmVhdGVCcm93c2VyQ2xpZW50IH0gPSByZXF1aXJlKCdAc3VwYWJhc2Uvc3NyJylcbiAgICAgIFxuICAgICAgcmVxdWlyZSgnLi4vY29yZS9jbGllbnQnKVxuICAgICAgXG4gICAgICBleHBlY3QoY3JlYXRlQnJvd3NlckNsaWVudCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5hbnkoU3RyaW5nKSxcbiAgICAgICAgZXhwZWN0LmFueShTdHJpbmcpLFxuICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgY29va2llT3B0aW9uczogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgc2VjdXJlOiB0cnVlLFxuICAgICAgICAgICAgc2FtZVNpdGU6ICdsYXgnLFxuICAgICAgICAgICAgcGF0aDogJy8nXG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIClcbiAgICB9KVxuXG4gICAgdGVzdCgnc2hvdWxkIHVzZSBhcHByb3ByaWF0ZSBkYXRhYmFzZSBzY2hlbWEnLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IGNyZWF0ZUJyb3dzZXJDbGllbnQgfSA9IHJlcXVpcmUoJ0BzdXBhYmFzZS9zc3InKVxuICAgICAgXG4gICAgICByZXF1aXJlKCcuLi9jb3JlL2NsaWVudCcpXG4gICAgICBcbiAgICAgIGV4cGVjdChjcmVhdGVCcm93c2VyQ2xpZW50KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LmFueShTdHJpbmcpLFxuICAgICAgICBleHBlY3QuYW55KFN0cmluZyksXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICBkYjogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgc2NoZW1hOiAncHVibGljJ1xuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICApXG4gICAgfSlcblxuICB9KVxuXG4gIGRlc2NyaWJlKCfwn6eqIEVkZ2UgQ2FzZXMgJiBFcnJvciBSZWNvdmVyeScsICgpID0+IHtcbiAgICBcbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIG1pc3Npbmcgd2luZG93IG9iamVjdCBncmFjZWZ1bGx5JywgKCkgPT4ge1xuICAgICAgLy8gVGhpcyB0ZXN0IHNpbXVsYXRlcyBzZXJ2ZXItc2lkZSByZW5kZXJpbmdcbiAgICAgIGNvbnN0IG9yaWdpbmFsV2luZG93ID0gZ2xvYmFsLndpbmRvd1xuICAgICAgZGVsZXRlIChnbG9iYWwgYXMgYW55KS53aW5kb3dcbiAgICAgIFxuICAgICAgamVzdC5yZXNldE1vZHVsZXMoKVxuICAgICAgXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICByZXF1aXJlKCcuLi9jb3JlL2NsaWVudCcpXG4gICAgICB9KS5ub3QudG9UaHJvdygpXG4gICAgICBcbiAgICAgIGdsb2JhbC53aW5kb3cgPSBvcmlnaW5hbFdpbmRvd1xuICAgIH0pXG5cbiAgICB0ZXN0KCdzaG91bGQgdmFsaWRhdGUgZW52aXJvbm1lbnQgb24gZXZlcnkgaW1wb3J0JywgKCkgPT4ge1xuICAgICAgLy8gU2V0IHRlc3QgZW52aXJvbm1lbnQgYmVmb3JlIHJlc2V0XG4gICAgICBwcm9jZXNzLmVudiA9IHsgLi4ub3JpZ2luYWxFbnYsIC4uLm1vY2tFbnYgfVxuICAgICAgamVzdC5yZXNldE1vZHVsZXMoKVxuICAgICAgLy8gQWNjZXNzIHRoZSBnbG9iYWwgc3RhYmxlIG1vY2sgdGhhdCBwZXJzaXN0cyBhY3Jvc3MgbW9kdWxlIHJlc2V0c1xuICAgICAgY29uc3Qgc3RhYmxlTG9nU3VwYWJhc2UgPSAoZ2xvYmFsVGhpcyBhcyBhbnkpLl9fb2NfbG9nU3VwYWJhc2UgfHwgamVzdC5mbigpXG4gICAgICByZXF1aXJlKCcuLi9jb3JlL2NsaWVudCcpXG4gICAgICBcbiAgICAgIGV4cGVjdChzdGFibGVMb2dTdXBhYmFzZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICdFbnZpcm9ubWVudCB2YWxpZGF0aW9uOicsXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICBzdXBhYmFzZVVybDogZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ2h0dHBzOi8vdGVzdC5zdXBhYmFzLi4uJyksXG4gICAgICAgICAgc3VwYWJhc2VBbm9uS2V5OiBleHBlY3Quc3RyaW5nQ29udGFpbmluZygndGVzdC1hbm9uLWtleS4uLicpLFxuICAgICAgICAgIHNpdGVVcmw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnLFxuICAgICAgICAgIG5vZGVFbnY6ICd0ZXN0J1xuICAgICAgICB9KVxuICAgICAgKVxuICAgIH0pXG5cbiAgICB0ZXN0KCdzaG91bGQgcmVkYWN0IHNlbnNpdGl2ZSBpbmZvcm1hdGlvbiBpbiBsb2dzJywgKCkgPT4ge1xuICAgICAgLy8gU2V0IHRlc3QgZW52aXJvbm1lbnQgYW5kIGNsZWFyIHByZXZpb3VzIGNhbGxzXG4gICAgICBwcm9jZXNzLmVudiA9IHsgLi4ub3JpZ2luYWxFbnYsIC4uLm1vY2tFbnYgfVxuICAgICAgamVzdC5yZXNldE1vZHVsZXMoKVxuICAgICAgLy8gQWNjZXNzIHRoZSBnbG9iYWwgc3RhYmxlIG1vY2sgdGhhdCBwZXJzaXN0cyBhY3Jvc3MgbW9kdWxlIHJlc2V0c1xuICAgICAgY29uc3Qgc3RhYmxlTG9nU3VwYWJhc2UgPSAoZ2xvYmFsVGhpcyBhcyBhbnkpLl9fb2NfbG9nU3VwYWJhc2UgfHwgamVzdC5mbigpXG4gICAgICBzdGFibGVMb2dTdXBhYmFzZS5tb2NrQ2xlYXIoKSAvLyBDbGVhciBwcmV2aW91cyBjYWxsc1xuICAgICAgcmVxdWlyZSgnLi4vY29yZS9jbGllbnQnKVxuICAgICAgXG4gICAgICBjb25zdCBsb2dDYWxsID0gKHN0YWJsZUxvZ1N1cGFiYXNlIGFzIGplc3QuTW9jaykubW9jay5jYWxsc1swXVsxXVxuICAgICAgXG4gICAgICAvLyBTaG91bGQgbm90IGxvZyBmdWxsIGtleXNcbiAgICAgIGV4cGVjdChsb2dDYWxsLnN1cGFiYXNlQW5vbktleSkubm90LnRvQmUobW9ja0Vudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSlcbiAgICAgIGV4cGVjdChsb2dDYWxsLnN1cGFiYXNlQW5vbktleSkudG9Db250YWluKCcuLi4nKVxuICAgICAgZXhwZWN0KGxvZ0NhbGwuc3VwYWJhc2VVcmwpLnRvQ29udGFpbignLi4uJylcbiAgICB9KVxuXG4gIH0pXG5cbn0pICJdLCJ2ZXJzaW9uIjozfQ==