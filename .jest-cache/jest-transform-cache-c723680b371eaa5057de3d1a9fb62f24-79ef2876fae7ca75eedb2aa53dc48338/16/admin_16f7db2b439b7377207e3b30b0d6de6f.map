{"version":3,"names":["cov_2px2w8czg4","actualCoverage","s","supabase_js_1","require","SUPABASE_URL","process","env","NEXT_PUBLIC_SUPABASE_URL","SUPABASE_SERVICE_ROLE_KEY","createDummyClient","f","Proxy","get","Error","supabaseAdmin","b","createClient","auth","autoRefreshToken","persistSession","exports","default"],"sources":["/home/g/dev/orangecat/src/services/supabase/admin.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\n\nconst SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL\nconst SUPABASE_SERVICE_ROLE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY\n\n// During static builds (e.g., Vercel build step) the service-role key may be\n// intentionally absent for security.  To prevent the build from crashing we\n// fall back to a dummy client that will throw **at runtime** if it is actually\n// used without the required credentials.  This keeps the build green while\n// still ensuring we do not accidentally operate without proper secrets in\n// production.\n\nfunction createDummyClient() {\n  return new Proxy({}, {\n    get() {\n      throw new Error('Supabase Admin client requested, but required environment variables are missing (NEXT_PUBLIC_SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY). Configure these in your deployment environment.')\n    },\n  }) as unknown as ReturnType<typeof createClient>\n}\n\nconst supabaseAdmin = (SUPABASE_URL && SUPABASE_SERVICE_ROLE_KEY)\n  ? createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY, {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false,\n      },\n    })\n  : createDummyClient()\n\nexport default supabaseAdmin; "],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAgBK;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAAAA,cAAA,GAAAE,CAAA;;;;AAhBL,MAAAC,aAAA;AAAA;AAAA,CAAAH,cAAA,GAAAE,CAAA,OAAAE,OAAA;AAEA,MAAMC,YAAY;AAAA;AAAA,CAAAL,cAAA,GAAAE,CAAA,OAAGI,OAAO,CAACC,GAAG,CAACC,wBAAwB;AACzD,MAAMC,yBAAyB;AAAA;AAAA,CAAAT,cAAA,GAAAE,CAAA,OAAGI,OAAO,CAACC,GAAG,CAACE,yBAAyB;AAEvE;AACA;AACA;AACA;AACA;AACA;AAEA,SAASC,iBAAiBA,CAAA;EAAA;EAAAV,cAAA,GAAAW,CAAA;EAAAX,cAAA,GAAAE,CAAA;EACxB,OAAO,IAAIU,KAAK,CAAC,EAAE,EAAE;IACnBC,GAAGA,CAAA;MAAA;MAAAb,cAAA,GAAAW,CAAA;MAAAX,cAAA,GAAAE,CAAA;MACD,MAAM,IAAIY,KAAK,CAAC,wLAAwL,CAAC;IAC3M;GACD,CAA+C;AAClD;AAEA,MAAMC,aAAa;AAAA;AAAA,CAAAf,cAAA,GAAAE,CAAA;AAAI;AAAA,CAAAF,cAAA,GAAAgB,CAAA,UAAAX,YAAY;AAAA;AAAA,CAAAL,cAAA,GAAAgB,CAAA,UAAIP,yBAAyB;AAAA;AAAA,CAAAT,cAAA,GAAAgB,CAAA,UAC5D,IAAAb,aAAA,CAAAc,YAAY,EAACZ,YAAY,EAAEI,yBAAyB,EAAE;EACpDS,IAAI,EAAE;IACJC,gBAAgB,EAAE,KAAK;IACvBC,cAAc,EAAE;;CAEnB,CAAC;AAAA;AAAA,CAAApB,cAAA,GAAAgB,CAAA,UACFN,iBAAiB,EAAE;AAAA;AAAAV,cAAA,GAAAE,CAAA;AAEvBmB,OAAA,CAAAC,OAAA,GAAeP,aAAa","ignoreList":[]}