635ead29095a068e64cfefaed5ba9801
"use strict";
/**
 * PROFILE MAPPER MODULE
 *
 * Created: 2025-01-09
 * Last Modified: 2025-01-09
 * Last Modified Summary: Extracted from profileService.ts for modular architecture - handles schema mapping
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.ProfileMapper = void 0;
// =====================================================================
// ðŸ”„ SCHEMA MAPPING UTILITIES
// =====================================================================
class ProfileMapper {
    /**
     * Map database row to scalable profile interface
     */
    static mapDatabaseToProfile(dbRow) {
        if (!dbRow)
            return null;
        return {
            // Core database fields
            id: dbRow.id,
            username: dbRow.username,
            display_name: dbRow.display_name,
            avatar_url: dbRow.avatar_url,
            banner_url: dbRow.banner_url,
            bio: dbRow.bio,
            website: dbRow.website,
            bitcoin_address: dbRow.bitcoin_address,
            lightning_address: dbRow.lightning_address,
            created_at: dbRow.created_at,
            updated_at: dbRow.updated_at,
            // Legacy compatibility
            full_name: dbRow.display_name || null,
            // Extended fields with defaults
            email: null,
            phone: null,
            location: null,
            timezone: 'UTC',
            language: 'en',
            currency: 'USD',
            // Bitcoin-native features
            bitcoin_public_key: null,
            lightning_node_id: null,
            payment_preferences: {},
            bitcoin_balance: 0,
            lightning_balance: 0,
            // Analytics & Engagement
            profile_views: 0,
            follower_count: 0,
            following_count: 0,
            campaign_count: 0,
            total_raised: 0,
            total_donated: 0,
            // Verification & Security
            verification_status: 'unverified',
            verification_level: 0,
            kyc_status: 'none',
            two_factor_enabled: false,
            last_login_at: null,
            login_count: 0,
            // Customization & Branding
            theme_preferences: {},
            custom_css: null,
            profile_color: null,
            cover_image_url: null,
            profile_badges: [],
            // Status & Temporal
            status: 'active',
            last_active_at: null,
            profile_completed_at: null,
            onboarding_completed: false,
            terms_accepted_at: null,
            privacy_policy_accepted_at: null,
            // Extensibility (JSON fields)
            social_links: {},
            preferences: {},
            metadata: {},
            verification_data: {},
            privacy_settings: {}
        };
    }
    /**
     * Map profile object to database format
     */
    static mapProfileToDatabase(profile) {
        // Core fields that go directly to database columns
        const coreFields = {
            username: profile.username || null,
            display_name: profile.display_name || profile.full_name || null,
            avatar_url: profile.avatar_url || null,
            banner_url: profile.banner_url || null,
            bio: profile.bio || null,
            website: profile.website || null,
            bitcoin_address: profile.bitcoin_address || null,
            lightning_address: profile.lightning_address || null,
            updated_at: new Date().toISOString()
        };
        // Only include fields that are not null/undefined
        const cleanFields = {};
        Object.keys(coreFields).forEach(key => {
            if (coreFields[key] !== null && coreFields[key] !== undefined) {
                cleanFields[key] = coreFields[key];
            }
        });
        return cleanFields;
    }
}
exports.ProfileMapper = ProfileMapper;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvZy9kZXYvb3JhbmdlY2F0L3NyYy9zZXJ2aWNlcy9wcm9maWxlL21hcHBlci50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7OztHQU1HOzs7QUFJSCx3RUFBd0U7QUFDeEUsOEJBQThCO0FBQzlCLHdFQUF3RTtBQUV4RSxNQUFhLGFBQWE7SUFDeEI7O09BRUc7SUFDSCxNQUFNLENBQUMsb0JBQW9CLENBQUMsS0FBVTtRQUNwQyxJQUFJLENBQUMsS0FBSztZQUFFLE9BQU8sSUFBSSxDQUFDO1FBRXhCLE9BQU87WUFDTCx1QkFBdUI7WUFDdkIsRUFBRSxFQUFFLEtBQUssQ0FBQyxFQUFFO1lBQ1osUUFBUSxFQUFFLEtBQUssQ0FBQyxRQUFRO1lBQ3hCLFlBQVksRUFBRSxLQUFLLENBQUMsWUFBWTtZQUNoQyxVQUFVLEVBQUUsS0FBSyxDQUFDLFVBQVU7WUFDNUIsVUFBVSxFQUFFLEtBQUssQ0FBQyxVQUFVO1lBQzVCLEdBQUcsRUFBRSxLQUFLLENBQUMsR0FBRztZQUNkLE9BQU8sRUFBRSxLQUFLLENBQUMsT0FBTztZQUN0QixlQUFlLEVBQUUsS0FBSyxDQUFDLGVBQWU7WUFDdEMsaUJBQWlCLEVBQUUsS0FBSyxDQUFDLGlCQUFpQjtZQUMxQyxVQUFVLEVBQUUsS0FBSyxDQUFDLFVBQVU7WUFDNUIsVUFBVSxFQUFFLEtBQUssQ0FBQyxVQUFVO1lBRTVCLHVCQUF1QjtZQUN2QixTQUFTLEVBQUUsS0FBSyxDQUFDLFlBQVksSUFBSSxJQUFJO1lBRXJDLGdDQUFnQztZQUNoQyxLQUFLLEVBQUUsSUFBSTtZQUNYLEtBQUssRUFBRSxJQUFJO1lBQ1gsUUFBUSxFQUFFLElBQUk7WUFDZCxRQUFRLEVBQUUsS0FBSztZQUNmLFFBQVEsRUFBRSxJQUFJO1lBQ2QsUUFBUSxFQUFFLEtBQUs7WUFFZiwwQkFBMEI7WUFDMUIsa0JBQWtCLEVBQUUsSUFBSTtZQUN4QixpQkFBaUIsRUFBRSxJQUFJO1lBQ3ZCLG1CQUFtQixFQUFFLEVBQUU7WUFDdkIsZUFBZSxFQUFFLENBQUM7WUFDbEIsaUJBQWlCLEVBQUUsQ0FBQztZQUVwQix5QkFBeUI7WUFDekIsYUFBYSxFQUFFLENBQUM7WUFDaEIsY0FBYyxFQUFFLENBQUM7WUFDakIsZUFBZSxFQUFFLENBQUM7WUFDbEIsY0FBYyxFQUFFLENBQUM7WUFDakIsWUFBWSxFQUFFLENBQUM7WUFDZixhQUFhLEVBQUUsQ0FBQztZQUVoQiwwQkFBMEI7WUFDMUIsbUJBQW1CLEVBQUUsWUFBWTtZQUNqQyxrQkFBa0IsRUFBRSxDQUFDO1lBQ3JCLFVBQVUsRUFBRSxNQUFNO1lBQ2xCLGtCQUFrQixFQUFFLEtBQUs7WUFDekIsYUFBYSxFQUFFLElBQUk7WUFDbkIsV0FBVyxFQUFFLENBQUM7WUFFZCwyQkFBMkI7WUFDM0IsaUJBQWlCLEVBQUUsRUFBRTtZQUNyQixVQUFVLEVBQUUsSUFBSTtZQUNoQixhQUFhLEVBQUUsSUFBSTtZQUNuQixlQUFlLEVBQUUsSUFBSTtZQUNyQixjQUFjLEVBQUUsRUFBRTtZQUVsQixvQkFBb0I7WUFDcEIsTUFBTSxFQUFFLFFBQVE7WUFDaEIsY0FBYyxFQUFFLElBQUk7WUFDcEIsb0JBQW9CLEVBQUUsSUFBSTtZQUMxQixvQkFBb0IsRUFBRSxLQUFLO1lBQzNCLGlCQUFpQixFQUFFLElBQUk7WUFDdkIsMEJBQTBCLEVBQUUsSUFBSTtZQUVoQyw4QkFBOEI7WUFDOUIsWUFBWSxFQUFFLEVBQUU7WUFDaEIsV0FBVyxFQUFFLEVBQUU7WUFDZixRQUFRLEVBQUUsRUFBRTtZQUNaLGlCQUFpQixFQUFFLEVBQUU7WUFDckIsZ0JBQWdCLEVBQUUsRUFBRTtTQUNyQixDQUFDO0lBQ0osQ0FBQztJQUVEOztPQUVHO0lBQ0gsTUFBTSxDQUFDLG9CQUFvQixDQUFDLE9BQWlDO1FBQzNELG1EQUFtRDtRQUNuRCxNQUFNLFVBQVUsR0FBUTtZQUN0QixRQUFRLEVBQUUsT0FBTyxDQUFDLFFBQVEsSUFBSSxJQUFJO1lBQ2xDLFlBQVksRUFBRSxPQUFPLENBQUMsWUFBWSxJQUFJLE9BQU8sQ0FBQyxTQUFTLElBQUksSUFBSTtZQUMvRCxVQUFVLEVBQUUsT0FBTyxDQUFDLFVBQVUsSUFBSSxJQUFJO1lBQ3RDLFVBQVUsRUFBRSxPQUFPLENBQUMsVUFBVSxJQUFJLElBQUk7WUFDdEMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxHQUFHLElBQUksSUFBSTtZQUN4QixPQUFPLEVBQUUsT0FBTyxDQUFDLE9BQU8sSUFBSSxJQUFJO1lBQ2hDLGVBQWUsRUFBRSxPQUFPLENBQUMsZUFBZSxJQUFJLElBQUk7WUFDaEQsaUJBQWlCLEVBQUUsT0FBTyxDQUFDLGlCQUFpQixJQUFJLElBQUk7WUFDcEQsVUFBVSxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO1NBQ3JDLENBQUM7UUFFRixrREFBa0Q7UUFDbEQsTUFBTSxXQUFXLEdBQVEsRUFBRSxDQUFDO1FBQzVCLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1lBQ3BDLElBQUksVUFBVSxDQUFDLEdBQUcsQ0FBQyxLQUFLLElBQUksSUFBSSxVQUFVLENBQUMsR0FBRyxDQUFDLEtBQUssU0FBUyxFQUFFLENBQUM7Z0JBQzlELFdBQVcsQ0FBQyxHQUFHLENBQUMsR0FBRyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDckMsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTyxXQUFXLENBQUM7SUFDckIsQ0FBQztDQUNGO0FBMUdELHNDQTBHQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9nL2Rldi9vcmFuZ2VjYXQvc3JjL3NlcnZpY2VzL3Byb2ZpbGUvbWFwcGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUFJPRklMRSBNQVBQRVIgTU9EVUxFXG4gKiBcbiAqIENyZWF0ZWQ6IDIwMjUtMDEtMDlcbiAqIExhc3QgTW9kaWZpZWQ6IDIwMjUtMDEtMDlcbiAqIExhc3QgTW9kaWZpZWQgU3VtbWFyeTogRXh0cmFjdGVkIGZyb20gcHJvZmlsZVNlcnZpY2UudHMgZm9yIG1vZHVsYXIgYXJjaGl0ZWN0dXJlIC0gaGFuZGxlcyBzY2hlbWEgbWFwcGluZ1xuICovXG5cbmltcG9ydCB0eXBlIHsgU2NhbGFibGVQcm9maWxlLCBTY2FsYWJsZVByb2ZpbGVGb3JtRGF0YSB9IGZyb20gJy4vdHlwZXMnXG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8g8J+UhCBTQ0hFTUEgTUFQUElORyBVVElMSVRJRVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY2xhc3MgUHJvZmlsZU1hcHBlciB7XG4gIC8qKlxuICAgKiBNYXAgZGF0YWJhc2Ugcm93IHRvIHNjYWxhYmxlIHByb2ZpbGUgaW50ZXJmYWNlXG4gICAqL1xuICBzdGF0aWMgbWFwRGF0YWJhc2VUb1Byb2ZpbGUoZGJSb3c6IGFueSk6IFNjYWxhYmxlUHJvZmlsZSB7XG4gICAgaWYgKCFkYlJvdykgcmV0dXJuIG51bGw7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIC8vIENvcmUgZGF0YWJhc2UgZmllbGRzXG4gICAgICBpZDogZGJSb3cuaWQsXG4gICAgICB1c2VybmFtZTogZGJSb3cudXNlcm5hbWUsXG4gICAgICBkaXNwbGF5X25hbWU6IGRiUm93LmRpc3BsYXlfbmFtZSxcbiAgICAgIGF2YXRhcl91cmw6IGRiUm93LmF2YXRhcl91cmwsXG4gICAgICBiYW5uZXJfdXJsOiBkYlJvdy5iYW5uZXJfdXJsLFxuICAgICAgYmlvOiBkYlJvdy5iaW8sXG4gICAgICB3ZWJzaXRlOiBkYlJvdy53ZWJzaXRlLFxuICAgICAgYml0Y29pbl9hZGRyZXNzOiBkYlJvdy5iaXRjb2luX2FkZHJlc3MsXG4gICAgICBsaWdodG5pbmdfYWRkcmVzczogZGJSb3cubGlnaHRuaW5nX2FkZHJlc3MsXG4gICAgICBjcmVhdGVkX2F0OiBkYlJvdy5jcmVhdGVkX2F0LFxuICAgICAgdXBkYXRlZF9hdDogZGJSb3cudXBkYXRlZF9hdCxcbiAgICAgIFxuICAgICAgLy8gTGVnYWN5IGNvbXBhdGliaWxpdHlcbiAgICAgIGZ1bGxfbmFtZTogZGJSb3cuZGlzcGxheV9uYW1lIHx8IG51bGwsXG4gICAgICBcbiAgICAgIC8vIEV4dGVuZGVkIGZpZWxkcyB3aXRoIGRlZmF1bHRzXG4gICAgICBlbWFpbDogbnVsbCxcbiAgICAgIHBob25lOiBudWxsLFxuICAgICAgbG9jYXRpb246IG51bGwsXG4gICAgICB0aW1lem9uZTogJ1VUQycsXG4gICAgICBsYW5ndWFnZTogJ2VuJyxcbiAgICAgIGN1cnJlbmN5OiAnVVNEJyxcbiAgICAgIFxuICAgICAgLy8gQml0Y29pbi1uYXRpdmUgZmVhdHVyZXNcbiAgICAgIGJpdGNvaW5fcHVibGljX2tleTogbnVsbCxcbiAgICAgIGxpZ2h0bmluZ19ub2RlX2lkOiBudWxsLFxuICAgICAgcGF5bWVudF9wcmVmZXJlbmNlczoge30sXG4gICAgICBiaXRjb2luX2JhbGFuY2U6IDAsXG4gICAgICBsaWdodG5pbmdfYmFsYW5jZTogMCxcbiAgICAgIFxuICAgICAgLy8gQW5hbHl0aWNzICYgRW5nYWdlbWVudFxuICAgICAgcHJvZmlsZV92aWV3czogMCxcbiAgICAgIGZvbGxvd2VyX2NvdW50OiAwLFxuICAgICAgZm9sbG93aW5nX2NvdW50OiAwLFxuICAgICAgY2FtcGFpZ25fY291bnQ6IDAsXG4gICAgICB0b3RhbF9yYWlzZWQ6IDAsXG4gICAgICB0b3RhbF9kb25hdGVkOiAwLFxuICAgICAgXG4gICAgICAvLyBWZXJpZmljYXRpb24gJiBTZWN1cml0eVxuICAgICAgdmVyaWZpY2F0aW9uX3N0YXR1czogJ3VudmVyaWZpZWQnLFxuICAgICAgdmVyaWZpY2F0aW9uX2xldmVsOiAwLFxuICAgICAga3ljX3N0YXR1czogJ25vbmUnLFxuICAgICAgdHdvX2ZhY3Rvcl9lbmFibGVkOiBmYWxzZSxcbiAgICAgIGxhc3RfbG9naW5fYXQ6IG51bGwsXG4gICAgICBsb2dpbl9jb3VudDogMCxcbiAgICAgIFxuICAgICAgLy8gQ3VzdG9taXphdGlvbiAmIEJyYW5kaW5nXG4gICAgICB0aGVtZV9wcmVmZXJlbmNlczoge30sXG4gICAgICBjdXN0b21fY3NzOiBudWxsLFxuICAgICAgcHJvZmlsZV9jb2xvcjogbnVsbCxcbiAgICAgIGNvdmVyX2ltYWdlX3VybDogbnVsbCxcbiAgICAgIHByb2ZpbGVfYmFkZ2VzOiBbXSxcbiAgICAgIFxuICAgICAgLy8gU3RhdHVzICYgVGVtcG9yYWxcbiAgICAgIHN0YXR1czogJ2FjdGl2ZScsXG4gICAgICBsYXN0X2FjdGl2ZV9hdDogbnVsbCxcbiAgICAgIHByb2ZpbGVfY29tcGxldGVkX2F0OiBudWxsLFxuICAgICAgb25ib2FyZGluZ19jb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgdGVybXNfYWNjZXB0ZWRfYXQ6IG51bGwsXG4gICAgICBwcml2YWN5X3BvbGljeV9hY2NlcHRlZF9hdDogbnVsbCxcbiAgICAgIFxuICAgICAgLy8gRXh0ZW5zaWJpbGl0eSAoSlNPTiBmaWVsZHMpXG4gICAgICBzb2NpYWxfbGlua3M6IHt9LFxuICAgICAgcHJlZmVyZW5jZXM6IHt9LFxuICAgICAgbWV0YWRhdGE6IHt9LFxuICAgICAgdmVyaWZpY2F0aW9uX2RhdGE6IHt9LFxuICAgICAgcHJpdmFjeV9zZXR0aW5nczoge31cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIE1hcCBwcm9maWxlIG9iamVjdCB0byBkYXRhYmFzZSBmb3JtYXRcbiAgICovXG4gIHN0YXRpYyBtYXBQcm9maWxlVG9EYXRhYmFzZShwcm9maWxlOiBQYXJ0aWFsPFNjYWxhYmxlUHJvZmlsZT4pOiBhbnkge1xuICAgIC8vIENvcmUgZmllbGRzIHRoYXQgZ28gZGlyZWN0bHkgdG8gZGF0YWJhc2UgY29sdW1uc1xuICAgIGNvbnN0IGNvcmVGaWVsZHM6IGFueSA9IHtcbiAgICAgIHVzZXJuYW1lOiBwcm9maWxlLnVzZXJuYW1lIHx8IG51bGwsXG4gICAgICBkaXNwbGF5X25hbWU6IHByb2ZpbGUuZGlzcGxheV9uYW1lIHx8IHByb2ZpbGUuZnVsbF9uYW1lIHx8IG51bGwsXG4gICAgICBhdmF0YXJfdXJsOiBwcm9maWxlLmF2YXRhcl91cmwgfHwgbnVsbCxcbiAgICAgIGJhbm5lcl91cmw6IHByb2ZpbGUuYmFubmVyX3VybCB8fCBudWxsLFxuICAgICAgYmlvOiBwcm9maWxlLmJpbyB8fCBudWxsLFxuICAgICAgd2Vic2l0ZTogcHJvZmlsZS53ZWJzaXRlIHx8IG51bGwsXG4gICAgICBiaXRjb2luX2FkZHJlc3M6IHByb2ZpbGUuYml0Y29pbl9hZGRyZXNzIHx8IG51bGwsXG4gICAgICBsaWdodG5pbmdfYWRkcmVzczogcHJvZmlsZS5saWdodG5pbmdfYWRkcmVzcyB8fCBudWxsLFxuICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfTtcblxuICAgIC8vIE9ubHkgaW5jbHVkZSBmaWVsZHMgdGhhdCBhcmUgbm90IG51bGwvdW5kZWZpbmVkXG4gICAgY29uc3QgY2xlYW5GaWVsZHM6IGFueSA9IHt9O1xuICAgIE9iamVjdC5rZXlzKGNvcmVGaWVsZHMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgIGlmIChjb3JlRmllbGRzW2tleV0gIT09IG51bGwgJiYgY29yZUZpZWxkc1trZXldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY2xlYW5GaWVsZHNba2V5XSA9IGNvcmVGaWVsZHNba2V5XTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICByZXR1cm4gY2xlYW5GaWVsZHM7XG4gIH1cbn0gIl0sInZlcnNpb24iOjN9