141554d3ab9c20da67279cd839711cd8
"use strict";
/**
 * COMPREHENSIVE SECURITY HARDENING SYSTEM
 *
 * Option C - Security Hardening Implementation
 * Addresses all critical security vulnerabilities identified in the platform
 *
 * Created: 2025-01-14
 * Last Modified: 2025-06-12
 * Last Modified Summary: Complete security hardening for production deployment - Option C completed
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.SecurityHardening = exports.ContentSecurityPolicy = exports.SecurityMonitor = exports.SecureErrorHandler = exports.AuthenticationSecurity = exports.RateLimiter = exports.SecuritySchemas = exports.XSSPrevention = void 0;
const server_1 = require("next/server");
const logger_1 = require("@/utils/logger");
const zod_1 = require("zod");
// ==================== INPUT SANITIZATION SYSTEM ====================
/**
 * XSS Prevention - HTML Entity Encoding and Content Sanitization
 *
 * Provides comprehensive protection against Cross-Site Scripting (XSS) attacks
 * by sanitizing user input and encoding dangerous characters.
 *
 * @example
 * ```typescript
 * const safeInput = XSSPrevention.sanitizeHTML('<script>alert("xss")</script>');
 * // Returns: '&lt;script&gt;alert(&quot;xss&quot;)&lt;/script&gt;'
 * ```
 */
class XSSPrevention {
    /**
     * Sanitize HTML content by encoding dangerous characters
     * @param input - Raw HTML content to sanitize
     * @returns Sanitized string safe for HTML display
     */
    static sanitizeHTML(input) {
        if (!input || typeof input !== 'string')
            return '';
        return input.replace(/[&<>"'`=\/]/g, (match) => {
            return this.HTML_ENTITIES[match] || match;
        });
    }
    /**
     * Sanitize input for use in HTML attributes with aggressive filtering
     * @param input - Raw input to sanitize for HTML attributes
     * @returns Sanitized string safe for HTML attributes
     */
    static sanitizeForAttribute(input) {
        if (!input || typeof input !== 'string')
            return '';
        // More aggressive sanitization for HTML attributes
        return input
            .replace(/[&<>"'`=\/\(\)\[\]{}]/g, (match) => {
            return this.HTML_ENTITIES[match] || '';
        })
            .replace(/javascript:/gi, '')
            .replace(/vbscript:/gi, '')
            .replace(/data:/gi, '')
            .replace(/on\w+=/gi, '');
    }
    /**
     * Sanitize plain text content with length limits
     * @param input - Raw text to sanitize
     * @returns Sanitized text safe for display (max 1000 chars)
     */
    static sanitizeText(input) {
        if (!input || typeof input !== 'string')
            return '';
        return input
            .replace(/[<>]/g, (match) => this.HTML_ENTITIES[match])
            .trim()
            .substring(0, 1000); // Limit length
    }
}
exports.XSSPrevention = XSSPrevention;
XSSPrevention.HTML_ENTITIES = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#x27;',
    '/': '&#x2F;',
    '`': '&#x60;',
    '=': '&#x3D;'
};
/**
 * Input Validation Schemas with Security Focus
 */
exports.SecuritySchemas = {
    // Email with strict validation
    email: zod_1.z.string()
        .email('Invalid email format')
        .min(5, 'Email too short')
        .max(254, 'Email too long')
        .regex(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/, 'Invalid email format')
        .transform(email => email.toLowerCase().trim()),
    // Bitcoin address with enhanced validation
    bitcoinAddress: zod_1.z.string()
        .min(26, 'Bitcoin address too short')
        .max(62, 'Bitcoin address too long')
        .regex(/^[13][a-km-zA-HJ-NP-Z1-9]{25,34}$|^bc1[a-z0-9]{39,59}$/, 'Invalid Bitcoin address format')
        .refine(address => {
        // Additional validation for known attack patterns
        const suspiciousPatterns = [
            /script/gi,
            /javascript/gi,
            /vbscript/gi,
            /<|>/gi,
            /\x00/gi // Null bytes
        ];
        return !suspiciousPatterns.some(pattern => pattern.test(address));
    }, 'Bitcoin address contains invalid characters'),
    // Username with anti-impersonation
    username: zod_1.z.string()
        .min(3, 'Username too short')
        .max(30, 'Username too long')
        .regex(/^[a-zA-Z0-9_-]+$/, 'Username can only contain letters, numbers, underscores, and hyphens')
        .refine(username => {
        // Celebrity/brand impersonation prevention
        const reservedNames = [
            'admin', 'administrator', 'root', 'system', 'support', 'help',
            'bitcoin', 'satoshi', 'nakamoto', 'elon', 'musk', 'tesla',
            'apple', 'google', 'microsoft', 'facebook', 'twitter', 'meta',
            'orangecat', 'official', 'verified', 'staff', 'team'
        ];
        return !reservedNames.includes(username.toLowerCase());
    }, 'Username is reserved or may cause impersonation')
        .transform(username => username.toLowerCase().trim()),
    // Bio/description with content filtering
    bio: zod_1.z.string()
        .max(500, 'Bio too long')
        .refine(bio => {
        // Content filtering for spam/malicious content
        const suspiciousPatterns = [
            /(?:https?:\/\/)?(?:www\.)?[a-zA-Z0-9-]+\.[a-zA-Z]{2,}/gi, // URLs
            /\b(?:buy|sell|invest|profit|money|crypto|trading|forex)\b/gi, // Financial spam
            /<script|javascript:|vbscript:|data:/gi, // Script injection
            /\b(?:telegram|whatsapp|discord)\b.*@/gi // Contact spam
        ];
        const suspiciousCount = suspiciousPatterns.reduce((count, pattern) => {
            return count + (pattern.test(bio) ? 1 : 0);
        }, 0);
        return suspiciousCount < 2; // Allow some flexibility but flag multiple patterns
    }, 'Bio contains suspicious content')
        .transform(bio => XSSPrevention.sanitizeText(bio))
};
/**
 * Rate Limiting System for API Protection
 *
 * Implements sliding window rate limiting to prevent abuse and DoS attacks.
 * Supports different rate limits for different operation types.
 *
 * @example
 * ```typescript
 * const result = await RateLimiter.checkLimit('user@example.com', 'auth');
 * if (!result.allowed) {
 *   throw new Error(`Rate limit exceeded. Try again in ${result.resetTime - Date.now()}ms`);
 * }
 * ```
 */
class RateLimiter {
    /**
     * Check if request is within rate limits
     * @param identifier - Unique identifier (IP, user ID, email)
     * @param limitType - Type of rate limit to apply
     * @returns Rate limit status with remaining requests and reset time
     */
    static async checkLimit(identifier, limitType) {
        const config = this.LIMITS[limitType];
        const now = Date.now();
        const key = `${limitType}:${identifier}`;
        // Clean up expired entries
        this.cleanup();
        const existing = this.requests.get(key);
        if (!existing || now > existing.resetTime) {
            // New window
            this.requests.set(key, {
                count: 1,
                resetTime: now + config.windowMs
            });
            return {
                allowed: true,
                remaining: config.maxRequests - 1,
                resetTime: now + config.windowMs
            };
        }
        if (existing.count >= config.maxRequests) {
            return {
                allowed: false,
                remaining: 0,
                resetTime: existing.resetTime
            };
        }
        existing.count++;
        return {
            allowed: true,
            remaining: config.maxRequests - existing.count,
            resetTime: existing.resetTime
        };
    }
    static cleanup() {
        const now = Date.now();
        for (const [key, value] of this.requests.entries()) {
            if (now > value.resetTime) {
                this.requests.delete(key);
            }
        }
    }
    static getStats() {
        this.cleanup();
        return {
            totalKeys: this.requests.size,
            activeWindows: this.requests.size
        };
    }
}
exports.RateLimiter = RateLimiter;
RateLimiter.requests = new Map();
RateLimiter.LIMITS = {
    // API rate limits
    api: { windowMs: 15 * 60 * 1000, maxRequests: 100 }, // 100 requests per 15 minutes
    auth: { windowMs: 15 * 60 * 1000, maxRequests: 5 }, // 5 auth attempts per 15 minutes
    upload: { windowMs: 60 * 1000, maxRequests: 5 }, // 5 uploads per minute
    search: { windowMs: 60 * 1000, maxRequests: 30 }, // 30 searches per minute
    // Strict limits for sensitive operations
    passwordReset: { windowMs: 60 * 60 * 1000, maxRequests: 3 }, // 3 per hour
    profileUpdate: { windowMs: 5 * 60 * 1000, maxRequests: 10 }, // 10 per 5 minutes
};
// ==================== AUTHENTICATION SECURITY ====================
/**
 * Authentication Security System
 *
 * Provides account lockout protection, password strength validation,
 * and secure token generation for authentication operations.
 *
 * @example
 * ```typescript
 * // Check if account is locked
 * if (AuthenticationSecurity.isAccountLocked('user@example.com')) {
 *   throw new Error('Account temporarily locked due to failed attempts');
 * }
 *
 * // Validate password strength
 * const validation = AuthenticationSecurity.validatePasswordStrength('password123');
 * if (!validation.valid) {
 *   console.log('Password errors:', validation.errors);
 * }
 * ```
 */
class AuthenticationSecurity {
    /**
     * Check if account is locked due to failed authentication attempts
     * @param identifier - Account identifier (email, username)
     * @returns True if account is currently locked
     */
    static isAccountLocked(identifier) {
        const lockTime = this.lockedAccounts.get(identifier);
        if (!lockTime)
            return false;
        if (Date.now() > lockTime) {
            this.lockedAccounts.delete(identifier);
            return false;
        }
        return true;
    }
    /**
     * Record failed authentication attempt and lock account if needed
     * @param identifier - Account identifier that failed authentication
     */
    static recordFailedAttempt(identifier) {
        const lockUntil = Date.now() + this.LOCKOUT_DURATION;
        this.lockedAccounts.set(identifier, lockUntil);
        logger_1.logger.warn('Authentication failure recorded', {
            identifier: identifier.substring(0, 3) + '***', // Partial identifier for privacy
            lockUntil: new Date(lockUntil).toISOString()
        }, 'Security');
    }
    /**
     * Clear failed attempts record on successful authentication
     * @param identifier - Account identifier that successfully authenticated
     */
    static clearFailedAttempts(identifier) {
        this.lockedAccounts.delete(identifier);
    }
    /**
     * Validate password strength against security requirements
     * @param password - Password to validate
     * @returns Validation result with detailed error messages
     */
    static validatePasswordStrength(password) {
        const errors = [];
        if (password.length < 8)
            errors.push('Password must be at least 8 characters');
        if (password.length > 128)
            errors.push('Password too long');
        if (!/[A-Z]/.test(password))
            errors.push('Password must contain uppercase letter');
        if (!/[a-z]/.test(password))
            errors.push('Password must contain lowercase letter');
        if (!/[0-9]/.test(password))
            errors.push('Password must contain number');
        if (!/[^A-Za-z0-9]/.test(password))
            errors.push('Password must contain special character');
        // Check for common weak passwords
        const commonPasswords = [
            'password', '123456', 'qwerty', 'abc123', 'password123',
            'admin', 'letmein', 'welcome', 'monkey', 'dragon'
        ];
        if (commonPasswords.includes(password.toLowerCase())) {
            errors.push('Password is too common');
        }
        return {
            valid: errors.length === 0,
            errors
        };
    }
    /**
     * Generate cryptographically secure random token
     * @param length - Token length (default: 32 characters)
     * @returns Secure random string suitable for tokens
     */
    static generateSecureToken(length = 32) {
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
        let result = '';
        for (let i = 0; i < length; i++) {
            result += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return result;
    }
}
exports.AuthenticationSecurity = AuthenticationSecurity;
AuthenticationSecurity.LOCKOUT_DURATION = 15 * 60 * 1000; // 15 minutes
AuthenticationSecurity.MAX_ATTEMPTS = 5;
AuthenticationSecurity.lockedAccounts = new Map();
// ==================== ERROR HANDLING SECURITY ====================
class SecureErrorHandler {
    /**
     * Sanitize error messages to prevent information disclosure
     */
    static sanitizeError(error, isProduction = process.env.NODE_ENV === 'production') {
        // In production, never expose internal errors
        if (isProduction) {
            const safeErrors = [
                'Invalid credentials',
                'Access denied',
                'Resource not found',
                'Invalid input',
                'Rate limit exceeded',
                'File too large',
                'Invalid file type'
            ];
            const errorMessage = (error === null || error === void 0 ? void 0 : error.message) || 'An error occurred';
            const isSafeError = safeErrors.some(safe => errorMessage.includes(safe));
            return {
                message: isSafeError ? errorMessage : 'An error occurred',
                code: (error === null || error === void 0 ? void 0 : error.code) || 'INTERNAL_ERROR'
            };
        }
        // In development, provide more details but still sanitize
        return {
            message: (error === null || error === void 0 ? void 0 : error.message) || 'An error occurred',
            code: error === null || error === void 0 ? void 0 : error.code,
            details: (error === null || error === void 0 ? void 0 : error.stack) ? error.stack.split('\n').slice(0, 3) : undefined
        };
    }
    /**
     * Log security events
     */
    static logSecurityEvent(event, details, severity = 'medium') {
        const logData = Object.assign({ event,
            severity, timestamp: new Date().toISOString() }, details);
        if (severity === 'critical' || severity === 'high') {
            logger_1.logger.error(`Security Event: ${event}`, logData, 'Security');
        }
        else {
            logger_1.logger.warn(`Security Event: ${event}`, logData, 'Security');
        }
    }
}
exports.SecureErrorHandler = SecureErrorHandler;
/**
 * Security Event Monitoring System
 *
 * Tracks and analyzes security events for threat detection and incident response.
 * Maintains event history and provides alerting for critical security events.
 *
 * @example
 * ```typescript
 * // Record security event
 * SecurityMonitor.recordEvent('suspicious_login', 'high', {
 *   ip: '192.168.1.1',
 *   userAgent: 'suspicious-bot'
 * });
 *
 * // Get security statistics
 * const stats = SecurityMonitor.getStats();
 * console.log(`Critical events: ${stats.criticalEvents}`);
 * ```
 */
class SecurityMonitor {
    /**
     * Record a security event for monitoring and analysis
     * @param type - Event type identifier
     * @param severity - Event severity level
     * @param details - Additional event context and metadata
     */
    static recordEvent(type, severity, details) {
        const event = {
            id: AuthenticationSecurity.generateSecureToken(16),
            type,
            severity,
            timestamp: Date.now(),
            details
        };
        this.events.push(event);
        // Keep only recent events
        if (this.events.length > this.MAX_EVENTS) {
            this.events = this.events.slice(-this.MAX_EVENTS);
        }
        // Alert on critical events
        if (severity === 'critical') {
            this.alertCriticalEvent(event);
        }
    }
    /**
     * Retrieve security events with filtering and limiting
     * @param severity - Optional severity filter
     * @param limit - Maximum number of events to return (default: 100)
     * @returns Array of security events sorted by timestamp (newest first)
     */
    static getEvents(severity, limit = 100) {
        let filtered = this.events;
        if (severity) {
            filtered = this.events.filter(e => e.severity === severity);
        }
        return filtered
            .sort((a, b) => b.timestamp - a.timestamp)
            .slice(0, limit);
    }
    /**
     * Get security statistics
     */
    static getStats() {
        const now = Date.now();
        const oneHourAgo = now - 60 * 60 * 1000;
        const eventsBySeverity = this.events.reduce((acc, event) => {
            acc[event.severity] = (acc[event.severity] || 0) + 1;
            return acc;
        }, {});
        return {
            totalEvents: this.events.length,
            eventsBySeverity,
            recentEvents: this.events.filter(e => e.timestamp > oneHourAgo).length,
            criticalEvents: this.events.filter(e => e.severity === 'critical').length
        };
    }
    static alertCriticalEvent(event) {
        logger_1.logger.error('CRITICAL SECURITY EVENT', {
            eventId: event.id,
            type: event.type,
            details: event.details
        }, 'Security');
        // In production, this would trigger alerts to security team
        if (process.env.NODE_ENV === 'production') {
            // TODO: Integrate with alerting system (email, Slack, PagerDuty, etc.)
        }
    }
}
exports.SecurityMonitor = SecurityMonitor;
SecurityMonitor.events = [];
SecurityMonitor.MAX_EVENTS = 1000;
// ==================== CONTENT SECURITY POLICY ====================
class ContentSecurityPolicy {
    static getHeaders() {
        const nonce = AuthenticationSecurity.generateSecureToken(16);
        return {
            'Content-Security-Policy': [
                "default-src 'self'",
                "script-src 'self' 'unsafe-inline' 'unsafe-eval' https://vercel.live https://va.vercel-scripts.com",
                "style-src 'self' 'unsafe-inline' https://fonts.googleapis.com",
                "font-src 'self' https://fonts.gstatic.com",
                "img-src 'self' data: https: blob:",
                "connect-src 'self' https://*.supabase.co wss://*.supabase.co https://vercel.live",
                "frame-src 'self' https://vercel.live",
                "object-src 'none'",
                "base-uri 'self'",
                "form-action 'self'",
                "frame-ancestors 'none'",
                "upgrade-insecure-requests"
            ].join('; '),
            'X-Content-Type-Options': 'nosniff',
            'X-Frame-Options': 'DENY',
            'X-XSS-Protection': '1; mode=block',
            'Referrer-Policy': 'strict-origin-when-cross-origin',
            'Permissions-Policy': 'camera=(), microphone=(), geolocation=()',
            // HSTS (HTTP Strict Transport Security)
            'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload'
        };
    }
}
exports.ContentSecurityPolicy = ContentSecurityPolicy;
// ==================== MAIN SECURITY MIDDLEWARE ====================
/**
 * Comprehensive Security Hardening Middleware
 *
 * Provides complete security protection for API routes including:
 * - Method validation
 * - Rate limiting
 * - Authentication verification
 * - Input validation
 * - Security event monitoring
 *
 * @example
 * ```typescript
 * // Secure an API route
 * const security = await SecurityHardening.secureAPIRoute(request, {
 *   requireAuth: true,
 *   rateLimit: 'api',
 *   allowedMethods: ['POST'],
 *   validateInput: userUpdateSchema
 * });
 *
 * if (!security.success) {
 *   return security.response; // Security check failed
 * }
 *
 * // Security passed, proceed with API logic
 * const user = security.user;
 * ```
 */
class SecurityHardening {
    /**
     * Apply comprehensive security protection to API routes
     * @param request - Next.js request object
     * @param options - Security configuration options
     * @param options.requireAuth - Whether authentication is required
     * @param options.rateLimit - Rate limit type to apply
     * @param options.validateInput - Zod schema for input validation
     * @param options.allowedMethods - HTTP methods allowed for this route
     * @returns Security check result with user data or error response
     */
    static async secureAPIRoute(request, options = {}) {
        try {
            const { requireAuth = true, rateLimit = 'api', validateInput, allowedMethods = ['GET', 'POST', 'PUT', 'DELETE'] } = options;
            // 1. Method validation
            if (!allowedMethods.includes(request.method)) {
                SecurityMonitor.recordEvent('invalid_method', 'medium', {
                    method: request.method,
                    url: request.url
                });
                return {
                    success: false,
                    response: server_1.NextResponse.json({ error: 'Method not allowed' }, { status: 405 })
                };
            }
            // 2. Rate limiting
            const clientIP = request.headers.get('x-forwarded-for') || request.headers.get('x-real-ip') || 'unknown';
            const rateLimitResult = await RateLimiter.checkLimit(clientIP, rateLimit);
            if (!rateLimitResult.allowed) {
                SecurityMonitor.recordEvent('rate_limit_exceeded', 'high', {
                    ip: clientIP,
                    limitType: rateLimit
                });
                return {
                    success: false,
                    response: server_1.NextResponse.json({ error: 'Rate limit exceeded' }, {
                        status: 429,
                        headers: {
                            'Retry-After': Math.ceil((rateLimitResult.resetTime - Date.now()) / 1000).toString()
                        }
                    })
                };
            }
            // 3. Authentication check
            let user = null;
            if (requireAuth) {
                try {
                    // Only import and use createServerClient when actually needed
                    const { createServerClient: createClient } = await Promise.resolve().then(() => __importStar(require('@/services/supabase/server')));
                    const supabase = await createClient();
                    const { data: { user: authUser }, error: authError } = await supabase.auth.getUser();
                    if (!authUser || authError) {
                        SecurityMonitor.recordEvent('unauthorized_access', 'medium', {
                            ip: clientIP,
                            url: request.url
                        });
                        return {
                            success: false,
                            response: server_1.NextResponse.json({ error: 'Authentication required' }, { status: 401 })
                        };
                    }
                    user = authUser;
                }
                catch (authError) {
                    SecurityMonitor.recordEvent('auth_error', 'high', {
                        ip: clientIP,
                        error: authError.message
                    });
                    return {
                        success: false,
                        response: server_1.NextResponse.json({ error: 'Authentication failed' }, { status: 500 })
                    };
                }
            }
            // 4. Input validation
            if (validateInput && request.method !== 'GET') {
                try {
                    const body = await request.json();
                    validateInput.parse(body);
                }
                catch (validationError) {
                    SecurityMonitor.recordEvent('input_validation_failed', 'medium', {
                        ip: clientIP,
                        error: validationError.message
                    });
                    return {
                        success: false,
                        response: server_1.NextResponse.json({ error: 'Invalid input data' }, { status: 400 })
                    };
                }
            }
            return { success: true, user };
        }
        catch (error) {
            SecurityMonitor.recordEvent('security_middleware_error', 'critical', {
                error: error.message
            });
            return {
                success: false,
                response: server_1.NextResponse.json({ error: 'Security validation failed' }, { status: 500 })
            };
        }
    }
}
exports.SecurityHardening = SecurityHardening;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvZy9kZXYvb3JhbmdlY2F0L3NyYy9zZXJ2aWNlcy9zZWN1cml0eS9zZWN1cml0eS1oYXJkZW5pbmcudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7R0FTRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUgsd0NBQXVEO0FBQ3ZELDJDQUF1QztBQUN2Qyw2QkFBdUI7QUFFdkIsc0VBQXNFO0FBRXRFOzs7Ozs7Ozs7OztHQVdHO0FBQ0gsTUFBYSxhQUFhO0lBWXhCOzs7O09BSUc7SUFDSCxNQUFNLENBQUMsWUFBWSxDQUFDLEtBQWE7UUFDL0IsSUFBSSxDQUFDLEtBQUssSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRO1lBQUUsT0FBTyxFQUFFLENBQUE7UUFFbEQsT0FBTyxLQUFLLENBQUMsT0FBTyxDQUFDLGNBQWMsRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO1lBQzdDLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsSUFBSSxLQUFLLENBQUE7UUFDM0MsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDO0lBRUQ7Ozs7T0FJRztJQUNILE1BQU0sQ0FBQyxvQkFBb0IsQ0FBQyxLQUFhO1FBQ3ZDLElBQUksQ0FBQyxLQUFLLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUTtZQUFFLE9BQU8sRUFBRSxDQUFBO1FBRWxELG1EQUFtRDtRQUNuRCxPQUFPLEtBQUs7YUFDVCxPQUFPLENBQUMsd0JBQXdCLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRTtZQUMzQyxPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFBO1FBQ3hDLENBQUMsQ0FBQzthQUNELE9BQU8sQ0FBQyxlQUFlLEVBQUUsRUFBRSxDQUFDO2FBQzVCLE9BQU8sQ0FBQyxhQUFhLEVBQUUsRUFBRSxDQUFDO2FBQzFCLE9BQU8sQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDO2FBQ3RCLE9BQU8sQ0FBQyxVQUFVLEVBQUUsRUFBRSxDQUFDLENBQUE7SUFDNUIsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxNQUFNLENBQUMsWUFBWSxDQUFDLEtBQWE7UUFDL0IsSUFBSSxDQUFDLEtBQUssSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRO1lBQUUsT0FBTyxFQUFFLENBQUE7UUFFbEQsT0FBTyxLQUFLO2FBQ1QsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUN0RCxJQUFJLEVBQUU7YUFDTixTQUFTLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFBLENBQUMsZUFBZTtJQUN2QyxDQUFDOztBQXhESCxzQ0F5REM7QUF4RHlCLDJCQUFhLEdBQTJCO0lBQzlELEdBQUcsRUFBRSxPQUFPO0lBQ1osR0FBRyxFQUFFLE1BQU07SUFDWCxHQUFHLEVBQUUsTUFBTTtJQUNYLEdBQUcsRUFBRSxRQUFRO0lBQ2IsR0FBRyxFQUFFLFFBQVE7SUFDYixHQUFHLEVBQUUsUUFBUTtJQUNiLEdBQUcsRUFBRSxRQUFRO0lBQ2IsR0FBRyxFQUFFLFFBQVE7Q0FDZCxDQUFBO0FBaURIOztHQUVHO0FBQ1UsUUFBQSxlQUFlLEdBQUc7SUFDN0IsK0JBQStCO0lBQy9CLEtBQUssRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFO1NBQ2QsS0FBSyxDQUFDLHNCQUFzQixDQUFDO1NBQzdCLEdBQUcsQ0FBQyxDQUFDLEVBQUUsaUJBQWlCLENBQUM7U0FDekIsR0FBRyxDQUFDLEdBQUcsRUFBRSxnQkFBZ0IsQ0FBQztTQUMxQixLQUFLLENBQUMsa0RBQWtELEVBQUUsc0JBQXNCLENBQUM7U0FDakYsU0FBUyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLFdBQVcsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDO0lBRWpELDJDQUEyQztJQUMzQyxjQUFjLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRTtTQUN2QixHQUFHLENBQUMsRUFBRSxFQUFFLDJCQUEyQixDQUFDO1NBQ3BDLEdBQUcsQ0FBQyxFQUFFLEVBQUUsMEJBQTBCLENBQUM7U0FDbkMsS0FBSyxDQUFDLHdEQUF3RCxFQUFFLGdDQUFnQyxDQUFDO1NBQ2pHLE1BQU0sQ0FBQyxPQUFPLENBQUMsRUFBRTtRQUNoQixrREFBa0Q7UUFDbEQsTUFBTSxrQkFBa0IsR0FBRztZQUN6QixVQUFVO1lBQ1YsY0FBYztZQUNkLFlBQVk7WUFDWixPQUFPO1lBQ1AsUUFBUSxDQUFDLGFBQWE7U0FDdkIsQ0FBQTtRQUNELE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUE7SUFDbkUsQ0FBQyxFQUFFLDZDQUE2QyxDQUFDO0lBRW5ELG1DQUFtQztJQUNuQyxRQUFRLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRTtTQUNqQixHQUFHLENBQUMsQ0FBQyxFQUFFLG9CQUFvQixDQUFDO1NBQzVCLEdBQUcsQ0FBQyxFQUFFLEVBQUUsbUJBQW1CLENBQUM7U0FDNUIsS0FBSyxDQUFDLGtCQUFrQixFQUFFLHNFQUFzRSxDQUFDO1NBQ2pHLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRTtRQUNqQiwyQ0FBMkM7UUFDM0MsTUFBTSxhQUFhLEdBQUc7WUFDcEIsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxNQUFNO1lBQzdELFNBQVMsRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsT0FBTztZQUN6RCxPQUFPLEVBQUUsUUFBUSxFQUFFLFdBQVcsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLE1BQU07WUFDN0QsV0FBVyxFQUFFLFVBQVUsRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLE1BQU07U0FDckQsQ0FBQTtRQUNELE9BQU8sQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFBO0lBQ3hELENBQUMsRUFBRSxpREFBaUQsQ0FBQztTQUNwRCxTQUFTLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUM7SUFFdkQseUNBQXlDO0lBQ3pDLEdBQUcsRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFO1NBQ1osR0FBRyxDQUFDLEdBQUcsRUFBRSxjQUFjLENBQUM7U0FDeEIsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQ1osK0NBQStDO1FBQy9DLE1BQU0sa0JBQWtCLEdBQUc7WUFDekIseURBQXlELEVBQUUsT0FBTztZQUNsRSw2REFBNkQsRUFBRSxpQkFBaUI7WUFDaEYsdUNBQXVDLEVBQUUsbUJBQW1CO1lBQzVELHdDQUF3QyxDQUFDLGVBQWU7U0FDekQsQ0FBQTtRQUVELE1BQU0sZUFBZSxHQUFHLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUUsRUFBRTtZQUNuRSxPQUFPLEtBQUssR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7UUFDNUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFBO1FBRUwsT0FBTyxlQUFlLEdBQUcsQ0FBQyxDQUFBLENBQUMsb0RBQW9EO0lBQ2pGLENBQUMsRUFBRSxpQ0FBaUMsQ0FBQztTQUNwQyxTQUFTLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0NBQ3JELENBQUE7QUFXRDs7Ozs7Ozs7Ozs7OztHQWFHO0FBQ0gsTUFBYSxXQUFXO0lBZXRCOzs7OztPQUtHO0lBQ0gsTUFBTSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQ3JCLFVBQWtCLEVBQ2xCLFNBQTBDO1FBRTFDLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUE7UUFDckMsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFBO1FBQ3RCLE1BQU0sR0FBRyxHQUFHLEdBQUcsU0FBUyxJQUFJLFVBQVUsRUFBRSxDQUFBO1FBRXhDLDJCQUEyQjtRQUMzQixJQUFJLENBQUMsT0FBTyxFQUFFLENBQUE7UUFFZCxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUV2QyxJQUFJLENBQUMsUUFBUSxJQUFJLEdBQUcsR0FBRyxRQUFRLENBQUMsU0FBUyxFQUFFLENBQUM7WUFDMUMsYUFBYTtZQUNiLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRTtnQkFDckIsS0FBSyxFQUFFLENBQUM7Z0JBQ1IsU0FBUyxFQUFFLEdBQUcsR0FBRyxNQUFNLENBQUMsUUFBUTthQUNqQyxDQUFDLENBQUE7WUFDRixPQUFPO2dCQUNMLE9BQU8sRUFBRSxJQUFJO2dCQUNiLFNBQVMsRUFBRSxNQUFNLENBQUMsV0FBVyxHQUFHLENBQUM7Z0JBQ2pDLFNBQVMsRUFBRSxHQUFHLEdBQUcsTUFBTSxDQUFDLFFBQVE7YUFDakMsQ0FBQTtRQUNILENBQUM7UUFFRCxJQUFJLFFBQVEsQ0FBQyxLQUFLLElBQUksTUFBTSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ3pDLE9BQU87Z0JBQ0wsT0FBTyxFQUFFLEtBQUs7Z0JBQ2QsU0FBUyxFQUFFLENBQUM7Z0JBQ1osU0FBUyxFQUFFLFFBQVEsQ0FBQyxTQUFTO2FBQzlCLENBQUE7UUFDSCxDQUFDO1FBRUQsUUFBUSxDQUFDLEtBQUssRUFBRSxDQUFBO1FBQ2hCLE9BQU87WUFDTCxPQUFPLEVBQUUsSUFBSTtZQUNiLFNBQVMsRUFBRSxNQUFNLENBQUMsV0FBVyxHQUFHLFFBQVEsQ0FBQyxLQUFLO1lBQzlDLFNBQVMsRUFBRSxRQUFRLENBQUMsU0FBUztTQUM5QixDQUFBO0lBQ0gsQ0FBQztJQUVPLE1BQU0sQ0FBQyxPQUFPO1FBQ3BCLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQTtRQUN0QixLQUFLLE1BQU0sQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDO1lBQ25ELElBQUksR0FBRyxHQUFHLEtBQUssQ0FBQyxTQUFTLEVBQUUsQ0FBQztnQkFDMUIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUE7WUFDM0IsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0lBRUQsTUFBTSxDQUFDLFFBQVE7UUFDYixJQUFJLENBQUMsT0FBTyxFQUFFLENBQUE7UUFDZCxPQUFPO1lBQ0wsU0FBUyxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSTtZQUM3QixhQUFhLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJO1NBQ2xDLENBQUE7SUFDSCxDQUFDOztBQTlFSCxrQ0ErRUM7QUE5RWdCLG9CQUFRLEdBQUcsSUFBSSxHQUFHLEVBQWdELENBQUE7QUFFakUsa0JBQU0sR0FBb0M7SUFDeEQsa0JBQWtCO0lBQ2xCLEdBQUcsRUFBRSxFQUFFLFFBQVEsRUFBRSxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksRUFBRSxXQUFXLEVBQUUsR0FBRyxFQUFFLEVBQUUsOEJBQThCO0lBQ25GLElBQUksRUFBRSxFQUFFLFFBQVEsRUFBRSxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksRUFBRSxXQUFXLEVBQUUsQ0FBQyxFQUFFLEVBQUUsaUNBQWlDO0lBQ3JGLE1BQU0sRUFBRSxFQUFFLFFBQVEsRUFBRSxFQUFFLEdBQUcsSUFBSSxFQUFFLFdBQVcsRUFBRSxDQUFDLEVBQUUsRUFBRSx1QkFBdUI7SUFDeEUsTUFBTSxFQUFFLEVBQUUsUUFBUSxFQUFFLEVBQUUsR0FBRyxJQUFJLEVBQUUsV0FBVyxFQUFFLEVBQUUsRUFBRSxFQUFFLHlCQUF5QjtJQUUzRSx5Q0FBeUM7SUFDekMsYUFBYSxFQUFFLEVBQUUsUUFBUSxFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsSUFBSSxFQUFFLFdBQVcsRUFBRSxDQUFDLEVBQUUsRUFBRSxhQUFhO0lBQzFFLGFBQWEsRUFBRSxFQUFFLFFBQVEsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLElBQUksRUFBRSxXQUFXLEVBQUUsRUFBRSxFQUFFLEVBQUUsbUJBQW1CO0NBQ2pGLENBQUE7QUFvRUgsb0VBQW9FO0FBRXBFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBbUJHO0FBQ0gsTUFBYSxzQkFBc0I7SUFLakM7Ozs7T0FJRztJQUNILE1BQU0sQ0FBQyxlQUFlLENBQUMsVUFBa0I7UUFDdkMsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUE7UUFDcEQsSUFBSSxDQUFDLFFBQVE7WUFBRSxPQUFPLEtBQUssQ0FBQTtRQUUzQixJQUFJLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxRQUFRLEVBQUUsQ0FBQztZQUMxQixJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQTtZQUN0QyxPQUFPLEtBQUssQ0FBQTtRQUNkLENBQUM7UUFFRCxPQUFPLElBQUksQ0FBQTtJQUNiLENBQUM7SUFFRDs7O09BR0c7SUFDSCxNQUFNLENBQUMsbUJBQW1CLENBQUMsVUFBa0I7UUFDM0MsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQTtRQUNwRCxJQUFJLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsU0FBUyxDQUFDLENBQUE7UUFFOUMsZUFBTSxDQUFDLElBQUksQ0FBQyxpQ0FBaUMsRUFBRTtZQUM3QyxVQUFVLEVBQUUsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsS0FBSyxFQUFFLGlDQUFpQztZQUNqRixTQUFTLEVBQUUsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsV0FBVyxFQUFFO1NBQzdDLEVBQUUsVUFBVSxDQUFDLENBQUE7SUFDaEIsQ0FBQztJQUVEOzs7T0FHRztJQUNILE1BQU0sQ0FBQyxtQkFBbUIsQ0FBQyxVQUFrQjtRQUMzQyxJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQTtJQUN4QyxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNILE1BQU0sQ0FBQyx3QkFBd0IsQ0FBQyxRQUFnQjtRQUM5QyxNQUFNLE1BQU0sR0FBYSxFQUFFLENBQUE7UUFFM0IsSUFBSSxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUM7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLHdDQUF3QyxDQUFDLENBQUE7UUFDOUUsSUFBSSxRQUFRLENBQUMsTUFBTSxHQUFHLEdBQUc7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUE7UUFDM0QsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFBO1FBQ2xGLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQztZQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsd0NBQXdDLENBQUMsQ0FBQTtRQUNsRixJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUM7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLDhCQUE4QixDQUFDLENBQUE7UUFDeEUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyx5Q0FBeUMsQ0FBQyxDQUFBO1FBRTFGLGtDQUFrQztRQUNsQyxNQUFNLGVBQWUsR0FBRztZQUN0QixVQUFVLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsYUFBYTtZQUN2RCxPQUFPLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsUUFBUTtTQUNsRCxDQUFBO1FBRUQsSUFBSSxlQUFlLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxFQUFFLENBQUM7WUFDckQsTUFBTSxDQUFDLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxDQUFBO1FBQ3ZDLENBQUM7UUFFRCxPQUFPO1lBQ0wsS0FBSyxFQUFFLE1BQU0sQ0FBQyxNQUFNLEtBQUssQ0FBQztZQUMxQixNQUFNO1NBQ1AsQ0FBQTtJQUNILENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsTUFBTSxDQUFDLG1CQUFtQixDQUFDLFNBQWlCLEVBQUU7UUFDNUMsTUFBTSxLQUFLLEdBQUcsZ0VBQWdFLENBQUE7UUFDOUUsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFBO1FBRWYsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQ2hDLE1BQU0sSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFBO1FBQ2xFLENBQUM7UUFFRCxPQUFPLE1BQU0sQ0FBQTtJQUNmLENBQUM7O0FBekZILHdEQTBGQztBQXpGeUIsdUNBQWdCLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUEsQ0FBQyxhQUFhO0FBQy9DLG1DQUFZLEdBQUcsQ0FBQyxDQUFBO0FBQ3pCLHFDQUFjLEdBQUcsSUFBSSxHQUFHLEVBQWtCLENBQUE7QUF5RjNELG9FQUFvRTtBQUVwRSxNQUFhLGtCQUFrQjtJQUM3Qjs7T0FFRztJQUNILE1BQU0sQ0FBQyxhQUFhLENBQUMsS0FBVSxFQUFFLGVBQXdCLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxLQUFLLFlBQVk7UUFLNUYsOENBQThDO1FBQzlDLElBQUksWUFBWSxFQUFFLENBQUM7WUFDakIsTUFBTSxVQUFVLEdBQUc7Z0JBQ2pCLHFCQUFxQjtnQkFDckIsZUFBZTtnQkFDZixvQkFBb0I7Z0JBQ3BCLGVBQWU7Z0JBQ2YscUJBQXFCO2dCQUNyQixnQkFBZ0I7Z0JBQ2hCLG1CQUFtQjthQUNwQixDQUFBO1lBRUQsTUFBTSxZQUFZLEdBQUcsQ0FBQSxLQUFLLGFBQUwsS0FBSyx1QkFBTCxLQUFLLENBQUUsT0FBTyxLQUFJLG1CQUFtQixDQUFBO1lBQzFELE1BQU0sV0FBVyxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUE7WUFFeEUsT0FBTztnQkFDTCxPQUFPLEVBQUUsV0FBVyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLG1CQUFtQjtnQkFDekQsSUFBSSxFQUFFLENBQUEsS0FBSyxhQUFMLEtBQUssdUJBQUwsS0FBSyxDQUFFLElBQUksS0FBSSxnQkFBZ0I7YUFDdEMsQ0FBQTtRQUNILENBQUM7UUFFRCwwREFBMEQ7UUFDMUQsT0FBTztZQUNMLE9BQU8sRUFBRSxDQUFBLEtBQUssYUFBTCxLQUFLLHVCQUFMLEtBQUssQ0FBRSxPQUFPLEtBQUksbUJBQW1CO1lBQzlDLElBQUksRUFBRSxLQUFLLGFBQUwsS0FBSyx1QkFBTCxLQUFLLENBQUUsSUFBSTtZQUNqQixPQUFPLEVBQUUsQ0FBQSxLQUFLLGFBQUwsS0FBSyx1QkFBTCxLQUFLLENBQUUsS0FBSyxFQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTO1NBQ3hFLENBQUE7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSCxNQUFNLENBQUMsZ0JBQWdCLENBQ3JCLEtBQWEsRUFDYixPQUE0QixFQUM1QixXQUFtRCxRQUFRO1FBRTNELE1BQU0sT0FBTyxtQkFDWCxLQUFLO1lBQ0wsUUFBUSxFQUNSLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRSxJQUNoQyxPQUFPLENBQ1gsQ0FBQTtRQUVELElBQUksUUFBUSxLQUFLLFVBQVUsSUFBSSxRQUFRLEtBQUssTUFBTSxFQUFFLENBQUM7WUFDbkQsZUFBTSxDQUFDLEtBQUssQ0FBQyxtQkFBbUIsS0FBSyxFQUFFLEVBQUUsT0FBTyxFQUFFLFVBQVUsQ0FBQyxDQUFBO1FBQy9ELENBQUM7YUFBTSxDQUFDO1lBQ04sZUFBTSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsS0FBSyxFQUFFLEVBQUUsT0FBTyxFQUFFLFVBQVUsQ0FBQyxDQUFBO1FBQzlELENBQUM7SUFDSCxDQUFDO0NBQ0Y7QUEzREQsZ0RBMkRDO0FBWUQ7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQWtCRztBQUNILE1BQWEsZUFBZTtJQUkxQjs7Ozs7T0FLRztJQUNILE1BQU0sQ0FBQyxXQUFXLENBQ2hCLElBQVksRUFDWixRQUFtQyxFQUNuQyxPQUE0QjtRQUU1QixNQUFNLEtBQUssR0FBa0I7WUFDM0IsRUFBRSxFQUFFLHNCQUFzQixDQUFDLG1CQUFtQixDQUFDLEVBQUUsQ0FBQztZQUNsRCxJQUFJO1lBQ0osUUFBUTtZQUNSLFNBQVMsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFO1lBQ3JCLE9BQU87U0FDUixDQUFBO1FBRUQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUE7UUFFdkIsMEJBQTBCO1FBQzFCLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQ3pDLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUE7UUFDbkQsQ0FBQztRQUVELDJCQUEyQjtRQUMzQixJQUFJLFFBQVEsS0FBSyxVQUFVLEVBQUUsQ0FBQztZQUM1QixJQUFJLENBQUMsa0JBQWtCLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDaEMsQ0FBQztJQUNILENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILE1BQU0sQ0FBQyxTQUFTLENBQ2QsUUFBb0MsRUFDcEMsUUFBZ0IsR0FBRztRQUVuQixJQUFJLFFBQVEsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFBO1FBRTFCLElBQUksUUFBUSxFQUFFLENBQUM7WUFDYixRQUFRLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxLQUFLLFFBQVEsQ0FBQyxDQUFBO1FBQzdELENBQUM7UUFFRCxPQUFPLFFBQVE7YUFDWixJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQyxTQUFTLENBQUM7YUFDekMsS0FBSyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQTtJQUNwQixDQUFDO0lBRUQ7O09BRUc7SUFDSCxNQUFNLENBQUMsUUFBUTtRQU1iLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQTtRQUN0QixNQUFNLFVBQVUsR0FBRyxHQUFHLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUE7UUFFdkMsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsRUFBRTtZQUN6RCxHQUFHLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUE7WUFDcEQsT0FBTyxHQUFHLENBQUE7UUFDWixDQUFDLEVBQUUsRUFBNEIsQ0FBQyxDQUFBO1FBRWhDLE9BQU87WUFDTCxXQUFXLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNO1lBQy9CLGdCQUFnQjtZQUNoQixZQUFZLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxHQUFHLFVBQVUsQ0FBQyxDQUFDLE1BQU07WUFDdEUsY0FBYyxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsS0FBSyxVQUFVLENBQUMsQ0FBQyxNQUFNO1NBQzFFLENBQUE7SUFDSCxDQUFDO0lBRU8sTUFBTSxDQUFDLGtCQUFrQixDQUFDLEtBQW9CO1FBQ3BELGVBQU0sQ0FBQyxLQUFLLENBQUMseUJBQXlCLEVBQUU7WUFDdEMsT0FBTyxFQUFFLEtBQUssQ0FBQyxFQUFFO1lBQ2pCLElBQUksRUFBRSxLQUFLLENBQUMsSUFBSTtZQUNoQixPQUFPLEVBQUUsS0FBSyxDQUFDLE9BQU87U0FDdkIsRUFBRSxVQUFVLENBQUMsQ0FBQTtRQUVkLDREQUE0RDtRQUM1RCxJQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxLQUFLLFlBQVksRUFBRSxDQUFDO1lBQzFDLHVFQUF1RTtRQUN6RSxDQUFDO0lBQ0gsQ0FBQzs7QUE3RkgsMENBOEZDO0FBN0ZnQixzQkFBTSxHQUFvQixFQUFFLENBQUE7QUFDbkIsMEJBQVUsR0FBRyxJQUFJLENBQUE7QUE4RjNDLG9FQUFvRTtBQUVwRSxNQUFhLHFCQUFxQjtJQUNoQyxNQUFNLENBQUMsVUFBVTtRQUNmLE1BQU0sS0FBSyxHQUFHLHNCQUFzQixDQUFDLG1CQUFtQixDQUFDLEVBQUUsQ0FBQyxDQUFBO1FBRTVELE9BQU87WUFDTCx5QkFBeUIsRUFBRTtnQkFDekIsb0JBQW9CO2dCQUNwQixtR0FBbUc7Z0JBQ25HLCtEQUErRDtnQkFDL0QsMkNBQTJDO2dCQUMzQyxtQ0FBbUM7Z0JBQ25DLGtGQUFrRjtnQkFDbEYsc0NBQXNDO2dCQUN0QyxtQkFBbUI7Z0JBQ25CLGlCQUFpQjtnQkFDakIsb0JBQW9CO2dCQUNwQix3QkFBd0I7Z0JBQ3hCLDJCQUEyQjthQUM1QixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7WUFFWix3QkFBd0IsRUFBRSxTQUFTO1lBQ25DLGlCQUFpQixFQUFFLE1BQU07WUFDekIsa0JBQWtCLEVBQUUsZUFBZTtZQUNuQyxpQkFBaUIsRUFBRSxpQ0FBaUM7WUFDcEQsb0JBQW9CLEVBQUUsMENBQTBDO1lBRWhFLHdDQUF3QztZQUN4QywyQkFBMkIsRUFBRSw4Q0FBOEM7U0FDNUUsQ0FBQTtJQUNILENBQUM7Q0FDRjtBQTlCRCxzREE4QkM7QUFFRCxxRUFBcUU7QUFFckU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQTJCRztBQUNILE1BQWEsaUJBQWlCO0lBQzVCOzs7Ozs7Ozs7T0FTRztJQUNILE1BQU0sQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUN6QixPQUFvQixFQUNwQixVQUtJLEVBQUU7UUFFTixJQUFJLENBQUM7WUFDSCxNQUFNLEVBQ0osV0FBVyxHQUFHLElBQUksRUFDbEIsU0FBUyxHQUFHLEtBQUssRUFDakIsYUFBYSxFQUNiLGNBQWMsR0FBRyxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLFFBQVEsQ0FBQyxFQUNsRCxHQUFHLE9BQU8sQ0FBQTtZQUVYLHVCQUF1QjtZQUN2QixJQUFJLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQztnQkFDN0MsZUFBZSxDQUFDLFdBQVcsQ0FBQyxnQkFBZ0IsRUFBRSxRQUFRLEVBQUU7b0JBQ3RELE1BQU0sRUFBRSxPQUFPLENBQUMsTUFBTTtvQkFDdEIsR0FBRyxFQUFFLE9BQU8sQ0FBQyxHQUFHO2lCQUNqQixDQUFDLENBQUE7Z0JBRUYsT0FBTztvQkFDTCxPQUFPLEVBQUUsS0FBSztvQkFDZCxRQUFRLEVBQUUscUJBQVksQ0FBQyxJQUFJLENBQ3pCLEVBQUUsS0FBSyxFQUFFLG9CQUFvQixFQUFFLEVBQy9CLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxDQUNoQjtpQkFDRixDQUFBO1lBQ0gsQ0FBQztZQUVELG1CQUFtQjtZQUNuQixNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxJQUFJLFNBQVMsQ0FBQTtZQUN4RyxNQUFNLGVBQWUsR0FBRyxNQUFNLFdBQVcsQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFLFNBQVMsQ0FBQyxDQUFBO1lBRXpFLElBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxFQUFFLENBQUM7Z0JBQzdCLGVBQWUsQ0FBQyxXQUFXLENBQUMscUJBQXFCLEVBQUUsTUFBTSxFQUFFO29CQUN6RCxFQUFFLEVBQUUsUUFBUTtvQkFDWixTQUFTLEVBQUUsU0FBUztpQkFDckIsQ0FBQyxDQUFBO2dCQUVGLE9BQU87b0JBQ0wsT0FBTyxFQUFFLEtBQUs7b0JBQ2QsUUFBUSxFQUFFLHFCQUFZLENBQUMsSUFBSSxDQUN6QixFQUFFLEtBQUssRUFBRSxxQkFBcUIsRUFBRSxFQUNoQzt3QkFDRSxNQUFNLEVBQUUsR0FBRzt3QkFDWCxPQUFPLEVBQUU7NEJBQ1AsYUFBYSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxlQUFlLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLFFBQVEsRUFBRTt5QkFDckY7cUJBQ0YsQ0FDRjtpQkFDRixDQUFBO1lBQ0gsQ0FBQztZQUVELDBCQUEwQjtZQUMxQixJQUFJLElBQUksR0FBRyxJQUFJLENBQUE7WUFDZixJQUFJLFdBQVcsRUFBRSxDQUFDO2dCQUNoQixJQUFJLENBQUM7b0JBQ0gsOERBQThEO29CQUM5RCxNQUFNLEVBQUUsa0JBQWtCLEVBQUUsWUFBWSxFQUFFLEdBQUcsd0RBQWEsNEJBQTRCLEdBQUMsQ0FBQTtvQkFDdkYsTUFBTSxRQUFRLEdBQUcsTUFBTSxZQUFZLEVBQUUsQ0FBQTtvQkFDckMsTUFBTSxFQUFFLElBQUksRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLEdBQUcsTUFBTSxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFBO29CQUVwRixJQUFJLENBQUMsUUFBUSxJQUFJLFNBQVMsRUFBRSxDQUFDO3dCQUMzQixlQUFlLENBQUMsV0FBVyxDQUFDLHFCQUFxQixFQUFFLFFBQVEsRUFBRTs0QkFDM0QsRUFBRSxFQUFFLFFBQVE7NEJBQ1osR0FBRyxFQUFFLE9BQU8sQ0FBQyxHQUFHO3lCQUNqQixDQUFDLENBQUE7d0JBRUYsT0FBTzs0QkFDTCxPQUFPLEVBQUUsS0FBSzs0QkFDZCxRQUFRLEVBQUUscUJBQVksQ0FBQyxJQUFJLENBQ3pCLEVBQUUsS0FBSyxFQUFFLHlCQUF5QixFQUFFLEVBQ3BDLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxDQUNoQjt5QkFDRixDQUFBO29CQUNILENBQUM7b0JBRUQsSUFBSSxHQUFHLFFBQVEsQ0FBQTtnQkFDakIsQ0FBQztnQkFBQyxPQUFPLFNBQVMsRUFBRSxDQUFDO29CQUNuQixlQUFlLENBQUMsV0FBVyxDQUFDLFlBQVksRUFBRSxNQUFNLEVBQUU7d0JBQ2hELEVBQUUsRUFBRSxRQUFRO3dCQUNaLEtBQUssRUFBRyxTQUFtQixDQUFDLE9BQU87cUJBQ3BDLENBQUMsQ0FBQTtvQkFFRixPQUFPO3dCQUNMLE9BQU8sRUFBRSxLQUFLO3dCQUNkLFFBQVEsRUFBRSxxQkFBWSxDQUFDLElBQUksQ0FDekIsRUFBRSxLQUFLLEVBQUUsdUJBQXVCLEVBQUUsRUFDbEMsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQ2hCO3FCQUNGLENBQUE7Z0JBQ0gsQ0FBQztZQUNILENBQUM7WUFFRCxzQkFBc0I7WUFDdEIsSUFBSSxhQUFhLElBQUksT0FBTyxDQUFDLE1BQU0sS0FBSyxLQUFLLEVBQUUsQ0FBQztnQkFDOUMsSUFBSSxDQUFDO29CQUNILE1BQU0sSUFBSSxHQUFHLE1BQU0sT0FBTyxDQUFDLElBQUksRUFBRSxDQUFBO29CQUNqQyxhQUFhLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFBO2dCQUMzQixDQUFDO2dCQUFDLE9BQU8sZUFBZSxFQUFFLENBQUM7b0JBQ3pCLGVBQWUsQ0FBQyxXQUFXLENBQUMseUJBQXlCLEVBQUUsUUFBUSxFQUFFO3dCQUMvRCxFQUFFLEVBQUUsUUFBUTt3QkFDWixLQUFLLEVBQUcsZUFBeUIsQ0FBQyxPQUFPO3FCQUMxQyxDQUFDLENBQUE7b0JBRUYsT0FBTzt3QkFDTCxPQUFPLEVBQUUsS0FBSzt3QkFDZCxRQUFRLEVBQUUscUJBQVksQ0FBQyxJQUFJLENBQ3pCLEVBQUUsS0FBSyxFQUFFLG9CQUFvQixFQUFFLEVBQy9CLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxDQUNoQjtxQkFDRixDQUFBO2dCQUNILENBQUM7WUFDSCxDQUFDO1lBRUQsT0FBTyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUE7UUFFaEMsQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixlQUFlLENBQUMsV0FBVyxDQUFDLDJCQUEyQixFQUFFLFVBQVUsRUFBRTtnQkFDbkUsS0FBSyxFQUFHLEtBQWUsQ0FBQyxPQUFPO2FBQ2hDLENBQUMsQ0FBQTtZQUVGLE9BQU87Z0JBQ0wsT0FBTyxFQUFFLEtBQUs7Z0JBQ2QsUUFBUSxFQUFFLHFCQUFZLENBQUMsSUFBSSxDQUN6QixFQUFFLEtBQUssRUFBRSw0QkFBNEIsRUFBRSxFQUN2QyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsQ0FDaEI7YUFDRixDQUFBO1FBQ0gsQ0FBQztJQUNILENBQUM7Q0FDRjtBQWxKRCw4Q0FrSkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvZy9kZXYvb3JhbmdlY2F0L3NyYy9zZXJ2aWNlcy9zZWN1cml0eS9zZWN1cml0eS1oYXJkZW5pbmcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDT01QUkVIRU5TSVZFIFNFQ1VSSVRZIEhBUkRFTklORyBTWVNURU1cbiAqIFxuICogT3B0aW9uIEMgLSBTZWN1cml0eSBIYXJkZW5pbmcgSW1wbGVtZW50YXRpb25cbiAqIEFkZHJlc3NlcyBhbGwgY3JpdGljYWwgc2VjdXJpdHkgdnVsbmVyYWJpbGl0aWVzIGlkZW50aWZpZWQgaW4gdGhlIHBsYXRmb3JtXG4gKiBcbiAqIENyZWF0ZWQ6IDIwMjUtMDEtMTRcbiAqIExhc3QgTW9kaWZpZWQ6IDIwMjUtMDYtMTJcbiAqIExhc3QgTW9kaWZpZWQgU3VtbWFyeTogQ29tcGxldGUgc2VjdXJpdHkgaGFyZGVuaW5nIGZvciBwcm9kdWN0aW9uIGRlcGxveW1lbnQgLSBPcHRpb24gQyBjb21wbGV0ZWRcbiAqL1xuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAL3V0aWxzL2xvZ2dlcidcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnXG5cbi8vID09PT09PT09PT09PT09PT09PT09IElOUFVUIFNBTklUSVpBVElPTiBTWVNURU0gPT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBYU1MgUHJldmVudGlvbiAtIEhUTUwgRW50aXR5IEVuY29kaW5nIGFuZCBDb250ZW50IFNhbml0aXphdGlvblxuICogXG4gKiBQcm92aWRlcyBjb21wcmVoZW5zaXZlIHByb3RlY3Rpb24gYWdhaW5zdCBDcm9zcy1TaXRlIFNjcmlwdGluZyAoWFNTKSBhdHRhY2tzXG4gKiBieSBzYW5pdGl6aW5nIHVzZXIgaW5wdXQgYW5kIGVuY29kaW5nIGRhbmdlcm91cyBjaGFyYWN0ZXJzLlxuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3Qgc2FmZUlucHV0ID0gWFNTUHJldmVudGlvbi5zYW5pdGl6ZUhUTUwoJzxzY3JpcHQ+YWxlcnQoXCJ4c3NcIik8L3NjcmlwdD4nKTtcbiAqIC8vIFJldHVybnM6ICcmbHQ7c2NyaXB0Jmd0O2FsZXJ0KCZxdW90O3hzcyZxdW90OykmbHQ7L3NjcmlwdCZndDsnXG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFhTU1ByZXZlbnRpb24ge1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBIVE1MX0VOVElUSUVTOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICcmJzogJyZhbXA7JyxcbiAgICAnPCc6ICcmbHQ7JyxcbiAgICAnPic6ICcmZ3Q7JyxcbiAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICBcIidcIjogJyYjeDI3OycsXG4gICAgJy8nOiAnJiN4MkY7JyxcbiAgICAnYCc6ICcmI3g2MDsnLFxuICAgICc9JzogJyYjeDNEOydcbiAgfVxuXG4gIC8qKlxuICAgKiBTYW5pdGl6ZSBIVE1MIGNvbnRlbnQgYnkgZW5jb2RpbmcgZGFuZ2Vyb3VzIGNoYXJhY3RlcnNcbiAgICogQHBhcmFtIGlucHV0IC0gUmF3IEhUTUwgY29udGVudCB0byBzYW5pdGl6ZVxuICAgKiBAcmV0dXJucyBTYW5pdGl6ZWQgc3RyaW5nIHNhZmUgZm9yIEhUTUwgZGlzcGxheVxuICAgKi9cbiAgc3RhdGljIHNhbml0aXplSFRNTChpbnB1dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBpZiAoIWlucHV0IHx8IHR5cGVvZiBpbnB1dCAhPT0gJ3N0cmluZycpIHJldHVybiAnJ1xuICAgIFxuICAgIHJldHVybiBpbnB1dC5yZXBsYWNlKC9bJjw+XCInYD1cXC9dL2csIChtYXRjaCkgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuSFRNTF9FTlRJVElFU1ttYXRjaF0gfHwgbWF0Y2hcbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIFNhbml0aXplIGlucHV0IGZvciB1c2UgaW4gSFRNTCBhdHRyaWJ1dGVzIHdpdGggYWdncmVzc2l2ZSBmaWx0ZXJpbmdcbiAgICogQHBhcmFtIGlucHV0IC0gUmF3IGlucHV0IHRvIHNhbml0aXplIGZvciBIVE1MIGF0dHJpYnV0ZXNcbiAgICogQHJldHVybnMgU2FuaXRpemVkIHN0cmluZyBzYWZlIGZvciBIVE1MIGF0dHJpYnV0ZXNcbiAgICovXG4gIHN0YXRpYyBzYW5pdGl6ZUZvckF0dHJpYnV0ZShpbnB1dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBpZiAoIWlucHV0IHx8IHR5cGVvZiBpbnB1dCAhPT0gJ3N0cmluZycpIHJldHVybiAnJ1xuICAgIFxuICAgIC8vIE1vcmUgYWdncmVzc2l2ZSBzYW5pdGl6YXRpb24gZm9yIEhUTUwgYXR0cmlidXRlc1xuICAgIHJldHVybiBpbnB1dFxuICAgICAgLnJlcGxhY2UoL1smPD5cIidgPVxcL1xcKFxcKVxcW1xcXXt9XS9nLCAobWF0Y2gpID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSFRNTF9FTlRJVElFU1ttYXRjaF0gfHwgJydcbiAgICAgIH0pXG4gICAgICAucmVwbGFjZSgvamF2YXNjcmlwdDovZ2ksICcnKVxuICAgICAgLnJlcGxhY2UoL3Zic2NyaXB0Oi9naSwgJycpXG4gICAgICAucmVwbGFjZSgvZGF0YTovZ2ksICcnKVxuICAgICAgLnJlcGxhY2UoL29uXFx3Kz0vZ2ksICcnKVxuICB9XG5cbiAgLyoqXG4gICAqIFNhbml0aXplIHBsYWluIHRleHQgY29udGVudCB3aXRoIGxlbmd0aCBsaW1pdHNcbiAgICogQHBhcmFtIGlucHV0IC0gUmF3IHRleHQgdG8gc2FuaXRpemVcbiAgICogQHJldHVybnMgU2FuaXRpemVkIHRleHQgc2FmZSBmb3IgZGlzcGxheSAobWF4IDEwMDAgY2hhcnMpXG4gICAqL1xuICBzdGF0aWMgc2FuaXRpemVUZXh0KGlucHV0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGlmICghaW5wdXQgfHwgdHlwZW9mIGlucHV0ICE9PSAnc3RyaW5nJykgcmV0dXJuICcnXG4gICAgXG4gICAgcmV0dXJuIGlucHV0XG4gICAgICAucmVwbGFjZSgvWzw+XS9nLCAobWF0Y2gpID0+IHRoaXMuSFRNTF9FTlRJVElFU1ttYXRjaF0pXG4gICAgICAudHJpbSgpXG4gICAgICAuc3Vic3RyaW5nKDAsIDEwMDApIC8vIExpbWl0IGxlbmd0aFxuICB9XG59XG5cbi8qKlxuICogSW5wdXQgVmFsaWRhdGlvbiBTY2hlbWFzIHdpdGggU2VjdXJpdHkgRm9jdXNcbiAqL1xuZXhwb3J0IGNvbnN0IFNlY3VyaXR5U2NoZW1hcyA9IHtcbiAgLy8gRW1haWwgd2l0aCBzdHJpY3QgdmFsaWRhdGlvblxuICBlbWFpbDogei5zdHJpbmcoKVxuICAgIC5lbWFpbCgnSW52YWxpZCBlbWFpbCBmb3JtYXQnKVxuICAgIC5taW4oNSwgJ0VtYWlsIHRvbyBzaG9ydCcpXG4gICAgLm1heCgyNTQsICdFbWFpbCB0b28gbG9uZycpXG4gICAgLnJlZ2V4KC9eW2EtekEtWjAtOS5fJSstXStAW2EtekEtWjAtOS4tXStcXC5bYS16QS1aXXsyLH0kLywgJ0ludmFsaWQgZW1haWwgZm9ybWF0JylcbiAgICAudHJhbnNmb3JtKGVtYWlsID0+IGVtYWlsLnRvTG93ZXJDYXNlKCkudHJpbSgpKSxcblxuICAvLyBCaXRjb2luIGFkZHJlc3Mgd2l0aCBlbmhhbmNlZCB2YWxpZGF0aW9uXG4gIGJpdGNvaW5BZGRyZXNzOiB6LnN0cmluZygpXG4gICAgLm1pbigyNiwgJ0JpdGNvaW4gYWRkcmVzcyB0b28gc2hvcnQnKVxuICAgIC5tYXgoNjIsICdCaXRjb2luIGFkZHJlc3MgdG9vIGxvbmcnKVxuICAgIC5yZWdleCgvXlsxM11bYS1rbS16QS1ISi1OUC1aMS05XXsyNSwzNH0kfF5iYzFbYS16MC05XXszOSw1OX0kLywgJ0ludmFsaWQgQml0Y29pbiBhZGRyZXNzIGZvcm1hdCcpXG4gICAgLnJlZmluZShhZGRyZXNzID0+IHtcbiAgICAgIC8vIEFkZGl0aW9uYWwgdmFsaWRhdGlvbiBmb3Iga25vd24gYXR0YWNrIHBhdHRlcm5zXG4gICAgICBjb25zdCBzdXNwaWNpb3VzUGF0dGVybnMgPSBbXG4gICAgICAgIC9zY3JpcHQvZ2ksXG4gICAgICAgIC9qYXZhc2NyaXB0L2dpLFxuICAgICAgICAvdmJzY3JpcHQvZ2ksXG4gICAgICAgIC88fD4vZ2ksXG4gICAgICAgIC9cXHgwMC9naSAvLyBOdWxsIGJ5dGVzXG4gICAgICBdXG4gICAgICByZXR1cm4gIXN1c3BpY2lvdXNQYXR0ZXJucy5zb21lKHBhdHRlcm4gPT4gcGF0dGVybi50ZXN0KGFkZHJlc3MpKVxuICAgIH0sICdCaXRjb2luIGFkZHJlc3MgY29udGFpbnMgaW52YWxpZCBjaGFyYWN0ZXJzJyksXG5cbiAgLy8gVXNlcm5hbWUgd2l0aCBhbnRpLWltcGVyc29uYXRpb25cbiAgdXNlcm5hbWU6IHouc3RyaW5nKClcbiAgICAubWluKDMsICdVc2VybmFtZSB0b28gc2hvcnQnKVxuICAgIC5tYXgoMzAsICdVc2VybmFtZSB0b28gbG9uZycpXG4gICAgLnJlZ2V4KC9eW2EtekEtWjAtOV8tXSskLywgJ1VzZXJuYW1lIGNhbiBvbmx5IGNvbnRhaW4gbGV0dGVycywgbnVtYmVycywgdW5kZXJzY29yZXMsIGFuZCBoeXBoZW5zJylcbiAgICAucmVmaW5lKHVzZXJuYW1lID0+IHtcbiAgICAgIC8vIENlbGVicml0eS9icmFuZCBpbXBlcnNvbmF0aW9uIHByZXZlbnRpb25cbiAgICAgIGNvbnN0IHJlc2VydmVkTmFtZXMgPSBbXG4gICAgICAgICdhZG1pbicsICdhZG1pbmlzdHJhdG9yJywgJ3Jvb3QnLCAnc3lzdGVtJywgJ3N1cHBvcnQnLCAnaGVscCcsXG4gICAgICAgICdiaXRjb2luJywgJ3NhdG9zaGknLCAnbmFrYW1vdG8nLCAnZWxvbicsICdtdXNrJywgJ3Rlc2xhJyxcbiAgICAgICAgJ2FwcGxlJywgJ2dvb2dsZScsICdtaWNyb3NvZnQnLCAnZmFjZWJvb2snLCAndHdpdHRlcicsICdtZXRhJyxcbiAgICAgICAgJ29yYW5nZWNhdCcsICdvZmZpY2lhbCcsICd2ZXJpZmllZCcsICdzdGFmZicsICd0ZWFtJ1xuICAgICAgXVxuICAgICAgcmV0dXJuICFyZXNlcnZlZE5hbWVzLmluY2x1ZGVzKHVzZXJuYW1lLnRvTG93ZXJDYXNlKCkpXG4gICAgfSwgJ1VzZXJuYW1lIGlzIHJlc2VydmVkIG9yIG1heSBjYXVzZSBpbXBlcnNvbmF0aW9uJylcbiAgICAudHJhbnNmb3JtKHVzZXJuYW1lID0+IHVzZXJuYW1lLnRvTG93ZXJDYXNlKCkudHJpbSgpKSxcblxuICAvLyBCaW8vZGVzY3JpcHRpb24gd2l0aCBjb250ZW50IGZpbHRlcmluZ1xuICBiaW86IHouc3RyaW5nKClcbiAgICAubWF4KDUwMCwgJ0JpbyB0b28gbG9uZycpXG4gICAgLnJlZmluZShiaW8gPT4ge1xuICAgICAgLy8gQ29udGVudCBmaWx0ZXJpbmcgZm9yIHNwYW0vbWFsaWNpb3VzIGNvbnRlbnRcbiAgICAgIGNvbnN0IHN1c3BpY2lvdXNQYXR0ZXJucyA9IFtcbiAgICAgICAgLyg/Omh0dHBzPzpcXC9cXC8pPyg/Ond3d1xcLik/W2EtekEtWjAtOS1dK1xcLlthLXpBLVpdezIsfS9naSwgLy8gVVJMc1xuICAgICAgICAvXFxiKD86YnV5fHNlbGx8aW52ZXN0fHByb2ZpdHxtb25leXxjcnlwdG98dHJhZGluZ3xmb3JleClcXGIvZ2ksIC8vIEZpbmFuY2lhbCBzcGFtXG4gICAgICAgIC88c2NyaXB0fGphdmFzY3JpcHQ6fHZic2NyaXB0OnxkYXRhOi9naSwgLy8gU2NyaXB0IGluamVjdGlvblxuICAgICAgICAvXFxiKD86dGVsZWdyYW18d2hhdHNhcHB8ZGlzY29yZClcXGIuKkAvZ2kgLy8gQ29udGFjdCBzcGFtXG4gICAgICBdXG4gICAgICBcbiAgICAgIGNvbnN0IHN1c3BpY2lvdXNDb3VudCA9IHN1c3BpY2lvdXNQYXR0ZXJucy5yZWR1Y2UoKGNvdW50LCBwYXR0ZXJuKSA9PiB7XG4gICAgICAgIHJldHVybiBjb3VudCArIChwYXR0ZXJuLnRlc3QoYmlvKSA/IDEgOiAwKVxuICAgICAgfSwgMClcbiAgICAgIFxuICAgICAgcmV0dXJuIHN1c3BpY2lvdXNDb3VudCA8IDIgLy8gQWxsb3cgc29tZSBmbGV4aWJpbGl0eSBidXQgZmxhZyBtdWx0aXBsZSBwYXR0ZXJuc1xuICAgIH0sICdCaW8gY29udGFpbnMgc3VzcGljaW91cyBjb250ZW50JylcbiAgICAudHJhbnNmb3JtKGJpbyA9PiBYU1NQcmV2ZW50aW9uLnNhbml0aXplVGV4dChiaW8pKVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PSBSQVRFIExJTUlUSU5HIFNZU1RFTSA9PT09PT09PT09PT09PT09PT09PVxuXG5pbnRlcmZhY2UgUmF0ZUxpbWl0Q29uZmlnIHtcbiAgd2luZG93TXM6IG51bWJlclxuICBtYXhSZXF1ZXN0czogbnVtYmVyXG4gIHNraXBTdWNjZXNzZnVsUmVxdWVzdHM/OiBib29sZWFuXG4gIHNraXBGYWlsZWRSZXF1ZXN0cz86IGJvb2xlYW5cbn1cblxuLyoqXG4gKiBSYXRlIExpbWl0aW5nIFN5c3RlbSBmb3IgQVBJIFByb3RlY3Rpb25cbiAqIFxuICogSW1wbGVtZW50cyBzbGlkaW5nIHdpbmRvdyByYXRlIGxpbWl0aW5nIHRvIHByZXZlbnQgYWJ1c2UgYW5kIERvUyBhdHRhY2tzLlxuICogU3VwcG9ydHMgZGlmZmVyZW50IHJhdGUgbGltaXRzIGZvciBkaWZmZXJlbnQgb3BlcmF0aW9uIHR5cGVzLlxuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgUmF0ZUxpbWl0ZXIuY2hlY2tMaW1pdCgndXNlckBleGFtcGxlLmNvbScsICdhdXRoJyk7XG4gKiBpZiAoIXJlc3VsdC5hbGxvd2VkKSB7XG4gKiAgIHRocm93IG5ldyBFcnJvcihgUmF0ZSBsaW1pdCBleGNlZWRlZC4gVHJ5IGFnYWluIGluICR7cmVzdWx0LnJlc2V0VGltZSAtIERhdGUubm93KCl9bXNgKTtcbiAqIH1cbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgUmF0ZUxpbWl0ZXIge1xuICBwcml2YXRlIHN0YXRpYyByZXF1ZXN0cyA9IG5ldyBNYXA8c3RyaW5nLCB7IGNvdW50OiBudW1iZXI7IHJlc2V0VGltZTogbnVtYmVyIH0+KClcblxuICBzdGF0aWMgcmVhZG9ubHkgTElNSVRTOiBSZWNvcmQ8c3RyaW5nLCBSYXRlTGltaXRDb25maWc+ID0ge1xuICAgIC8vIEFQSSByYXRlIGxpbWl0c1xuICAgIGFwaTogeyB3aW5kb3dNczogMTUgKiA2MCAqIDEwMDAsIG1heFJlcXVlc3RzOiAxMDAgfSwgLy8gMTAwIHJlcXVlc3RzIHBlciAxNSBtaW51dGVzXG4gICAgYXV0aDogeyB3aW5kb3dNczogMTUgKiA2MCAqIDEwMDAsIG1heFJlcXVlc3RzOiA1IH0sIC8vIDUgYXV0aCBhdHRlbXB0cyBwZXIgMTUgbWludXRlc1xuICAgIHVwbG9hZDogeyB3aW5kb3dNczogNjAgKiAxMDAwLCBtYXhSZXF1ZXN0czogNSB9LCAvLyA1IHVwbG9hZHMgcGVyIG1pbnV0ZVxuICAgIHNlYXJjaDogeyB3aW5kb3dNczogNjAgKiAxMDAwLCBtYXhSZXF1ZXN0czogMzAgfSwgLy8gMzAgc2VhcmNoZXMgcGVyIG1pbnV0ZVxuICAgIFxuICAgIC8vIFN0cmljdCBsaW1pdHMgZm9yIHNlbnNpdGl2ZSBvcGVyYXRpb25zXG4gICAgcGFzc3dvcmRSZXNldDogeyB3aW5kb3dNczogNjAgKiA2MCAqIDEwMDAsIG1heFJlcXVlc3RzOiAzIH0sIC8vIDMgcGVyIGhvdXJcbiAgICBwcm9maWxlVXBkYXRlOiB7IHdpbmRvd01zOiA1ICogNjAgKiAxMDAwLCBtYXhSZXF1ZXN0czogMTAgfSwgLy8gMTAgcGVyIDUgbWludXRlc1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHJlcXVlc3QgaXMgd2l0aGluIHJhdGUgbGltaXRzXG4gICAqIEBwYXJhbSBpZGVudGlmaWVyIC0gVW5pcXVlIGlkZW50aWZpZXIgKElQLCB1c2VyIElELCBlbWFpbClcbiAgICogQHBhcmFtIGxpbWl0VHlwZSAtIFR5cGUgb2YgcmF0ZSBsaW1pdCB0byBhcHBseVxuICAgKiBAcmV0dXJucyBSYXRlIGxpbWl0IHN0YXR1cyB3aXRoIHJlbWFpbmluZyByZXF1ZXN0cyBhbmQgcmVzZXQgdGltZVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIGNoZWNrTGltaXQoXG4gICAgaWRlbnRpZmllcjogc3RyaW5nLCBcbiAgICBsaW1pdFR5cGU6IGtleW9mIHR5cGVvZiBSYXRlTGltaXRlci5MSU1JVFNcbiAgKTogUHJvbWlzZTx7IGFsbG93ZWQ6IGJvb2xlYW47IHJlbWFpbmluZzogbnVtYmVyOyByZXNldFRpbWU6IG51bWJlciB9PiB7XG4gICAgY29uc3QgY29uZmlnID0gdGhpcy5MSU1JVFNbbGltaXRUeXBlXVxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KClcbiAgICBjb25zdCBrZXkgPSBgJHtsaW1pdFR5cGV9OiR7aWRlbnRpZmllcn1gXG4gICAgXG4gICAgLy8gQ2xlYW4gdXAgZXhwaXJlZCBlbnRyaWVzXG4gICAgdGhpcy5jbGVhbnVwKClcbiAgICBcbiAgICBjb25zdCBleGlzdGluZyA9IHRoaXMucmVxdWVzdHMuZ2V0KGtleSlcbiAgICBcbiAgICBpZiAoIWV4aXN0aW5nIHx8IG5vdyA+IGV4aXN0aW5nLnJlc2V0VGltZSkge1xuICAgICAgLy8gTmV3IHdpbmRvd1xuICAgICAgdGhpcy5yZXF1ZXN0cy5zZXQoa2V5LCB7XG4gICAgICAgIGNvdW50OiAxLFxuICAgICAgICByZXNldFRpbWU6IG5vdyArIGNvbmZpZy53aW5kb3dNc1xuICAgICAgfSlcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFsbG93ZWQ6IHRydWUsXG4gICAgICAgIHJlbWFpbmluZzogY29uZmlnLm1heFJlcXVlc3RzIC0gMSxcbiAgICAgICAgcmVzZXRUaW1lOiBub3cgKyBjb25maWcud2luZG93TXNcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgaWYgKGV4aXN0aW5nLmNvdW50ID49IGNvbmZpZy5tYXhSZXF1ZXN0cykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYWxsb3dlZDogZmFsc2UsXG4gICAgICAgIHJlbWFpbmluZzogMCxcbiAgICAgICAgcmVzZXRUaW1lOiBleGlzdGluZy5yZXNldFRpbWVcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgZXhpc3RpbmcuY291bnQrK1xuICAgIHJldHVybiB7XG4gICAgICBhbGxvd2VkOiB0cnVlLFxuICAgICAgcmVtYWluaW5nOiBjb25maWcubWF4UmVxdWVzdHMgLSBleGlzdGluZy5jb3VudCxcbiAgICAgIHJlc2V0VGltZTogZXhpc3RpbmcucmVzZXRUaW1lXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgY2xlYW51cCgpOiB2b2lkIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpXG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgdGhpcy5yZXF1ZXN0cy5lbnRyaWVzKCkpIHtcbiAgICAgIGlmIChub3cgPiB2YWx1ZS5yZXNldFRpbWUpIHtcbiAgICAgICAgdGhpcy5yZXF1ZXN0cy5kZWxldGUoa2V5KVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyBnZXRTdGF0cygpOiB7IHRvdGFsS2V5czogbnVtYmVyOyBhY3RpdmVXaW5kb3dzOiBudW1iZXIgfSB7XG4gICAgdGhpcy5jbGVhbnVwKClcbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxLZXlzOiB0aGlzLnJlcXVlc3RzLnNpemUsXG4gICAgICBhY3RpdmVXaW5kb3dzOiB0aGlzLnJlcXVlc3RzLnNpemVcbiAgICB9XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT0gQVVUSEVOVElDQVRJT04gU0VDVVJJVFkgPT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBBdXRoZW50aWNhdGlvbiBTZWN1cml0eSBTeXN0ZW1cbiAqIFxuICogUHJvdmlkZXMgYWNjb3VudCBsb2Nrb3V0IHByb3RlY3Rpb24sIHBhc3N3b3JkIHN0cmVuZ3RoIHZhbGlkYXRpb24sXG4gKiBhbmQgc2VjdXJlIHRva2VuIGdlbmVyYXRpb24gZm9yIGF1dGhlbnRpY2F0aW9uIG9wZXJhdGlvbnMuXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiAvLyBDaGVjayBpZiBhY2NvdW50IGlzIGxvY2tlZFxuICogaWYgKEF1dGhlbnRpY2F0aW9uU2VjdXJpdHkuaXNBY2NvdW50TG9ja2VkKCd1c2VyQGV4YW1wbGUuY29tJykpIHtcbiAqICAgdGhyb3cgbmV3IEVycm9yKCdBY2NvdW50IHRlbXBvcmFyaWx5IGxvY2tlZCBkdWUgdG8gZmFpbGVkIGF0dGVtcHRzJyk7XG4gKiB9XG4gKiBcbiAqIC8vIFZhbGlkYXRlIHBhc3N3b3JkIHN0cmVuZ3RoXG4gKiBjb25zdCB2YWxpZGF0aW9uID0gQXV0aGVudGljYXRpb25TZWN1cml0eS52YWxpZGF0ZVBhc3N3b3JkU3RyZW5ndGgoJ3Bhc3N3b3JkMTIzJyk7XG4gKiBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAqICAgY29uc29sZS5sb2coJ1Bhc3N3b3JkIGVycm9yczonLCB2YWxpZGF0aW9uLmVycm9ycyk7XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIEF1dGhlbnRpY2F0aW9uU2VjdXJpdHkge1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBMT0NLT1VUX0RVUkFUSU9OID0gMTUgKiA2MCAqIDEwMDAgLy8gMTUgbWludXRlc1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBNQVhfQVRURU1QVFMgPSA1XG4gIHByaXZhdGUgc3RhdGljIGxvY2tlZEFjY291bnRzID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBhY2NvdW50IGlzIGxvY2tlZCBkdWUgdG8gZmFpbGVkIGF1dGhlbnRpY2F0aW9uIGF0dGVtcHRzXG4gICAqIEBwYXJhbSBpZGVudGlmaWVyIC0gQWNjb3VudCBpZGVudGlmaWVyIChlbWFpbCwgdXNlcm5hbWUpXG4gICAqIEByZXR1cm5zIFRydWUgaWYgYWNjb3VudCBpcyBjdXJyZW50bHkgbG9ja2VkXG4gICAqL1xuICBzdGF0aWMgaXNBY2NvdW50TG9ja2VkKGlkZW50aWZpZXI6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGxvY2tUaW1lID0gdGhpcy5sb2NrZWRBY2NvdW50cy5nZXQoaWRlbnRpZmllcilcbiAgICBpZiAoIWxvY2tUaW1lKSByZXR1cm4gZmFsc2VcbiAgICBcbiAgICBpZiAoRGF0ZS5ub3coKSA+IGxvY2tUaW1lKSB7XG4gICAgICB0aGlzLmxvY2tlZEFjY291bnRzLmRlbGV0ZShpZGVudGlmaWVyKVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0cnVlXG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkIGZhaWxlZCBhdXRoZW50aWNhdGlvbiBhdHRlbXB0IGFuZCBsb2NrIGFjY291bnQgaWYgbmVlZGVkXG4gICAqIEBwYXJhbSBpZGVudGlmaWVyIC0gQWNjb3VudCBpZGVudGlmaWVyIHRoYXQgZmFpbGVkIGF1dGhlbnRpY2F0aW9uXG4gICAqL1xuICBzdGF0aWMgcmVjb3JkRmFpbGVkQXR0ZW1wdChpZGVudGlmaWVyOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCBsb2NrVW50aWwgPSBEYXRlLm5vdygpICsgdGhpcy5MT0NLT1VUX0RVUkFUSU9OXG4gICAgdGhpcy5sb2NrZWRBY2NvdW50cy5zZXQoaWRlbnRpZmllciwgbG9ja1VudGlsKVxuICAgIFxuICAgIGxvZ2dlci53YXJuKCdBdXRoZW50aWNhdGlvbiBmYWlsdXJlIHJlY29yZGVkJywge1xuICAgICAgaWRlbnRpZmllcjogaWRlbnRpZmllci5zdWJzdHJpbmcoMCwgMykgKyAnKioqJywgLy8gUGFydGlhbCBpZGVudGlmaWVyIGZvciBwcml2YWN5XG4gICAgICBsb2NrVW50aWw6IG5ldyBEYXRlKGxvY2tVbnRpbCkudG9JU09TdHJpbmcoKVxuICAgIH0sICdTZWN1cml0eScpXG4gIH1cblxuICAvKipcbiAgICogQ2xlYXIgZmFpbGVkIGF0dGVtcHRzIHJlY29yZCBvbiBzdWNjZXNzZnVsIGF1dGhlbnRpY2F0aW9uXG4gICAqIEBwYXJhbSBpZGVudGlmaWVyIC0gQWNjb3VudCBpZGVudGlmaWVyIHRoYXQgc3VjY2Vzc2Z1bGx5IGF1dGhlbnRpY2F0ZWRcbiAgICovXG4gIHN0YXRpYyBjbGVhckZhaWxlZEF0dGVtcHRzKGlkZW50aWZpZXI6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMubG9ja2VkQWNjb3VudHMuZGVsZXRlKGlkZW50aWZpZXIpXG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgcGFzc3dvcmQgc3RyZW5ndGggYWdhaW5zdCBzZWN1cml0eSByZXF1aXJlbWVudHNcbiAgICogQHBhcmFtIHBhc3N3b3JkIC0gUGFzc3dvcmQgdG8gdmFsaWRhdGVcbiAgICogQHJldHVybnMgVmFsaWRhdGlvbiByZXN1bHQgd2l0aCBkZXRhaWxlZCBlcnJvciBtZXNzYWdlc1xuICAgKi9cbiAgc3RhdGljIHZhbGlkYXRlUGFzc3dvcmRTdHJlbmd0aChwYXNzd29yZDogc3RyaW5nKTogeyB2YWxpZDogYm9vbGVhbjsgZXJyb3JzOiBzdHJpbmdbXSB9IHtcbiAgICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICBpZiAocGFzc3dvcmQubGVuZ3RoIDwgOCkgZXJyb3JzLnB1c2goJ1Bhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgOCBjaGFyYWN0ZXJzJylcbiAgICBpZiAocGFzc3dvcmQubGVuZ3RoID4gMTI4KSBlcnJvcnMucHVzaCgnUGFzc3dvcmQgdG9vIGxvbmcnKVxuICAgIGlmICghL1tBLVpdLy50ZXN0KHBhc3N3b3JkKSkgZXJyb3JzLnB1c2goJ1Bhc3N3b3JkIG11c3QgY29udGFpbiB1cHBlcmNhc2UgbGV0dGVyJylcbiAgICBpZiAoIS9bYS16XS8udGVzdChwYXNzd29yZCkpIGVycm9ycy5wdXNoKCdQYXNzd29yZCBtdXN0IGNvbnRhaW4gbG93ZXJjYXNlIGxldHRlcicpXG4gICAgaWYgKCEvWzAtOV0vLnRlc3QocGFzc3dvcmQpKSBlcnJvcnMucHVzaCgnUGFzc3dvcmQgbXVzdCBjb250YWluIG51bWJlcicpXG4gICAgaWYgKCEvW15BLVphLXowLTldLy50ZXN0KHBhc3N3b3JkKSkgZXJyb3JzLnB1c2goJ1Bhc3N3b3JkIG11c3QgY29udGFpbiBzcGVjaWFsIGNoYXJhY3RlcicpXG4gICAgXG4gICAgLy8gQ2hlY2sgZm9yIGNvbW1vbiB3ZWFrIHBhc3N3b3Jkc1xuICAgIGNvbnN0IGNvbW1vblBhc3N3b3JkcyA9IFtcbiAgICAgICdwYXNzd29yZCcsICcxMjM0NTYnLCAncXdlcnR5JywgJ2FiYzEyMycsICdwYXNzd29yZDEyMycsXG4gICAgICAnYWRtaW4nLCAnbGV0bWVpbicsICd3ZWxjb21lJywgJ21vbmtleScsICdkcmFnb24nXG4gICAgXVxuICAgIFxuICAgIGlmIChjb21tb25QYXNzd29yZHMuaW5jbHVkZXMocGFzc3dvcmQudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgIGVycm9ycy5wdXNoKCdQYXNzd29yZCBpcyB0b28gY29tbW9uJylcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZXJyb3JzXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGNyeXB0b2dyYXBoaWNhbGx5IHNlY3VyZSByYW5kb20gdG9rZW5cbiAgICogQHBhcmFtIGxlbmd0aCAtIFRva2VuIGxlbmd0aCAoZGVmYXVsdDogMzIgY2hhcmFjdGVycylcbiAgICogQHJldHVybnMgU2VjdXJlIHJhbmRvbSBzdHJpbmcgc3VpdGFibGUgZm9yIHRva2Vuc1xuICAgKi9cbiAgc3RhdGljIGdlbmVyYXRlU2VjdXJlVG9rZW4obGVuZ3RoOiBudW1iZXIgPSAzMik6IHN0cmluZyB7XG4gICAgY29uc3QgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODknXG4gICAgbGV0IHJlc3VsdCA9ICcnXG4gICAgXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgcmVzdWx0ICs9IGNoYXJzLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjaGFycy5sZW5ndGgpKVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcmVzdWx0XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT0gRVJST1IgSEFORExJTkcgU0VDVVJJVFkgPT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNsYXNzIFNlY3VyZUVycm9ySGFuZGxlciB7XG4gIC8qKlxuICAgKiBTYW5pdGl6ZSBlcnJvciBtZXNzYWdlcyB0byBwcmV2ZW50IGluZm9ybWF0aW9uIGRpc2Nsb3N1cmVcbiAgICovXG4gIHN0YXRpYyBzYW5pdGl6ZUVycm9yKGVycm9yOiBhbnksIGlzUHJvZHVjdGlvbjogYm9vbGVhbiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpOiB7XG4gICAgbWVzc2FnZTogc3RyaW5nXG4gICAgY29kZT86IHN0cmluZ1xuICAgIGRldGFpbHM/OiBhbnlcbiAgfSB7XG4gICAgLy8gSW4gcHJvZHVjdGlvbiwgbmV2ZXIgZXhwb3NlIGludGVybmFsIGVycm9yc1xuICAgIGlmIChpc1Byb2R1Y3Rpb24pIHtcbiAgICAgIGNvbnN0IHNhZmVFcnJvcnMgPSBbXG4gICAgICAgICdJbnZhbGlkIGNyZWRlbnRpYWxzJyxcbiAgICAgICAgJ0FjY2VzcyBkZW5pZWQnLFxuICAgICAgICAnUmVzb3VyY2Ugbm90IGZvdW5kJyxcbiAgICAgICAgJ0ludmFsaWQgaW5wdXQnLFxuICAgICAgICAnUmF0ZSBsaW1pdCBleGNlZWRlZCcsXG4gICAgICAgICdGaWxlIHRvbyBsYXJnZScsXG4gICAgICAgICdJbnZhbGlkIGZpbGUgdHlwZSdcbiAgICAgIF1cbiAgICAgIFxuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3I/Lm1lc3NhZ2UgfHwgJ0FuIGVycm9yIG9jY3VycmVkJ1xuICAgICAgY29uc3QgaXNTYWZlRXJyb3IgPSBzYWZlRXJyb3JzLnNvbWUoc2FmZSA9PiBlcnJvck1lc3NhZ2UuaW5jbHVkZXMoc2FmZSkpXG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1lc3NhZ2U6IGlzU2FmZUVycm9yID8gZXJyb3JNZXNzYWdlIDogJ0FuIGVycm9yIG9jY3VycmVkJyxcbiAgICAgICAgY29kZTogZXJyb3I/LmNvZGUgfHwgJ0lOVEVSTkFMX0VSUk9SJ1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBJbiBkZXZlbG9wbWVudCwgcHJvdmlkZSBtb3JlIGRldGFpbHMgYnV0IHN0aWxsIHNhbml0aXplXG4gICAgcmV0dXJuIHtcbiAgICAgIG1lc3NhZ2U6IGVycm9yPy5tZXNzYWdlIHx8ICdBbiBlcnJvciBvY2N1cnJlZCcsXG4gICAgICBjb2RlOiBlcnJvcj8uY29kZSxcbiAgICAgIGRldGFpbHM6IGVycm9yPy5zdGFjayA/IGVycm9yLnN0YWNrLnNwbGl0KCdcXG4nKS5zbGljZSgwLCAzKSA6IHVuZGVmaW5lZFxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgc2VjdXJpdHkgZXZlbnRzXG4gICAqL1xuICBzdGF0aWMgbG9nU2VjdXJpdHlFdmVudChcbiAgICBldmVudDogc3RyaW5nLFxuICAgIGRldGFpbHM6IFJlY29yZDxzdHJpbmcsIGFueT4sXG4gICAgc2V2ZXJpdHk6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcgfCAnY3JpdGljYWwnID0gJ21lZGl1bSdcbiAgKTogdm9pZCB7XG4gICAgY29uc3QgbG9nRGF0YSA9IHtcbiAgICAgIGV2ZW50LFxuICAgICAgc2V2ZXJpdHksXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIC4uLmRldGFpbHNcbiAgICB9XG4gICAgXG4gICAgaWYgKHNldmVyaXR5ID09PSAnY3JpdGljYWwnIHx8IHNldmVyaXR5ID09PSAnaGlnaCcpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihgU2VjdXJpdHkgRXZlbnQ6ICR7ZXZlbnR9YCwgbG9nRGF0YSwgJ1NlY3VyaXR5JylcbiAgICB9IGVsc2Uge1xuICAgICAgbG9nZ2VyLndhcm4oYFNlY3VyaXR5IEV2ZW50OiAke2V2ZW50fWAsIGxvZ0RhdGEsICdTZWN1cml0eScpXG4gICAgfVxuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09IFNFQ1VSSVRZIE1PTklUT1JJTkcgPT09PT09PT09PT09PT09PT09PT1cblxuaW50ZXJmYWNlIFNlY3VyaXR5RXZlbnQge1xuICBpZDogc3RyaW5nXG4gIHR5cGU6IHN0cmluZ1xuICBzZXZlcml0eTogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyB8ICdjcml0aWNhbCdcbiAgdGltZXN0YW1wOiBudW1iZXJcbiAgZGV0YWlsczogUmVjb3JkPHN0cmluZywgYW55PlxufVxuXG4vKipcbiAqIFNlY3VyaXR5IEV2ZW50IE1vbml0b3JpbmcgU3lzdGVtXG4gKiBcbiAqIFRyYWNrcyBhbmQgYW5hbHl6ZXMgc2VjdXJpdHkgZXZlbnRzIGZvciB0aHJlYXQgZGV0ZWN0aW9uIGFuZCBpbmNpZGVudCByZXNwb25zZS5cbiAqIE1haW50YWlucyBldmVudCBoaXN0b3J5IGFuZCBwcm92aWRlcyBhbGVydGluZyBmb3IgY3JpdGljYWwgc2VjdXJpdHkgZXZlbnRzLlxuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogLy8gUmVjb3JkIHNlY3VyaXR5IGV2ZW50XG4gKiBTZWN1cml0eU1vbml0b3IucmVjb3JkRXZlbnQoJ3N1c3BpY2lvdXNfbG9naW4nLCAnaGlnaCcsIHtcbiAqICAgaXA6ICcxOTIuMTY4LjEuMScsXG4gKiAgIHVzZXJBZ2VudDogJ3N1c3BpY2lvdXMtYm90J1xuICogfSk7XG4gKiBcbiAqIC8vIEdldCBzZWN1cml0eSBzdGF0aXN0aWNzXG4gKiBjb25zdCBzdGF0cyA9IFNlY3VyaXR5TW9uaXRvci5nZXRTdGF0cygpO1xuICogY29uc29sZS5sb2coYENyaXRpY2FsIGV2ZW50czogJHtzdGF0cy5jcml0aWNhbEV2ZW50c31gKTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgU2VjdXJpdHlNb25pdG9yIHtcbiAgcHJpdmF0ZSBzdGF0aWMgZXZlbnRzOiBTZWN1cml0eUV2ZW50W10gPSBbXVxuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBNQVhfRVZFTlRTID0gMTAwMFxuXG4gIC8qKlxuICAgKiBSZWNvcmQgYSBzZWN1cml0eSBldmVudCBmb3IgbW9uaXRvcmluZyBhbmQgYW5hbHlzaXNcbiAgICogQHBhcmFtIHR5cGUgLSBFdmVudCB0eXBlIGlkZW50aWZpZXJcbiAgICogQHBhcmFtIHNldmVyaXR5IC0gRXZlbnQgc2V2ZXJpdHkgbGV2ZWxcbiAgICogQHBhcmFtIGRldGFpbHMgLSBBZGRpdGlvbmFsIGV2ZW50IGNvbnRleHQgYW5kIG1ldGFkYXRhXG4gICAqL1xuICBzdGF0aWMgcmVjb3JkRXZlbnQoXG4gICAgdHlwZTogc3RyaW5nLFxuICAgIHNldmVyaXR5OiBTZWN1cml0eUV2ZW50WydzZXZlcml0eSddLFxuICAgIGRldGFpbHM6IFJlY29yZDxzdHJpbmcsIGFueT5cbiAgKTogdm9pZCB7XG4gICAgY29uc3QgZXZlbnQ6IFNlY3VyaXR5RXZlbnQgPSB7XG4gICAgICBpZDogQXV0aGVudGljYXRpb25TZWN1cml0eS5nZW5lcmF0ZVNlY3VyZVRva2VuKDE2KSxcbiAgICAgIHR5cGUsXG4gICAgICBzZXZlcml0eSxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgIGRldGFpbHNcbiAgICB9XG4gICAgXG4gICAgdGhpcy5ldmVudHMucHVzaChldmVudClcbiAgICBcbiAgICAvLyBLZWVwIG9ubHkgcmVjZW50IGV2ZW50c1xuICAgIGlmICh0aGlzLmV2ZW50cy5sZW5ndGggPiB0aGlzLk1BWF9FVkVOVFMpIHtcbiAgICAgIHRoaXMuZXZlbnRzID0gdGhpcy5ldmVudHMuc2xpY2UoLXRoaXMuTUFYX0VWRU5UUylcbiAgICB9XG4gICAgXG4gICAgLy8gQWxlcnQgb24gY3JpdGljYWwgZXZlbnRzXG4gICAgaWYgKHNldmVyaXR5ID09PSAnY3JpdGljYWwnKSB7XG4gICAgICB0aGlzLmFsZXJ0Q3JpdGljYWxFdmVudChldmVudClcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgc2VjdXJpdHkgZXZlbnRzIHdpdGggZmlsdGVyaW5nIGFuZCBsaW1pdGluZ1xuICAgKiBAcGFyYW0gc2V2ZXJpdHkgLSBPcHRpb25hbCBzZXZlcml0eSBmaWx0ZXJcbiAgICogQHBhcmFtIGxpbWl0IC0gTWF4aW11bSBudW1iZXIgb2YgZXZlbnRzIHRvIHJldHVybiAoZGVmYXVsdDogMTAwKVxuICAgKiBAcmV0dXJucyBBcnJheSBvZiBzZWN1cml0eSBldmVudHMgc29ydGVkIGJ5IHRpbWVzdGFtcCAobmV3ZXN0IGZpcnN0KVxuICAgKi9cbiAgc3RhdGljIGdldEV2ZW50cyhcbiAgICBzZXZlcml0eT86IFNlY3VyaXR5RXZlbnRbJ3NldmVyaXR5J10sXG4gICAgbGltaXQ6IG51bWJlciA9IDEwMFxuICApOiBTZWN1cml0eUV2ZW50W10ge1xuICAgIGxldCBmaWx0ZXJlZCA9IHRoaXMuZXZlbnRzXG4gICAgXG4gICAgaWYgKHNldmVyaXR5KSB7XG4gICAgICBmaWx0ZXJlZCA9IHRoaXMuZXZlbnRzLmZpbHRlcihlID0+IGUuc2V2ZXJpdHkgPT09IHNldmVyaXR5KVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gZmlsdGVyZWRcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnRpbWVzdGFtcCAtIGEudGltZXN0YW1wKVxuICAgICAgLnNsaWNlKDAsIGxpbWl0KVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzZWN1cml0eSBzdGF0aXN0aWNzXG4gICAqL1xuICBzdGF0aWMgZ2V0U3RhdHMoKToge1xuICAgIHRvdGFsRXZlbnRzOiBudW1iZXJcbiAgICBldmVudHNCeVNldmVyaXR5OiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+XG4gICAgcmVjZW50RXZlbnRzOiBudW1iZXJcbiAgICBjcml0aWNhbEV2ZW50czogbnVtYmVyXG4gIH0ge1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KClcbiAgICBjb25zdCBvbmVIb3VyQWdvID0gbm93IC0gNjAgKiA2MCAqIDEwMDBcbiAgICBcbiAgICBjb25zdCBldmVudHNCeVNldmVyaXR5ID0gdGhpcy5ldmVudHMucmVkdWNlKChhY2MsIGV2ZW50KSA9PiB7XG4gICAgICBhY2NbZXZlbnQuc2V2ZXJpdHldID0gKGFjY1tldmVudC5zZXZlcml0eV0gfHwgMCkgKyAxXG4gICAgICByZXR1cm4gYWNjXG4gICAgfSwge30gYXMgUmVjb3JkPHN0cmluZywgbnVtYmVyPilcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxFdmVudHM6IHRoaXMuZXZlbnRzLmxlbmd0aCxcbiAgICAgIGV2ZW50c0J5U2V2ZXJpdHksXG4gICAgICByZWNlbnRFdmVudHM6IHRoaXMuZXZlbnRzLmZpbHRlcihlID0+IGUudGltZXN0YW1wID4gb25lSG91ckFnbykubGVuZ3RoLFxuICAgICAgY3JpdGljYWxFdmVudHM6IHRoaXMuZXZlbnRzLmZpbHRlcihlID0+IGUuc2V2ZXJpdHkgPT09ICdjcml0aWNhbCcpLmxlbmd0aFxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGFsZXJ0Q3JpdGljYWxFdmVudChldmVudDogU2VjdXJpdHlFdmVudCk6IHZvaWQge1xuICAgIGxvZ2dlci5lcnJvcignQ1JJVElDQUwgU0VDVVJJVFkgRVZFTlQnLCB7XG4gICAgICBldmVudElkOiBldmVudC5pZCxcbiAgICAgIHR5cGU6IGV2ZW50LnR5cGUsXG4gICAgICBkZXRhaWxzOiBldmVudC5kZXRhaWxzXG4gICAgfSwgJ1NlY3VyaXR5JylcbiAgICBcbiAgICAvLyBJbiBwcm9kdWN0aW9uLCB0aGlzIHdvdWxkIHRyaWdnZXIgYWxlcnRzIHRvIHNlY3VyaXR5IHRlYW1cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgLy8gVE9ETzogSW50ZWdyYXRlIHdpdGggYWxlcnRpbmcgc3lzdGVtIChlbWFpbCwgU2xhY2ssIFBhZ2VyRHV0eSwgZXRjLilcbiAgICB9XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT0gQ09OVEVOVCBTRUNVUklUWSBQT0xJQ1kgPT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNsYXNzIENvbnRlbnRTZWN1cml0eVBvbGljeSB7XG4gIHN0YXRpYyBnZXRIZWFkZXJzKCk6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xuICAgIGNvbnN0IG5vbmNlID0gQXV0aGVudGljYXRpb25TZWN1cml0eS5nZW5lcmF0ZVNlY3VyZVRva2VuKDE2KVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAnQ29udGVudC1TZWN1cml0eS1Qb2xpY3knOiBbXG4gICAgICAgIFwiZGVmYXVsdC1zcmMgJ3NlbGYnXCIsXG4gICAgICAgIFwic2NyaXB0LXNyYyAnc2VsZicgJ3Vuc2FmZS1pbmxpbmUnICd1bnNhZmUtZXZhbCcgaHR0cHM6Ly92ZXJjZWwubGl2ZSBodHRwczovL3ZhLnZlcmNlbC1zY3JpcHRzLmNvbVwiLFxuICAgICAgICBcInN0eWxlLXNyYyAnc2VsZicgJ3Vuc2FmZS1pbmxpbmUnIGh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb21cIixcbiAgICAgICAgXCJmb250LXNyYyAnc2VsZicgaHR0cHM6Ly9mb250cy5nc3RhdGljLmNvbVwiLFxuICAgICAgICBcImltZy1zcmMgJ3NlbGYnIGRhdGE6IGh0dHBzOiBibG9iOlwiLFxuICAgICAgICBcImNvbm5lY3Qtc3JjICdzZWxmJyBodHRwczovLyouc3VwYWJhc2UuY28gd3NzOi8vKi5zdXBhYmFzZS5jbyBodHRwczovL3ZlcmNlbC5saXZlXCIsXG4gICAgICAgIFwiZnJhbWUtc3JjICdzZWxmJyBodHRwczovL3ZlcmNlbC5saXZlXCIsXG4gICAgICAgIFwib2JqZWN0LXNyYyAnbm9uZSdcIixcbiAgICAgICAgXCJiYXNlLXVyaSAnc2VsZidcIixcbiAgICAgICAgXCJmb3JtLWFjdGlvbiAnc2VsZidcIixcbiAgICAgICAgXCJmcmFtZS1hbmNlc3RvcnMgJ25vbmUnXCIsXG4gICAgICAgIFwidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0c1wiXG4gICAgICBdLmpvaW4oJzsgJyksXG4gICAgICBcbiAgICAgICdYLUNvbnRlbnQtVHlwZS1PcHRpb25zJzogJ25vc25pZmYnLFxuICAgICAgJ1gtRnJhbWUtT3B0aW9ucyc6ICdERU5ZJyxcbiAgICAgICdYLVhTUy1Qcm90ZWN0aW9uJzogJzE7IG1vZGU9YmxvY2snLFxuICAgICAgJ1JlZmVycmVyLVBvbGljeSc6ICdzdHJpY3Qtb3JpZ2luLXdoZW4tY3Jvc3Mtb3JpZ2luJyxcbiAgICAgICdQZXJtaXNzaW9ucy1Qb2xpY3knOiAnY2FtZXJhPSgpLCBtaWNyb3Bob25lPSgpLCBnZW9sb2NhdGlvbj0oKScsXG4gICAgICBcbiAgICAgIC8vIEhTVFMgKEhUVFAgU3RyaWN0IFRyYW5zcG9ydCBTZWN1cml0eSlcbiAgICAgICdTdHJpY3QtVHJhbnNwb3J0LVNlY3VyaXR5JzogJ21heC1hZ2U9MzE1MzYwMDA7IGluY2x1ZGVTdWJEb21haW5zOyBwcmVsb2FkJ1xuICAgIH1cbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PSBNQUlOIFNFQ1VSSVRZIE1JRERMRVdBUkUgPT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBDb21wcmVoZW5zaXZlIFNlY3VyaXR5IEhhcmRlbmluZyBNaWRkbGV3YXJlXG4gKiBcbiAqIFByb3ZpZGVzIGNvbXBsZXRlIHNlY3VyaXR5IHByb3RlY3Rpb24gZm9yIEFQSSByb3V0ZXMgaW5jbHVkaW5nOlxuICogLSBNZXRob2QgdmFsaWRhdGlvblxuICogLSBSYXRlIGxpbWl0aW5nXG4gKiAtIEF1dGhlbnRpY2F0aW9uIHZlcmlmaWNhdGlvblxuICogLSBJbnB1dCB2YWxpZGF0aW9uXG4gKiAtIFNlY3VyaXR5IGV2ZW50IG1vbml0b3JpbmdcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIC8vIFNlY3VyZSBhbiBBUEkgcm91dGVcbiAqIGNvbnN0IHNlY3VyaXR5ID0gYXdhaXQgU2VjdXJpdHlIYXJkZW5pbmcuc2VjdXJlQVBJUm91dGUocmVxdWVzdCwge1xuICogICByZXF1aXJlQXV0aDogdHJ1ZSxcbiAqICAgcmF0ZUxpbWl0OiAnYXBpJyxcbiAqICAgYWxsb3dlZE1ldGhvZHM6IFsnUE9TVCddLFxuICogICB2YWxpZGF0ZUlucHV0OiB1c2VyVXBkYXRlU2NoZW1hXG4gKiB9KTtcbiAqIFxuICogaWYgKCFzZWN1cml0eS5zdWNjZXNzKSB7XG4gKiAgIHJldHVybiBzZWN1cml0eS5yZXNwb25zZTsgLy8gU2VjdXJpdHkgY2hlY2sgZmFpbGVkXG4gKiB9XG4gKiBcbiAqIC8vIFNlY3VyaXR5IHBhc3NlZCwgcHJvY2VlZCB3aXRoIEFQSSBsb2dpY1xuICogY29uc3QgdXNlciA9IHNlY3VyaXR5LnVzZXI7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFNlY3VyaXR5SGFyZGVuaW5nIHtcbiAgLyoqXG4gICAqIEFwcGx5IGNvbXByZWhlbnNpdmUgc2VjdXJpdHkgcHJvdGVjdGlvbiB0byBBUEkgcm91dGVzXG4gICAqIEBwYXJhbSByZXF1ZXN0IC0gTmV4dC5qcyByZXF1ZXN0IG9iamVjdFxuICAgKiBAcGFyYW0gb3B0aW9ucyAtIFNlY3VyaXR5IGNvbmZpZ3VyYXRpb24gb3B0aW9uc1xuICAgKiBAcGFyYW0gb3B0aW9ucy5yZXF1aXJlQXV0aCAtIFdoZXRoZXIgYXV0aGVudGljYXRpb24gaXMgcmVxdWlyZWRcbiAgICogQHBhcmFtIG9wdGlvbnMucmF0ZUxpbWl0IC0gUmF0ZSBsaW1pdCB0eXBlIHRvIGFwcGx5XG4gICAqIEBwYXJhbSBvcHRpb25zLnZhbGlkYXRlSW5wdXQgLSBab2Qgc2NoZW1hIGZvciBpbnB1dCB2YWxpZGF0aW9uXG4gICAqIEBwYXJhbSBvcHRpb25zLmFsbG93ZWRNZXRob2RzIC0gSFRUUCBtZXRob2RzIGFsbG93ZWQgZm9yIHRoaXMgcm91dGVcbiAgICogQHJldHVybnMgU2VjdXJpdHkgY2hlY2sgcmVzdWx0IHdpdGggdXNlciBkYXRhIG9yIGVycm9yIHJlc3BvbnNlXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgc2VjdXJlQVBJUm91dGUoXG4gICAgcmVxdWVzdDogTmV4dFJlcXVlc3QsXG4gICAgb3B0aW9uczoge1xuICAgICAgcmVxdWlyZUF1dGg/OiBib29sZWFuXG4gICAgICByYXRlTGltaXQ/OiBrZXlvZiB0eXBlb2YgUmF0ZUxpbWl0ZXIuTElNSVRTXG4gICAgICB2YWxpZGF0ZUlucHV0Pzogei5ab2RTY2hlbWFcbiAgICAgIGFsbG93ZWRNZXRob2RzPzogc3RyaW5nW11cbiAgICB9ID0ge31cbiAgKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IHRydWU7IHVzZXI/OiBhbnkgfSB8IHsgc3VjY2VzczogZmFsc2U7IHJlc3BvbnNlOiBOZXh0UmVzcG9uc2UgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHJlcXVpcmVBdXRoID0gdHJ1ZSxcbiAgICAgICAgcmF0ZUxpbWl0ID0gJ2FwaScsXG4gICAgICAgIHZhbGlkYXRlSW5wdXQsXG4gICAgICAgIGFsbG93ZWRNZXRob2RzID0gWydHRVQnLCAnUE9TVCcsICdQVVQnLCAnREVMRVRFJ11cbiAgICAgIH0gPSBvcHRpb25zXG5cbiAgICAgIC8vIDEuIE1ldGhvZCB2YWxpZGF0aW9uXG4gICAgICBpZiAoIWFsbG93ZWRNZXRob2RzLmluY2x1ZGVzKHJlcXVlc3QubWV0aG9kKSkge1xuICAgICAgICBTZWN1cml0eU1vbml0b3IucmVjb3JkRXZlbnQoJ2ludmFsaWRfbWV0aG9kJywgJ21lZGl1bScsIHtcbiAgICAgICAgICBtZXRob2Q6IHJlcXVlc3QubWV0aG9kLFxuICAgICAgICAgIHVybDogcmVxdWVzdC51cmxcbiAgICAgICAgfSlcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgcmVzcG9uc2U6IE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgICAgeyBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSxcbiAgICAgICAgICAgIHsgc3RhdHVzOiA0MDUgfVxuICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyAyLiBSYXRlIGxpbWl0aW5nXG4gICAgICBjb25zdCBjbGllbnRJUCA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpIHx8IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtcmVhbC1pcCcpIHx8ICd1bmtub3duJ1xuICAgICAgY29uc3QgcmF0ZUxpbWl0UmVzdWx0ID0gYXdhaXQgUmF0ZUxpbWl0ZXIuY2hlY2tMaW1pdChjbGllbnRJUCwgcmF0ZUxpbWl0KVxuICAgICAgXG4gICAgICBpZiAoIXJhdGVMaW1pdFJlc3VsdC5hbGxvd2VkKSB7XG4gICAgICAgIFNlY3VyaXR5TW9uaXRvci5yZWNvcmRFdmVudCgncmF0ZV9saW1pdF9leGNlZWRlZCcsICdoaWdoJywge1xuICAgICAgICAgIGlwOiBjbGllbnRJUCxcbiAgICAgICAgICBsaW1pdFR5cGU6IHJhdGVMaW1pdFxuICAgICAgICB9KVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICByZXNwb25zZTogTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgICB7IGVycm9yOiAnUmF0ZSBsaW1pdCBleGNlZWRlZCcgfSxcbiAgICAgICAgICAgIHsgXG4gICAgICAgICAgICAgIHN0YXR1czogNDI5LFxuICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ1JldHJ5LUFmdGVyJzogTWF0aC5jZWlsKChyYXRlTGltaXRSZXN1bHQucmVzZXRUaW1lIC0gRGF0ZS5ub3coKSkgLyAxMDAwKS50b1N0cmluZygpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICApXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gMy4gQXV0aGVudGljYXRpb24gY2hlY2tcbiAgICAgIGxldCB1c2VyID0gbnVsbFxuICAgICAgaWYgKHJlcXVpcmVBdXRoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gT25seSBpbXBvcnQgYW5kIHVzZSBjcmVhdGVTZXJ2ZXJDbGllbnQgd2hlbiBhY3R1YWxseSBuZWVkZWRcbiAgICAgICAgICBjb25zdCB7IGNyZWF0ZVNlcnZlckNsaWVudDogY3JlYXRlQ2xpZW50IH0gPSBhd2FpdCBpbXBvcnQoJ0Avc2VydmljZXMvc3VwYWJhc2Uvc2VydmVyJylcbiAgICAgICAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpXG4gICAgICAgICAgY29uc3QgeyBkYXRhOiB7IHVzZXI6IGF1dGhVc2VyIH0sIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpXG4gICAgICAgIFxuICAgICAgICAgIGlmICghYXV0aFVzZXIgfHwgYXV0aEVycm9yKSB7XG4gICAgICAgICAgICBTZWN1cml0eU1vbml0b3IucmVjb3JkRXZlbnQoJ3VuYXV0aG9yaXplZF9hY2Nlc3MnLCAnbWVkaXVtJywge1xuICAgICAgICAgICAgICBpcDogY2xpZW50SVAsXG4gICAgICAgICAgICAgIHVybDogcmVxdWVzdC51cmxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICByZXNwb25zZTogTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgICAgICAgeyBlcnJvcjogJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJyB9LFxuICAgICAgICAgICAgICAgIHsgc3RhdHVzOiA0MDEgfVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIHVzZXIgPSBhdXRoVXNlclxuICAgICAgICB9IGNhdGNoIChhdXRoRXJyb3IpIHtcbiAgICAgICAgICBTZWN1cml0eU1vbml0b3IucmVjb3JkRXZlbnQoJ2F1dGhfZXJyb3InLCAnaGlnaCcsIHtcbiAgICAgICAgICAgIGlwOiBjbGllbnRJUCxcbiAgICAgICAgICAgIGVycm9yOiAoYXV0aEVycm9yIGFzIEVycm9yKS5tZXNzYWdlXG4gICAgICAgICAgfSlcbiAgICAgICAgICBcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICByZXNwb25zZTogTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgICAgIHsgZXJyb3I6ICdBdXRoZW50aWNhdGlvbiBmYWlsZWQnIH0sXG4gICAgICAgICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgICAgICAgKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyA0LiBJbnB1dCB2YWxpZGF0aW9uXG4gICAgICBpZiAodmFsaWRhdGVJbnB1dCAmJiByZXF1ZXN0Lm1ldGhvZCAhPT0gJ0dFVCcpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICAgICAgICB2YWxpZGF0ZUlucHV0LnBhcnNlKGJvZHkpXG4gICAgICAgIH0gY2F0Y2ggKHZhbGlkYXRpb25FcnJvcikge1xuICAgICAgICAgIFNlY3VyaXR5TW9uaXRvci5yZWNvcmRFdmVudCgnaW5wdXRfdmFsaWRhdGlvbl9mYWlsZWQnLCAnbWVkaXVtJywge1xuICAgICAgICAgICAgaXA6IGNsaWVudElQLFxuICAgICAgICAgICAgZXJyb3I6ICh2YWxpZGF0aW9uRXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2VcbiAgICAgICAgICB9KVxuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIHJlc3BvbnNlOiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICAgICAgeyBlcnJvcjogJ0ludmFsaWQgaW5wdXQgZGF0YScgfSxcbiAgICAgICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgICAgICApXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHVzZXIgfVxuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIFNlY3VyaXR5TW9uaXRvci5yZWNvcmRFdmVudCgnc2VjdXJpdHlfbWlkZGxld2FyZV9lcnJvcicsICdjcml0aWNhbCcsIHtcbiAgICAgICAgZXJyb3I6IChlcnJvciBhcyBFcnJvcikubWVzc2FnZVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIHJlc3BvbnNlOiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IGVycm9yOiAnU2VjdXJpdHkgdmFsaWRhdGlvbiBmYWlsZWQnIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0iXSwidmVyc2lvbiI6M30=